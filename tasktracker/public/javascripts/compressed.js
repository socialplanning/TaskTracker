var Prototype={Version:"1.5.0_rc1",ScriptFragment:"(?:<script.*?>)((\n|\r|.)*?)(?:</script>)",emptyFunction:function(){},K:function(x){return x;}};var Class={create:function(){return function(){this.initialize.apply(this,arguments);};}};var Abstract=new Object();Object.extend=function(_2,_3){for(var _4 in _3){_2[_4]=_3[_4];}return _2;};Object.extend(Object,{inspect:function(_5){try{if(_5==undefined){return "undefined";}if(_5==null){return "null";}return _5.inspect?_5.inspect():_5.toString();}catch(e){if(e instanceof RangeError){return "...";}throw e;}},keys:function(_6){var _7=[];for(var _8 in _6){_7.push(_8);}return _7;},values:function(_9){var _a=[];for(var _b in _9){_a.push(_9[_b]);}return _a;},clone:function(_c){return Object.extend({},_c);}});Function.prototype.bind=function(){var _d=this,args=$A(arguments),object=args.shift();return function(){return _d.apply(object,args.concat($A(arguments)));};};Function.prototype.bindAsEventListener=function(_e){var _f=this,args=$A(arguments),_e=args.shift();return function(_10){return _f.apply(_e,[(_10||window.event)].concat(args).concat($A(arguments)));};};Object.extend(Number.prototype,{toColorPart:function(){var _11=this.toString(16);if(this<16){return "0"+_11;}return _11;},succ:function(){return this+1;},times:function(_12){$R(0,this,true).each(_12);return this;}});var Try={these:function(){var _13;for(var i=0;i<arguments.length;i++){var _15=arguments[i];try{_13=_15();break;}catch(e){}}return _13;}};var PeriodicalExecuter=Class.create();PeriodicalExecuter.prototype={initialize:function(_16,_17){this.callback=_16;this.frequency=_17;this.currentlyExecuting=false;this.registerCallback();},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000);},stop:function(){if(!this.timer){return;}clearInterval(this.timer);this.timer=null;},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.callback(this);}finally{this.currentlyExecuting=false;}}}};Object.extend(String.prototype,{gsub:function(_18,_19){var _1a="",source=this,match;_19=arguments.callee.prepareReplacement(_19);while(source.length>0){if(match=source.match(_18)){_1a+=source.slice(0,match.index);_1a+=(_19(match)||"").toString();source=source.slice(match.index+match[0].length);}else{_1a+=source,source="";}}return _1a;},sub:function(_1b,_1c,_1d){_1c=this.gsub.prepareReplacement(_1c);_1d=_1d===undefined?1:_1d;return this.gsub(_1b,function(_1e){if(--_1d<0){return _1e[0];}return _1c(_1e);});},scan:function(_1f,_20){this.gsub(_1f,_20);return this;},truncate:function(_21,_22){_21=_21||30;_22=_22===undefined?"...":_22;return this.length>_21?this.slice(0,_21-_22.length)+_22:this;},strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"");},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"");},stripScripts:function(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"");},extractScripts:function(){var _23=new RegExp(Prototype.ScriptFragment,"img");var _24=new RegExp(Prototype.ScriptFragment,"im");return (this.match(_23)||[]).map(function(_25){return (_25.match(_24)||["",""])[1];});},evalScripts:function(){return this.extractScripts().map(function(_26){return eval(_26);});},escapeHTML:function(){var div=document.createElement("div");var _28=document.createTextNode(this);div.appendChild(_28);return div.innerHTML;},unescapeHTML:function(){var div=document.createElement("div");div.innerHTML=this.stripTags();return div.childNodes[0]?div.childNodes[0].nodeValue:"";},toQueryParams:function(){var _2a=this.match(/^\??(.*)$/)[1].split("&");return _2a.inject({},function(_2b,_2c){var _2d=_2c.split("=");var _2e=_2d[1]?decodeURIComponent(_2d[1]):undefined;_2b[decodeURIComponent(_2d[0])]=_2e;return _2b;});},toArray:function(){return this.split("");},camelize:function(){var _2f=this.split("-");if(_2f.length==1){return _2f[0];}var _30=this.indexOf("-")==0?_2f[0].charAt(0).toUpperCase()+_2f[0].substring(1):_2f[0];for(var i=1,len=_2f.length;i<len;i++){var s=_2f[i];_30+=s.charAt(0).toUpperCase()+s.substring(1);}return _30;},inspect:function(_33){var _34=this.replace(/\\/g,"\\\\");if(_33){return "\""+_34.replace(/"/g,"\\\"")+"\"";}else{return "'"+_34.replace(/'/g,"\\'")+"'";}}});String.prototype.gsub.prepareReplacement=function(_35){if(typeof _35=="function"){return _35;}var _36=new Template(_35);return function(_37){return _36.evaluate(_37);};};String.prototype.parseQuery=String.prototype.toQueryParams;var Template=Class.create();Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;Template.prototype={initialize:function(_38,_39){this.template=_38.toString();this.pattern=_39||Template.Pattern;},evaluate:function(_3a){return this.template.gsub(this.pattern,function(_3b){var _3c=_3b[1];if(_3c=="\\"){return _3b[2];}return _3c+(_3a[_3b[3]]||"").toString();});}};var $break=new Object();var $continue=new Object();var Enumerable={each:function(_3d){var _3e=0;try{this._each(function(_3f){try{_3d(_3f,_3e++);}catch(e){if(e!=$continue){throw e;}}});}catch(e){if(e!=$break){throw e;}}},all:function(_40){var _41=true;this.each(function(_42,_43){_41=_41&&!!(_40||Prototype.K)(_42,_43);if(!_41){throw $break;}});return _41;},any:function(_44){var _45=false;this.each(function(_46,_47){if(_45=!!(_44||Prototype.K)(_46,_47)){throw $break;}});return _45;},collect:function(_48){var _49=[];this.each(function(_4a,_4b){_49.push(_48(_4a,_4b));});return _49;},detect:function(_4c){var _4d;this.each(function(_4e,_4f){if(_4c(_4e,_4f)){_4d=_4e;throw $break;}});return _4d;},findAll:function(_50){var _51=[];this.each(function(_52,_53){if(_50(_52,_53)){_51.push(_52);}});return _51;},grep:function(_54,_55){var _56=[];this.each(function(_57,_58){var _59=_57.toString();if(_59.match(_54)){_56.push((_55||Prototype.K)(_57,_58));}});return _56;},include:function(_5a){var _5b=false;this.each(function(_5c){if(_5c==_5a){_5b=true;throw $break;}});return _5b;},inject:function(_5d,_5e){this.each(function(_5f,_60){_5d=_5e(_5d,_5f,_60);});return _5d;},invoke:function(_61){var _62=$A(arguments).slice(1);return this.collect(function(_63){return _63[_61].apply(_63,_62);});},max:function(_64){var _65;this.each(function(_66,_67){_66=(_64||Prototype.K)(_66,_67);if(_65==undefined||_66>=_65){_65=_66;}});return _65;},min:function(_68){var _69;this.each(function(_6a,_6b){_6a=(_68||Prototype.K)(_6a,_6b);if(_69==undefined||_6a<_69){_69=_6a;}});return _69;},partition:function(_6c){var _6d=[],falses=[];this.each(function(_6e,_6f){((_6c||Prototype.K)(_6e,_6f)?_6d:falses).push(_6e);});return [_6d,falses];},pluck:function(_70){var _71=[];this.each(function(_72,_73){_71.push(_72[_70]);});return _71;},reject:function(_74){var _75=[];this.each(function(_76,_77){if(!_74(_76,_77)){_75.push(_76);}});return _75;},sortBy:function(_78){return this.collect(function(_79,_7a){return {value:_79,criteria:_78(_79,_7a)};}).sort(function(_7b,_7c){var a=_7b.criteria,b=_7c.criteria;return a<b?-1:a>b?1:0;}).pluck("value");},toArray:function(){return this.collect(Prototype.K);},zip:function(){var _7e=Prototype.K,args=$A(arguments);if(typeof args.last()=="function"){_7e=args.pop();}var _7f=[this].concat(args).map($A);return this.map(function(_80,_81){return _7e(_7f.pluck(_81));});},inspect:function(){return "#<Enumerable:"+this.toArray().inspect()+">";}};Object.extend(Enumerable,{map:Enumerable.collect,find:Enumerable.detect,select:Enumerable.findAll,member:Enumerable.include,entries:Enumerable.toArray});var $A=Array.from=function(_82){if(!_82){return [];}if(_82.toArray){return _82.toArray();}else{var _83=[];for(var i=0;i<_82.length;i++){_83.push(_82[i]);}return _83;}};Object.extend(Array.prototype,Enumerable);if(!Array.prototype._reverse){Array.prototype._reverse=Array.prototype.reverse;}Object.extend(Array.prototype,{_each:function(_85){for(var i=0;i<this.length;i++){_85(this[i]);}},clear:function(){this.length=0;return this;},first:function(){return this[0];},last:function(){return this[this.length-1];},compact:function(){return this.select(function(_87){return _87!=undefined||_87!=null;});},flatten:function(){return this.inject([],function(_88,_89){return _88.concat(_89&&_89.constructor==Array?_89.flatten():[_89]);});},without:function(){var _8a=$A(arguments);return this.select(function(_8b){return !_8a.include(_8b);});},indexOf:function(_8c){for(var i=0;i<this.length;i++){if(this[i]==_8c){return i;}}return -1;},reverse:function(_8e){return (_8e!==false?this:this.toArray())._reverse();},reduce:function(){return this.length>1?this:this[0];},uniq:function(){return this.inject([],function(_8f,_90){return _8f.include(_90)?_8f:_8f.concat([_90]);});},inspect:function(){return "["+this.map(Object.inspect).join(", ")+"]";}});var Hash={_each:function(_91){for(var key in this){var _93=this[key];if(typeof _93=="function"){continue;}var _94=[key,_93];_94.key=key;_94.value=_93;_91(_94);}},keys:function(){return this.pluck("key");},values:function(){return this.pluck("value");},merge:function(_95){return $H(_95).inject($H(this),function(_96,_97){_96[_97.key]=_97.value;return _96;});},toQueryString:function(){return this.map(function(_98){return _98.map(encodeURIComponent).join("=");}).join("&");},inspect:function(){return "#<Hash:{"+this.map(function(_99){return _99.map(Object.inspect).join(": ");}).join(", ")+"}>";}};function $H(_9a){var _9b=Object.extend({},_9a||{});Object.extend(_9b,Enumerable);Object.extend(_9b,Hash);return _9b;}ObjectRange=Class.create();Object.extend(ObjectRange.prototype,Enumerable);Object.extend(ObjectRange.prototype,{initialize:function(_9c,end,_9e){this.start=_9c;this.end=end;this.exclusive=_9e;},_each:function(_9f){var _a0=this.start;while(this.include(_a0)){_9f(_a0);_a0=_a0.succ();}},include:function(_a1){if(_a1<this.start){return false;}if(this.exclusive){return _a1<this.end;}return _a1<=this.end;}});var $R=function(_a2,end,_a4){return new ObjectRange(_a2,end,_a4);};var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");})||false;},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(_a5){this.responders._each(_a5);},register:function(_a6){if(!this.include(_a6)){this.responders.push(_a6);}},unregister:function(_a7){this.responders=this.responders.without(_a7);},dispatch:function(_a8,_a9,_aa,_ab){this.each(function(_ac){if(_ac[_a8]&&typeof _ac[_a8]=="function"){try{_ac[_a8].apply(_ac,[_a9,_aa,_ab]);}catch(e){}}});}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++;},onComplete:function(){Ajax.activeRequestCount--;}});Ajax.Base=function(){};Ajax.Base.prototype={setOptions:function(_ad){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",parameters:""};Object.extend(this.options,_ad||{});},responseIsSuccess:function(){return this.transport.status==undefined||this.transport.status==0||(this.transport.status>=200&&this.transport.status<300);},responseIsFailure:function(){return !this.responseIsSuccess();}};Ajax.Request=Class.create();Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];Ajax.Request.prototype=Object.extend(new Ajax.Base(),{initialize:function(url,_af){this.transport=Ajax.getTransport();this.setOptions(_af);this.request(url);},request:function(url){var _b1=this.options.parameters||"";if(_b1.length>0){_b1+="&_=";}if(this.options.method!="get"&&this.options.method!="post"){_b1+=(_b1.length>0?"&":"")+"_method="+this.options.method;this.options.method="post";}try{this.url=url;if(this.options.method=="get"&&_b1.length>0){this.url+=(this.url.match(/\?/)?"&":"?")+_b1;}Ajax.Responders.dispatch("onCreate",this,this.transport);this.transport.open(this.options.method,this.url,this.options.asynchronous);if(this.options.asynchronous){setTimeout(function(){this.respondToReadyState(1);}.bind(this),10);}this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();var _b2=this.options.postBody?this.options.postBody:_b1;this.transport.send(this.options.method=="post"?_b2:null);if(!this.options.asynchronous&&this.transport.overrideMimeType){this.onStateChange();}}catch(e){this.dispatchException(e);}},setRequestHeaders:function(){var _b3=["X-Requested-With","XMLHttpRequest","X-Prototype-Version",Prototype.Version,"Accept","text/javascript, text/html, application/xml, text/xml, */*"];if(this.options.method=="post"){_b3.push("Content-type",this.options.contentType);if(this.transport.overrideMimeType){_b3.push("Connection","close");}}if(this.options.requestHeaders){_b3.push.apply(_b3,this.options.requestHeaders);}for(var i=0;i<_b3.length;i+=2){this.transport.setRequestHeader(_b3[i],_b3[i+1]);}},onStateChange:function(){var _b5=this.transport.readyState;if(_b5!=1){this.respondToReadyState(this.transport.readyState);}},header:function(_b6){try{return this.transport.getResponseHeader(_b6);}catch(e){}},evalJSON:function(){try{return eval("("+this.header("X-JSON")+")");}catch(e){}},evalResponse:function(){try{return eval(this.transport.responseText);}catch(e){this.dispatchException(e);}},respondToReadyState:function(_b7){var _b8=Ajax.Request.Events[_b7];var _b9=this.transport,json=this.evalJSON();if(_b8=="Complete"){try{(this.options["on"+this.transport.status]||this.options["on"+(this.responseIsSuccess()?"Success":"Failure")]||Prototype.emptyFunction)(_b9,json);}catch(e){this.dispatchException(e);}if((this.header("Content-type")||"").match(/^text\/javascript/i)){this.evalResponse();}}try{(this.options["on"+_b8]||Prototype.emptyFunction)(_b9,json);Ajax.Responders.dispatch("on"+_b8,this,_b9,json);}catch(e){this.dispatchException(e);}if(_b8=="Complete"){this.transport.onreadystatechange=Prototype.emptyFunction;}},dispatchException:function(_ba){(this.options.onException||Prototype.emptyFunction)(this,_ba);Ajax.Responders.dispatch("onException",this,_ba);}});Ajax.Updater=Class.create();Object.extend(Object.extend(Ajax.Updater.prototype,Ajax.Request.prototype),{initialize:function(_bb,url,_bd){this.containers={success:_bb.success?$(_bb.success):$(_bb),failure:_bb.failure?$(_bb.failure):(_bb.success?null:$(_bb))};this.transport=Ajax.getTransport();this.setOptions(_bd);var _be=this.options.onComplete||Prototype.emptyFunction;this.options.onComplete=(function(_bf,_c0){this.updateContent();_be(_bf,_c0);}).bind(this);this.request(url);},updateContent:function(){var _c1=this.responseIsSuccess()?this.containers.success:this.containers.failure;var _c2=this.transport.responseText;if(!this.options.evalScripts){_c2=_c2.stripScripts();}if(_c1){if(this.options.insertion){new this.options.insertion(_c1,_c2);}else{Element.update(_c1,_c2);}}if(this.responseIsSuccess()){if(this.onComplete){setTimeout(this.onComplete.bind(this),10);}}}});Ajax.PeriodicalUpdater=Class.create();Ajax.PeriodicalUpdater.prototype=Object.extend(new Ajax.Base(),{initialize:function(_c3,url,_c5){this.setOptions(_c5);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=_c3;this.url=url;this.start();},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent();},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments);},updateComplete:function(_c6){if(this.options.decay){this.decay=(_c6.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=_c6.responseText;}this.timer=setTimeout(this.onTimerEvent.bind(this),this.decay*this.frequency*1000);},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options);}});function $(){var _c7=[],element;for(var i=0;i<arguments.length;i++){element=arguments[i];if(typeof element=="string"){element=document.getElementById(element);}_c7.push(Element.extend(element));}return _c7.reduce();}document.getElementsByClassName=function(_c9,_ca){var _cb=($(_ca)||document.body).getElementsByTagName("*");return $A(_cb).inject([],function(_cc,_cd){if(_cd.className.match(new RegExp("(^|\\s)"+_c9+"(\\s|$)"))){_cc.push(Element.extend(_cd));}return _cc;});};if(!window.Element){var Element=new Object();}Element.extend=function(_ce){if(!_ce){return;}if(_nativeExtensions){return _ce;}if(!_ce._extended&&_ce.tagName&&_ce!=window){var _cf=Object.clone(Element.Methods),cache=Element.extend.cache;if(_ce.tagName=="FORM"){Object.extend(_cf,Form.Methods);}if(["INPUT","TEXTAREA","SELECT"].include(_ce.tagName)){Object.extend(_cf,Form.Element.Methods);}for(var _d0 in _cf){var _d1=_cf[_d0];if(typeof _d1=="function"){_ce[_d0]=cache.findOrStore(_d1);}}}_ce._extended=true;return _ce;};Element.extend.cache={findOrStore:function(_d2){return this[_d2]=this[_d2]||function(){return _d2.apply(null,[this].concat($A(arguments)));};}};Element.Methods={visible:function(_d3){return $(_d3).style.display!="none";},toggle:function(_d4){_d4=$(_d4);Element[Element.visible(_d4)?"hide":"show"](_d4);return _d4;},hide:function(_d5){$(_d5).style.display="none";return _d5;},show:function(_d6){$(_d6).style.display="";return _d6;},remove:function(_d7){_d7=$(_d7);_d7.parentNode.removeChild(_d7);return _d7;},update:function(_d8,_d9){$(_d8).innerHTML=_d9.stripScripts();setTimeout(function(){_d9.evalScripts();},10);return _d8;},replace:function(_da,_db){_da=$(_da);if(_da.outerHTML){_da.outerHTML=_db.stripScripts();}else{var _dc=_da.ownerDocument.createRange();_dc.selectNodeContents(_da);_da.parentNode.replaceChild(_dc.createContextualFragment(_db.stripScripts()),_da);}setTimeout(function(){_db.evalScripts();},10);return _da;},inspect:function(_dd){_dd=$(_dd);var _de="<"+_dd.tagName.toLowerCase();$H({"id":"id","className":"class"}).each(function(_df){var _e0=_df.first(),attribute=_df.last();var _e1=(_dd[_e0]||"").toString();if(_e1){_de+=" "+attribute+"="+_e1.inspect(true);}});return _de+">";},recursivelyCollect:function(_e2,_e3){_e2=$(_e2);var _e4=[];while(_e2=_e2[_e3]){if(_e2.nodeType==1){_e4.push(Element.extend(_e2));}}return _e4;},ancestors:function(_e5){return $(_e5).recursivelyCollect("parentNode");},descendants:function(_e6){_e6=$(_e6);return $A(_e6.getElementsByTagName("*"));},previousSiblings:function(_e7){return $(_e7).recursivelyCollect("previousSibling");},nextSiblings:function(_e8){return $(_e8).recursivelyCollect("nextSibling");},siblings:function(_e9){_e9=$(_e9);return _e9.previousSiblings().reverse().concat(_e9.nextSiblings());},match:function(_ea,_eb){_ea=$(_ea);if(typeof _eb=="string"){_eb=new Selector(_eb);}return _eb.match(_ea);},up:function(_ec,_ed,_ee){return Selector.findElement($(_ec).ancestors(),_ed,_ee);},down:function(_ef,_f0,_f1){return Selector.findElement($(_ef).descendants(),_f0,_f1);},previous:function(_f2,_f3,_f4){return Selector.findElement($(_f2).previousSiblings(),_f3,_f4);},next:function(_f5,_f6,_f7){return Selector.findElement($(_f5).nextSiblings(),_f6,_f7);},getElementsBySelector:function(){var _f8=$A(arguments),element=$(_f8.shift());return Selector.findChildElements(element,_f8);},getElementsByClassName:function(_f9,_fa){_f9=$(_f9);return document.getElementsByClassName(_fa,_f9);},getHeight:function(_fb){_fb=$(_fb);return _fb.offsetHeight;},classNames:function(_fc){return new Element.ClassNames(_fc);},hasClassName:function(_fd,_fe){if(!(_fd=$(_fd))){return;}return Element.classNames(_fd).include(_fe);},addClassName:function(_ff,_100){if(!(_ff=$(_ff))){return;}Element.classNames(_ff).add(_100);return _ff;},removeClassName:function(_101,_102){if(!(_101=$(_101))){return;}Element.classNames(_101).remove(_102);return _101;},observe:function(){Event.observe.apply(Event,arguments);return $A(arguments).first();},stopObserving:function(){Event.stopObserving.apply(Event,arguments);return $A(arguments).first();},cleanWhitespace:function(_103){_103=$(_103);for(var i=0;i<_103.childNodes.length;i++){var node=_103.childNodes[i];if(node.nodeType==3&&!/\S/.test(node.nodeValue)){Element.remove(node);}}return _103;},empty:function(_106){return $(_106).innerHTML.match(/^\s*$/);},childOf:function(_107,_108){_107=$(_107),_108=$(_108);while(_107=_107.parentNode){if(_107==_108){return true;}}return false;},scrollTo:function(_109){_109=$(_109);var x=_109.x?_109.x:_109.offsetLeft,y=_109.y?_109.y:_109.offsetTop;window.scrollTo(x,y);return _109;},getStyle:function(_10b,_10c){_10b=$(_10b);var _10d=_10b.style[_10c.camelize()];if(!_10d){if(document.defaultView&&document.defaultView.getComputedStyle){var css=document.defaultView.getComputedStyle(_10b,null);_10d=css?css.getPropertyValue(_10c):null;}else{if(_10b.currentStyle){_10d=_10b.currentStyle[_10c.camelize()];}}}if(window.opera&&["left","top","right","bottom"].include(_10c)){if(Element.getStyle(_10b,"position")=="static"){_10d="auto";}}return _10d=="auto"?null:_10d;},setStyle:function(_10f,_110){_10f=$(_10f);for(var name in _110){_10f.style[name.camelize()]=_110[name];}return _10f;},getDimensions:function(_112){_112=$(_112);if(Element.getStyle(_112,"display")!="none"){return {width:_112.offsetWidth,height:_112.offsetHeight};}var els=_112.style;var _114=els.visibility;var _115=els.position;els.visibility="hidden";els.position="absolute";els.display="";var _116=_112.clientWidth;var _117=_112.clientHeight;els.display="none";els.position=_115;els.visibility=_114;return {width:_116,height:_117};},makePositioned:function(_118){_118=$(_118);var pos=Element.getStyle(_118,"position");if(pos=="static"||!pos){_118._madePositioned=true;_118.style.position="relative";if(window.opera){_118.style.top=0;_118.style.left=0;}}return _118;},undoPositioned:function(_11a){_11a=$(_11a);if(_11a._madePositioned){_11a._madePositioned=undefined;_11a.style.position=_11a.style.top=_11a.style.left=_11a.style.bottom=_11a.style.right="";}return _11a;},makeClipping:function(_11b){_11b=$(_11b);if(_11b._overflow){return;}_11b._overflow=_11b.style.overflow||"auto";if((Element.getStyle(_11b,"overflow")||"visible")!="hidden"){_11b.style.overflow="hidden";}return _11b;},undoClipping:function(_11c){_11c=$(_11c);if(!_11c._overflow){return;}_11c.style.overflow=_11c._overflow=="auto"?"":_11c._overflow;delete _11c._overflow;return _11c;}};if(document.all){Element.Methods.update=function(_11d,html){_11d=$(_11d);var _11f=_11d.tagName.toUpperCase();if(["THEAD","TBODY","TR","TD"].indexOf(_11f)>-1){var div=document.createElement("div");switch(_11f){case "THEAD":case "TBODY":div.innerHTML="<table><tbody>"+html.stripScripts()+"</tbody></table>";depth=2;break;case "TR":div.innerHTML="<table><tbody><tr>"+html.stripScripts()+"</tr></tbody></table>";depth=3;break;case "TD":div.innerHTML="<table><tbody><tr><td>"+html.stripScripts()+"</td></tr></tbody></table>";depth=4;}$A(_11d.childNodes).each(function(node){_11d.removeChild(node);});depth.times(function(){div=div.firstChild;});$A(div.childNodes).each(function(node){_11d.appendChild(node);});}else{_11d.innerHTML=html.stripScripts();}setTimeout(function(){html.evalScripts();},10);return _11d;};}Object.extend(Element,Element.Methods);var _nativeExtensions=false;if(!window.HTMLElement&&/Konqueror|Safari|KHTML/.test(navigator.userAgent)){["","Form","Input","TextArea","Select"].each(function(tag){var _124=window["HTML"+tag+"Element"]={};_124.prototype=document.createElement(tag?tag.toLowerCase():"div").__proto__;});}Element.addMethods=function(_125){Object.extend(Element.Methods,_125||{});function copy(_126,_127){var _128=Element.extend.cache;for(var _129 in _126){var _12a=_126[_129];_127[_129]=_128.findOrStore(_12a);}}if(typeof HTMLElement!="undefined"){copy(Element.Methods,HTMLElement.prototype);copy(Form.Methods,HTMLFormElement.prototype);[HTMLInputElement,HTMLTextAreaElement,HTMLSelectElement].each(function(_12b){copy(Form.Element.Methods,_12b.prototype);});_nativeExtensions=true;}};var Toggle=new Object();Toggle.display=Element.toggle;Abstract.Insertion=function(_12c){this.adjacency=_12c;};Abstract.Insertion.prototype={initialize:function(_12d,_12e){this.element=$(_12d);this.content=_12e.stripScripts();if(this.adjacency&&this.element.insertAdjacentHTML){try{this.element.insertAdjacentHTML(this.adjacency,this.content);}catch(e){var _12f=this.element.tagName.toLowerCase();if(_12f=="tbody"||_12f=="tr"){this.insertContent(this.contentFromAnonymousTable());}else{throw e;}}}else{this.range=this.element.ownerDocument.createRange();if(this.initializeRange){this.initializeRange();}this.insertContent([this.range.createContextualFragment(this.content)]);}setTimeout(function(){_12e.evalScripts();},10);},contentFromAnonymousTable:function(){var div=document.createElement("div");div.innerHTML="<table><tbody>"+this.content+"</tbody></table>";return $A(div.childNodes[0].childNodes[0].childNodes);}};var Insertion=new Object();Insertion.Before=Class.create();Insertion.Before.prototype=Object.extend(new Abstract.Insertion("beforeBegin"),{initializeRange:function(){this.range.setStartBefore(this.element);},insertContent:function(_131){_131.each((function(_132){this.element.parentNode.insertBefore(_132,this.element);}).bind(this));}});Insertion.Top=Class.create();Insertion.Top.prototype=Object.extend(new Abstract.Insertion("afterBegin"),{initializeRange:function(){this.range.selectNodeContents(this.element);this.range.collapse(true);},insertContent:function(_133){_133.reverse(false).each((function(_134){this.element.insertBefore(_134,this.element.firstChild);}).bind(this));}});Insertion.Bottom=Class.create();Insertion.Bottom.prototype=Object.extend(new Abstract.Insertion("beforeEnd"),{initializeRange:function(){this.range.selectNodeContents(this.element);this.range.collapse(this.element);},insertContent:function(_135){_135.each((function(_136){this.element.appendChild(_136);}).bind(this));}});Insertion.After=Class.create();Insertion.After.prototype=Object.extend(new Abstract.Insertion("afterEnd"),{initializeRange:function(){this.range.setStartAfter(this.element);},insertContent:function(_137){_137.each((function(_138){this.element.parentNode.insertBefore(_138,this.element.nextSibling);}).bind(this));}});Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(_139){this.element=$(_139);},_each:function(_13a){this.element.className.split(/\s+/).select(function(name){return name.length>0;})._each(_13a);},set:function(_13c){this.element.className=_13c;},add:function(_13d){if(this.include(_13d)){return;}this.set(this.toArray().concat(_13d).join(" "));},remove:function(_13e){if(!this.include(_13e)){return;}this.set(this.select(function(_13f){return _13f!=_13e;}).join(" "));},toString:function(){return this.toArray().join(" ");}};Object.extend(Element.ClassNames.prototype,Enumerable);var Selector=Class.create();Selector.prototype={initialize:function(_140){this.params={classNames:[]};this.expression=_140.toString().strip();this.parseExpression();this.compileMatcher();},parseExpression:function(){function abort(_141){throw "Parse error in selector: "+_141;}if(this.expression==""){abort("empty expression");}var _142=this.params,expr=this.expression,match,modifier,clause,rest;while(match=expr.match(/^(.*)\[([a-z0-9_:-]+?)(?:([~\|!]?=)(?:"([^"]*)"|([^\]\s]*)))?\]$/i)){_142.attributes=_142.attributes||[];_142.attributes.push({name:match[2],operator:match[3],value:match[4]||match[5]||""});expr=match[1];}if(expr=="*"){return this.params.wildcard=true;}while(match=expr.match(/^([^a-z0-9_-])?([a-z0-9_-]+)(.*)/i)){modifier=match[1],clause=match[2],rest=match[3];switch(modifier){case "#":_142.id=clause;break;case ".":_142.classNames.push(clause);break;case "":case undefined:_142.tagName=clause.toUpperCase();break;default:abort(expr.inspect());}expr=rest;}if(expr.length>0){abort(expr.inspect());}},buildMatchExpression:function(){var _143=this.params,conditions=[],clause;if(_143.wildcard){conditions.push("true");}if(clause=_143.id){conditions.push("element.id == "+clause.inspect());}if(clause=_143.tagName){conditions.push("element.tagName.toUpperCase() == "+clause.inspect());}if((clause=_143.classNames).length>0){for(var i=0;i<clause.length;i++){conditions.push("Element.hasClassName(element, "+clause[i].inspect()+")");}}if(clause=_143.attributes){clause.each(function(_145){var _146="element.getAttribute("+_145.name.inspect()+")";var _147=function(_148){return _146+" && "+_146+".split("+_148.inspect()+")";};switch(_145.operator){case "=":conditions.push(_146+" == "+_145.value.inspect());break;case "~=":conditions.push(_147(" ")+".include("+_145.value.inspect()+")");break;case "|=":conditions.push(_147("-")+".first().toUpperCase() == "+_145.value.toUpperCase().inspect());break;case "!=":conditions.push(_146+" != "+_145.value.inspect());break;case "":case undefined:conditions.push(_146+" != null");break;default:throw "Unknown operator "+_145.operator+" in selector";}});}return conditions.join(" && ");},compileMatcher:function(){this.match=new Function("element","if (!element.tagName) return false;       return "+this.buildMatchExpression());},findElements:function(_149){var _14a;if(_14a=$(this.params.id)){if(this.match(_14a)){if(!_149||Element.childOf(_14a,_149)){return [_14a];}}}_149=(_149||document).getElementsByTagName(this.params.tagName||"*");var _14b=[];for(var i=0;i<_149.length;i++){if(this.match(_14a=_149[i])){_14b.push(Element.extend(_14a));}}return _14b;},toString:function(){return this.expression;}};Object.extend(Selector,{matchElements:function(_14d,_14e){var _14f=new Selector(_14e);return _14d.select(_14f.match.bind(_14f));},findElement:function(_150,_151,_152){if(typeof _151=="number"){_152=_151,_151=false;}return Selector.matchElements(_150,_151||"*")[_152||0];},findChildElements:function(_153,_154){return _154.map(function(_155){return _155.strip().split(/\s+/).inject([null],function(_156,expr){var _158=new Selector(expr);return _156.inject([],function(_159,_15a){return _159.concat(_158.findElements(_15a||_153));});});}).flatten();}});function $$(){return Selector.findChildElements(document,$A(arguments));}var Form={reset:function(form){$(form).reset();return form;}};Form.Methods={serialize:function(form){var _15d=Form.getElements($(form));var _15e=new Array();for(var i=0;i<_15d.length;i++){var _160=Form.Element.serialize(_15d[i]);if(_160){_15e.push(_160);}}return _15e.join("&");},getElements:function(form){form=$(form);var _162=new Array();for(var _163 in Form.Element.Serializers){var _164=form.getElementsByTagName(_163);for(var j=0;j<_164.length;j++){_162.push(_164[j]);}}return _162;},getInputs:function(form,_167,name){form=$(form);var _169=form.getElementsByTagName("input");if(!_167&&!name){return _169;}var _16a=new Array();for(var i=0;i<_169.length;i++){var _16c=_169[i];if((_167&&_16c.type!=_167)||(name&&_16c.name!=name)){continue;}_16a.push(_16c);}return _16a;},disable:function(form){form=$(form);var _16e=Form.getElements(form);for(var i=0;i<_16e.length;i++){var _170=_16e[i];_170.blur();_170.disabled="true";}return form;},enable:function(form){form=$(form);var _172=Form.getElements(form);for(var i=0;i<_172.length;i++){var _174=_172[i];_174.disabled="";}return form;},findFirstElement:function(form){return Form.getElements(form).find(function(_176){return _176.type!="hidden"&&!_176.disabled&&["input","select","textarea"].include(_176.tagName.toLowerCase());});},focusFirstElement:function(form){form=$(form);Field.activate(Form.findFirstElement(form));return form;}};Object.extend(Form,Form.Methods);Form.Element={focus:function(_178){$(_178).focus();return _178;},select:function(_179){$(_179).select();return _179;}};Form.Element.Methods={serialize:function(_17a){_17a=$(_17a);var _17b=_17a.tagName.toLowerCase();var _17c=Form.Element.Serializers[_17b](_17a);if(_17c){var key=encodeURIComponent(_17c[0]);if(key.length==0){return;}if(_17c[1].constructor!=Array){_17c[1]=[_17c[1]];}return _17c[1].map(function(_17e){return key+"="+encodeURIComponent(_17e);}).join("&");}},getValue:function(_17f){_17f=$(_17f);var _180=_17f.tagName.toLowerCase();var _181=Form.Element.Serializers[_180](_17f);if(_181){return _181[1];}},clear:function(_182){$(_182).value="";return _182;},present:function(_183){return $(_183).value!="";},activate:function(_184){_184=$(_184);_184.focus();if(_184.select){_184.select();}return _184;},disable:function(_185){_185=$(_185);_185.disabled="";return _185;},enable:function(_186){_186=$(_186);_186.blur();_186.disabled="true";return _186;}};Object.extend(Form.Element,Form.Element.Methods);var Field=Form.Element;Form.Element.Serializers={input:function(_187){switch(_187.type.toLowerCase()){case "checkbox":case "radio":return Form.Element.Serializers.inputSelector(_187);default:return Form.Element.Serializers.textarea(_187);}return false;},inputSelector:function(_188){if(_188.checked){return [_188.name,_188.value];}},textarea:function(_189){return [_189.name,_189.value];},select:function(_18a){return Form.Element.Serializers[_18a.type=="select-one"?"selectOne":"selectMany"](_18a);},selectOne:function(_18b){var _18c="",opt,index=_18b.selectedIndex;if(index>=0){opt=_18b.options[index];_18c=opt.value||opt.text;}return [_18b.name,_18c];},selectMany:function(_18d){var _18e=[];for(var i=0;i<_18d.length;i++){var opt=_18d.options[i];if(opt.selected){_18e.push(opt.value||opt.text);}}return [_18d.name,_18e];}};var $F=Form.Element.getValue;Abstract.TimedObserver=function(){};Abstract.TimedObserver.prototype={initialize:function(_191,_192,_193){this.frequency=_192;this.element=$(_191);this.callback=_193;this.lastValue=this.getValue();this.registerCallback();},registerCallback:function(){setInterval(this.onTimerEvent.bind(this),this.frequency*1000);},onTimerEvent:function(){var _194=this.getValue();if(this.lastValue!=_194){this.callback(this.element,_194);this.lastValue=_194;}}};Form.Element.Observer=Class.create();Form.Element.Observer.prototype=Object.extend(new Abstract.TimedObserver(),{getValue:function(){return Form.Element.getValue(this.element);}});Form.Observer=Class.create();Form.Observer.prototype=Object.extend(new Abstract.TimedObserver(),{getValue:function(){return Form.serialize(this.element);}});Abstract.EventObserver=function(){};Abstract.EventObserver.prototype={initialize:function(_195,_196){this.element=$(_195);this.callback=_196;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=="form"){this.registerFormCallbacks();}else{this.registerCallback(this.element);}},onElementEvent:function(){var _197=this.getValue();if(this.lastValue!=_197){this.callback(this.element,_197);this.lastValue=_197;}},registerFormCallbacks:function(){var _198=Form.getElements(this.element);for(var i=0;i<_198.length;i++){this.registerCallback(_198[i]);}},registerCallback:function(_19a){if(_19a.type){switch(_19a.type.toLowerCase()){case "checkbox":case "radio":Event.observe(_19a,"click",this.onElementEvent.bind(this));break;default:Event.observe(_19a,"change",this.onElementEvent.bind(this));break;}}}};Form.Element.EventObserver=Class.create();Form.Element.EventObserver.prototype=Object.extend(new Abstract.EventObserver(),{getValue:function(){return Form.Element.getValue(this.element);}});Form.EventObserver=Class.create();Form.EventObserver.prototype=Object.extend(new Abstract.EventObserver(),{getValue:function(){return Form.serialize(this.element);}});if(!window.Event){var Event=new Object();}Object.extend(Event,{KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,element:function(_19b){return _19b.target||_19b.srcElement;},isLeftClick:function(_19c){return (((_19c.which)&&(_19c.which==1))||((_19c.button)&&(_19c.button==1)));},pointerX:function(_19d){return _19d.pageX||(_19d.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft));},pointerY:function(_19e){return _19e.pageY||(_19e.clientY+(document.documentElement.scrollTop||document.body.scrollTop));},stop:function(_19f){if(_19f.preventDefault){_19f.preventDefault();_19f.stopPropagation();}else{_19f.returnValue=false;_19f.cancelBubble=true;}},findElement:function(_1a0,_1a1){var _1a2=Event.element(_1a0);while(_1a2.parentNode&&(!_1a2.tagName||(_1a2.tagName.toUpperCase()!=_1a1.toUpperCase()))){_1a2=_1a2.parentNode;}return _1a2;},observers:false,_observeAndCache:function(_1a3,name,_1a5,_1a6){if(!this.observers){this.observers=[];}if(_1a3.addEventListener){this.observers.push([_1a3,name,_1a5,_1a6]);_1a3.addEventListener(name,_1a5,_1a6);}else{if(_1a3.attachEvent){this.observers.push([_1a3,name,_1a5,_1a6]);_1a3.attachEvent("on"+name,_1a5);}}},unloadCache:function(){if(!Event.observers){return;}for(var i=0;i<Event.observers.length;i++){Event.stopObserving.apply(this,Event.observers[i]);Event.observers[i][0]=null;}Event.observers=false;},observe:function(_1a8,name,_1aa,_1ab){_1a8=$(_1a8);_1ab=_1ab||false;if(name=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||_1a8.attachEvent)){name="keydown";}Event._observeAndCache(_1a8,name,_1aa,_1ab);},stopObserving:function(_1ac,name,_1ae,_1af){_1ac=$(_1ac);_1af=_1af||false;if(name=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||_1ac.detachEvent)){name="keydown";}if(_1ac.removeEventListener){_1ac.removeEventListener(name,_1ae,_1af);}else{if(_1ac.detachEvent){try{_1ac.detachEvent("on"+name,_1ae);}catch(e){}}}}});if(navigator.appVersion.match(/\bMSIE\b/)){Event.observe(window,"unload",Event.unloadCache,false);}var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;},realOffset:function(_1b0){var _1b1=0,valueL=0;do{_1b1+=_1b0.scrollTop||0;valueL+=_1b0.scrollLeft||0;_1b0=_1b0.parentNode;}while(_1b0);return [valueL,_1b1];},cumulativeOffset:function(_1b2){var _1b3=0,valueL=0;do{_1b3+=_1b2.offsetTop||0;valueL+=_1b2.offsetLeft||0;_1b2=_1b2.offsetParent;}while(_1b2);return [valueL,_1b3];},positionedOffset:function(_1b4){var _1b5=0,valueL=0;do{_1b5+=_1b4.offsetTop||0;valueL+=_1b4.offsetLeft||0;_1b4=_1b4.offsetParent;if(_1b4){p=Element.getStyle(_1b4,"position");if(p=="relative"||p=="absolute"){break;}}}while(_1b4);return [valueL,_1b5];},offsetParent:function(_1b6){if(_1b6.offsetParent){return _1b6.offsetParent;}if(_1b6==document.body){return _1b6;}while((_1b6=_1b6.parentNode)&&_1b6!=document.body){if(Element.getStyle(_1b6,"position")!="static"){return _1b6;}}return document.body;},setup_cache:function(){this.cache_setup=0;},within:function(_1b7,x,y){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(_1b7,x,y);}this.xcomp=x;this.ycomp=y;if(!this.cache_setup){setTimeout(this.setup_cache.bind(this),200);this.cache_setup=1;this.stored_offsets={};}this.offset=this.stored_offsets[_1b7.id];if(!this.offset){this.offset=this.cumulativeOffset(_1b7);this.stored_offsets[_1b7.id]=this.offset;}return (y>=this.offset[1]&&y<this.offset[1]+_1b7.offsetHeight&&x>=this.offset[0]&&x<this.offset[0]+_1b7.offsetWidth);},withinIncludingScrolloffsets:function(_1ba,x,y){var _1bd=this.realOffset(_1ba);this.xcomp=x+_1bd[0]-this.deltaX;this.ycomp=y+_1bd[1]-this.deltaY;this.offset=this.cumulativeOffset(_1ba);return (this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+_1ba.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+_1ba.offsetWidth);},overlap:function(mode,_1bf){if(!mode){return 0;}if(mode=="vertical"){return ((this.offset[1]+_1bf.offsetHeight)-this.ycomp)/_1bf.offsetHeight;}if(mode=="horizontal"){return ((this.offset[0]+_1bf.offsetWidth)-this.xcomp)/_1bf.offsetWidth;}},page:function(_1c0){var _1c1=0,valueL=0;var _1c2=_1c0;do{_1c1+=_1c2.offsetTop||0;valueL+=_1c2.offsetLeft||0;if(_1c2.offsetParent==document.body){if(Element.getStyle(_1c2,"position")=="absolute"){break;}}}while(_1c2=_1c2.offsetParent);_1c2=_1c0;do{if(!window.opera||_1c2.tagName=="BODY"){_1c1-=_1c2.scrollTop||0;valueL-=_1c2.scrollLeft||0;}}while(_1c2=_1c2.parentNode);return [valueL,_1c1];},clone:function(_1c3,_1c4){var _1c5=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});_1c3=$(_1c3);var p=Position.page(_1c3);_1c4=$(_1c4);var _1c7=[0,0];var _1c8=null;if(Element.getStyle(_1c4,"position")=="absolute"){_1c8=Position.offsetParent(_1c4);_1c7=Position.page(_1c8);}if(_1c8==document.body){_1c7[0]-=document.body.offsetLeft;_1c7[1]-=document.body.offsetTop;}if(_1c5.setLeft){_1c4.style.left=(p[0]-_1c7[0]+_1c5.offsetLeft)+"px";}if(_1c5.setTop){_1c4.style.top=(p[1]-_1c7[1]+_1c5.offsetTop)+"px";}if(_1c5.setWidth){_1c4.style.width=_1c3.offsetWidth+"px";}if(_1c5.setHeight){_1c4.style.height=_1c3.offsetHeight+"px";}},absolutize:function(_1c9){_1c9=$(_1c9);if(_1c9.style.position=="absolute"){return;}Position.prepare();var _1ca=Position.positionedOffset(_1c9);var top=_1ca[1];var left=_1ca[0];var _1cd=_1c9.clientWidth;var _1ce=_1c9.clientHeight;_1c9._originalLeft=left-parseFloat(_1c9.style.left||0);_1c9._originalTop=top-parseFloat(_1c9.style.top||0);_1c9._originalWidth=_1c9.style.width;_1c9._originalHeight=_1c9.style.height;_1c9.style.position="absolute";_1c9.style.top=top+"px";_1c9.style.left=left+"px";_1c9.style.width=_1cd+"px";_1c9.style.height=_1ce+"px";},relativize:function(_1cf){_1cf=$(_1cf);if(_1cf.style.position=="relative"){return;}Position.prepare();_1cf.style.position="relative";var top=parseFloat(_1cf.style.top||0)-(_1cf._originalTop||0);var left=parseFloat(_1cf.style.left||0)-(_1cf._originalLeft||0);_1cf.style.top=top+"px";_1cf.style.left=left+"px";_1cf.style.height=_1cf._originalHeight;_1cf.style.width=_1cf._originalWidth;}};if(/Konqueror|Safari|KHTML/.test(navigator.userAgent)){Position.cumulativeOffset=function(_1d2){var _1d3=0,valueL=0;do{_1d3+=_1d2.offsetTop||0;valueL+=_1d2.offsetLeft||0;if(_1d2.offsetParent==document.body){if(Element.getStyle(_1d2,"position")=="absolute"){break;}}_1d2=_1d2.offsetParent;}while(_1d2);return [valueL,_1d3];};}Element.addMethods();function getElementsBySelector(_1d4,_1d5){var _1d6=_1d5.split(" ");var i;var _1d8=[_1d4];var _1d9=false;for(i=0;i<_1d6.length;++i){var _1da=_1d6[i];var _1db;_1db=_1da.split("#");if(_1db.length>1){var j;var _1dd=_1db[0];var sel=_1db[1];var els=[];for(j=0;j<_1d8.length;++j){els[els.length]=$A(_1d8[j].getElementsByTagName(_1dd||"*")).filter(function(el){return el.id==sel;});}_1d8=els.flatten();_1d9=true;continue;}_1db=_1da.split(".");if(_1db.length>1){var j;var _1e2=_1db[0];var sel=_1db[1];var els=[];for(j=0;j<_1d8.length;++j){els[els.length]=$A(_1d8[j].getElementsByTagName(_1e2||"*")).filter(function(el){return hasClass(el,sel);});}_1d8=els.flatten();_1d9=true;continue;}}return _1d9?_1d8:[];}var Behavior={rules:[],apply:function(){var i;for(i=0;i<Behavior.rules.length;++i){var _1e7=Behavior.rules[i];var rule;for(rule in _1e7){if(rule instanceof Function){continue;}var _1e9=$$(rule);var _1ea=getElementsBySelector(document,rule);_1ea.each(function(_1eb){_1e7[rule](_1eb);});}}},applySelectedRule:function(_1ec){var i;for(i=0;i<Behavior.rules.length;++i){var _1ee=Behavior.rules[i];var rule=_1ee[_1ec];if(!rule||!(rule instanceof Function)){continue;}var _1f0=getElementsBySelector(document,_1ec);_1f0.each(function(_1f1){rule(_1f1);});}},register:function(_1f2){Behavior.rules.push(_1f2);},init:function(){Event.observe(window,"load",Behavior.apply);}};Behavior.init();var Rico={Version:"1.1.2",prototypeVersion:parseFloat(Prototype.Version.split(".")[0]+"."+Prototype.Version.split(".")[1])};if((typeof Prototype=="undefined")||Rico.prototypeVersion<1.3){throw ("Rico requires the Prototype JavaScript framework >= 1.3");}Rico.ArrayExtensions=new Array();if(Object.prototype.extend){Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Object.prototype.extend;}else{Object.prototype.extend=function(_1f3){return Object.extend.apply(this,[this,_1f3]);};Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Object.prototype.extend;}if(Array.prototype.push){Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.push;}if(!Array.prototype.remove){Array.prototype.remove=function(dx){if(isNaN(dx)||dx>this.length){return false;}for(var i=0,n=0;i<this.length;i++){if(i!=dx){this[n++]=this[i];}}this.length-=1;};Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.remove;}if(!Array.prototype.removeItem){Array.prototype.removeItem=function(item){for(var i=0;i<this.length;i++){if(this[i]==item){this.remove(i);break;}}};Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.removeItem;}if(!Array.prototype.indices){Array.prototype.indices=function(){var _1f8=new Array();for(index in this){var _1f9=false;for(var i=0;i<Rico.ArrayExtensions.length;i++){if(this[index]==Rico.ArrayExtensions[i]){_1f9=true;break;}}if(!_1f9){_1f8[_1f8.length]=index;}}return _1f8;};Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.indices;}if(window.DOMParser&&window.XMLSerializer&&window.Node&&Node.prototype&&Node.prototype.__defineGetter__){if(!Document.prototype.loadXML){Document.prototype.loadXML=function(s){var doc2=(new DOMParser()).parseFromString(s,"text/xml");while(this.hasChildNodes()){this.removeChild(this.lastChild);}for(var i=0;i<doc2.childNodes.length;i++){this.appendChild(this.importNode(doc2.childNodes[i],true));}};}Document.prototype.__defineGetter__("xml",function(){return (new XMLSerializer()).serializeToString(this);});}document.getElementsByTagAndClassName=function(_1fe,_1ff){if(_1fe==null){_1fe="*";}var _200=document.getElementsByTagName(_1fe)||document.all;var _201=new Array();if(_1ff==null){return _200;}for(var i=0;i<_200.length;i++){var _203=_200[i];var _204=_203.className.split(" ");for(var j=0;j<_204.length;j++){if(_204[j]==_1ff){_201.push(_203);break;}}}return _201;};Rico.Accordion=Class.create();Rico.Accordion.prototype={initialize:function(_206,_207){this.container=$(_206);this.lastExpandedTab=null;this.accordionTabs=new Array();this.setOptions(_207);this._attachBehaviors();if(!_206){return;}this.container.style.borderBottom="1px solid "+this.options.borderColor;if(this.options.onLoadShowTab>=this.accordionTabs.length){this.options.onLoadShowTab=0;}for(var i=0;i<this.accordionTabs.length;i++){if(i!=this.options.onLoadShowTab){this.accordionTabs[i].collapse();this.accordionTabs[i].content.style.display="none";}}this.lastExpandedTab=this.accordionTabs[this.options.onLoadShowTab];if(this.options.panelHeight=="auto"){var _209=(this.options.onloadShowTab===0)?1:0;var _20a=parseInt(RicoUtil.getElementsComputedStyle(this.accordionTabs[_209].titleBar,"height"));if(isNaN(_20a)){_20a=this.accordionTabs[_209].titleBar.offsetHeight;}var _20b=this.accordionTabs.length*_20a;var _20c=parseInt(RicoUtil.getElementsComputedStyle(this.container.parentNode,"height"));if(isNaN(_20c)){_20c=this.container.parentNode.offsetHeight;}this.options.panelHeight=_20c-_20b-2;}this.lastExpandedTab.content.style.height=this.options.panelHeight+"px";this.lastExpandedTab.showExpanded();this.lastExpandedTab.titleBar.style.fontWeight=this.options.expandedFontWeight;},setOptions:function(_20d){this.options={expandedBg:"#63699c",hoverBg:"#63699c",collapsedBg:"#6b79a5",expandedTextColor:"#ffffff",expandedFontWeight:"bold",hoverTextColor:"#ffffff",collapsedTextColor:"#ced7ef",collapsedFontWeight:"normal",hoverTextColor:"#ffffff",borderColor:"#1f669b",panelHeight:200,onHideTab:null,onShowTab:null,onLoadShowTab:0};Object.extend(this.options,_20d||{});},showTabByIndex:function(_20e,_20f){var _210=arguments.length==1?true:_20f;this.showTab(this.accordionTabs[_20e],_210);},showTab:function(_211,_212){if(this.lastExpandedTab==_211){return;}var _213=arguments.length==1?true:_212;if(this.options.onHideTab){this.options.onHideTab(this.lastExpandedTab);}this.lastExpandedTab.showCollapsed();var _214=this;var _215=this.lastExpandedTab;this.lastExpandedTab.content.style.height=(this.options.panelHeight-1)+"px";_211.content.style.display="";_211.titleBar.style.fontWeight=this.options.expandedFontWeight;if(_213){new Rico.Effect.AccordionSize(this.lastExpandedTab.content,_211.content,1,this.options.panelHeight,100,10,{complete:function(){_214.showTabDone(_215);}});this.lastExpandedTab=_211;}else{this.lastExpandedTab.content.style.height="1px";_211.content.style.height=this.options.panelHeight+"px";this.lastExpandedTab=_211;this.showTabDone(_215);}},showTabDone:function(_216){_216.content.style.display="none";this.lastExpandedTab.showExpanded();if(this.options.onShowTab){this.options.onShowTab(this.lastExpandedTab);}},_attachBehaviors:function(){var _217=this._getDirectChildrenByTag(this.container,"DIV");for(var i=0;i<_217.length;i++){var _219=this._getDirectChildrenByTag(_217[i],"DIV");if(_219.length!=2){continue;}var _21a=_219[0];var _21b=_219[1];this.accordionTabs.push(new Rico.Accordion.Tab(this,_21a,_21b));}},_getDirectChildrenByTag:function(e,_21d){var kids=new Array();var _21f=e.childNodes;for(var i=0;i<_21f.length;i++){if(_21f[i]&&_21f[i].tagName&&_21f[i].tagName==_21d){kids.push(_21f[i]);}}return kids;}};Rico.Accordion.Tab=Class.create();Rico.Accordion.Tab.prototype={initialize:function(_221,_222,_223){this.accordion=_221;this.titleBar=_222;this.content=_223;this._attachBehaviors();},collapse:function(){this.showCollapsed();this.content.style.height="1px";},showCollapsed:function(){this.expanded=false;this.titleBar.style.backgroundColor=this.accordion.options.collapsedBg;this.titleBar.style.color=this.accordion.options.collapsedTextColor;this.titleBar.style.fontWeight=this.accordion.options.collapsedFontWeight;this.content.style.overflow="hidden";},showExpanded:function(){this.expanded=true;this.titleBar.style.backgroundColor=this.accordion.options.expandedBg;this.titleBar.style.color=this.accordion.options.expandedTextColor;this.content.style.overflow="auto";},titleBarClicked:function(e){if(this.accordion.lastExpandedTab==this){return;}this.accordion.showTab(this);},hover:function(e){this.titleBar.style.backgroundColor=this.accordion.options.hoverBg;this.titleBar.style.color=this.accordion.options.hoverTextColor;},unhover:function(e){if(this.expanded){this.titleBar.style.backgroundColor=this.accordion.options.expandedBg;this.titleBar.style.color=this.accordion.options.expandedTextColor;}else{this.titleBar.style.backgroundColor=this.accordion.options.collapsedBg;this.titleBar.style.color=this.accordion.options.collapsedTextColor;}},_attachBehaviors:function(){this.content.style.border="1px solid "+this.accordion.options.borderColor;this.content.style.borderTopWidth="0px";this.content.style.borderBottomWidth="0px";this.content.style.margin="0px";this.titleBar.onclick=this.titleBarClicked.bindAsEventListener(this);this.titleBar.onmouseover=this.hover.bindAsEventListener(this);this.titleBar.onmouseout=this.unhover.bindAsEventListener(this);}};Rico.AjaxEngine=Class.create();Rico.AjaxEngine.prototype={initialize:function(){this.ajaxElements=new Array();this.ajaxObjects=new Array();this.requestURLS=new Array();this.options={};},registerAjaxElement:function(anId,_228){if(!_228){_228=$(anId);}this.ajaxElements[anId]=_228;},registerAjaxObject:function(anId,_22a){this.ajaxObjects[anId]=_22a;},registerRequest:function(_22b,_22c){this.requestURLS[_22b]=_22c;},sendRequest:function(_22d,_22e){if(arguments.length>=2){if(typeof arguments[1]=="string"){_22e={parameters:this._createQueryString(arguments,1)};}}this.sendRequestWithData(_22d,null,_22e);},sendRequestWithData:function(_22f,_230,_231){var _232=this.requestURLS[_22f];if(_232==null){return;}if(arguments.length>=3){if(typeof arguments[2]=="string"){_231.parameters=this._createQueryString(arguments,2);}}new Ajax.Request(_232,this._requestOptions(_231,_230));},sendRequestAndUpdate:function(_233,_234,_235){if(arguments.length>=3){if(typeof arguments[2]=="string"){_235.parameters=this._createQueryString(arguments,2);}}this.sendRequestWithDataAndUpdate(_233,null,_234,_235);},sendRequestWithDataAndUpdate:function(_236,_237,_238,_239){var _23a=this.requestURLS[_236];if(_23a==null){return;}if(arguments.length>=4){if(typeof arguments[3]=="string"){_239.parameters=this._createQueryString(arguments,3);}}var _23b=this._requestOptions(_239,_237);new Ajax.Updater(_238,_23a,_23b);},_requestOptions:function(_23c,_23d){var _23e=["X-Rico-Version",Rico.Version];var _23f="post";if(_23d==null){if(Rico.prototypeVersion<1.4){_23e.push("Content-type","text/xml");}else{_23f="get";}}(!_23c)?_23c={}:"";if(!_23c._RicoOptionsProcessed){if(_23c.onComplete){_23c.onRicoComplete=_23c.onComplete;}if(_23c.overrideOnComplete){_23c.onComplete=_23c.overrideOnComplete;}else{_23c.onComplete=this._onRequestComplete.bind(this);}_23c._RicoOptionsProcessed=true;}this.options={requestHeaders:_23e,parameters:_23c.parameters,postBody:_23d,method:_23f,onComplete:_23c.onComplete};Object.extend(this.options,_23c);return this.options;},_createQueryString:function(_240,_241){var _242="";for(var i=_241;i<_240.length;i++){if(i!=_241){_242+="&";}var _244=_240[i];if(_244.name!=undefined&&_244.value!=undefined){_242+=_244.name+"="+escape(_244.value);}else{var ePos=_244.indexOf("=");var _246=_244.substring(0,ePos);var _247=_244.substring(ePos+1);_242+=_246+"="+escape(_247);}}return _242;},_onRequestComplete:function(_248){if(!_248){return;}if(_248.status!=200){return;}var _249=_248.responseXML.getElementsByTagName("ajax-response");if(_249==null||_249.length!=1){return;}this._processAjaxResponse(_249[0].childNodes);var _24a=this.options.onRicoComplete;if(_24a!=null){_24a();}},_processAjaxResponse:function(_24b){for(var i=0;i<_24b.length;i++){var _24d=_24b[i];if(_24d.nodeType!=1){continue;}var _24e=_24d.getAttribute("type");var _24f=_24d.getAttribute("id");if(_24e=="object"){this._processAjaxObjectUpdate(this.ajaxObjects[_24f],_24d);}else{if(_24e=="element"){this._processAjaxElementUpdate(this.ajaxElements[_24f],_24d);}else{alert("unrecognized AjaxResponse type : "+_24e);}}}},_processAjaxObjectUpdate:function(_250,_251){_250.ajaxUpdate(_251);},_processAjaxElementUpdate:function(_252,_253){_252.innerHTML=RicoUtil.getContentAsString(_253);}};var ajaxEngine=new Rico.AjaxEngine();Rico.Color=Class.create();Rico.Color.prototype={initialize:function(red,_255,blue){this.rgb={r:red,g:_255,b:blue};},setRed:function(r){this.rgb.r=r;},setGreen:function(g){this.rgb.g=g;},setBlue:function(b){this.rgb.b=b;},setHue:function(h){var hsb=this.asHSB();hsb.h=h;this.rgb=Rico.Color.HSBtoRGB(hsb.h,hsb.s,hsb.b);},setSaturation:function(s){var hsb=this.asHSB();hsb.s=s;this.rgb=Rico.Color.HSBtoRGB(hsb.h,hsb.s,hsb.b);},setBrightness:function(b){var hsb=this.asHSB();hsb.b=b;this.rgb=Rico.Color.HSBtoRGB(hsb.h,hsb.s,hsb.b);},darken:function(_260){var hsb=this.asHSB();this.rgb=Rico.Color.HSBtoRGB(hsb.h,hsb.s,Math.max(hsb.b-_260,0));},brighten:function(_262){var hsb=this.asHSB();this.rgb=Rico.Color.HSBtoRGB(hsb.h,hsb.s,Math.min(hsb.b+_262,1));},blend:function(_264){this.rgb.r=Math.floor((this.rgb.r+_264.rgb.r)/2);this.rgb.g=Math.floor((this.rgb.g+_264.rgb.g)/2);this.rgb.b=Math.floor((this.rgb.b+_264.rgb.b)/2);},isBright:function(){var hsb=this.asHSB();return this.asHSB().b>0.5;},isDark:function(){return !this.isBright();},asRGB:function(){return "rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")";},asHex:function(){return "#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart();},asHSB:function(){return Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b);},toString:function(){return this.asHex();}};Rico.Color.createFromHex=function(_266){if(_266.length==4){var _267=_266;var _268="#";for(var i=1;i<4;i++){_268+=(_267.charAt(i)+_267.charAt(i));}}if(_268.indexOf("#")==0){_268=_268.substring(1);}var red=_268.substring(0,2);var _26b=_268.substring(2,4);var blue=_268.substring(4,6);return new Rico.Color(parseInt(red,16),parseInt(_26b,16),parseInt(blue,16));};Rico.Color.createColorFromBackground=function(elem){var _26e=RicoUtil.getElementsComputedStyle($(elem),"backgroundColor","background-color");if(_26e=="transparent"&&elem.parentNode){return Rico.Color.createColorFromBackground(elem.parentNode);}if(_26e==null){return new Rico.Color(255,255,255);}if(_26e.indexOf("rgb(")==0){var _26f=_26e.substring(4,_26e.length-1);var _270=_26f.split(",");return new Rico.Color(parseInt(_270[0]),parseInt(_270[1]),parseInt(_270[2]));}else{if(_26e.indexOf("#")==0){return Rico.Color.createFromHex(_26e);}else{return new Rico.Color(255,255,255);}}};Rico.Color.HSBtoRGB=function(hue,_272,_273){var red=0;var _275=0;var blue=0;if(_272==0){red=parseInt(_273*255+0.5);_275=red;blue=red;}else{var h=(hue-Math.floor(hue))*6;var f=h-Math.floor(h);var p=_273*(1-_272);var q=_273*(1-_272*f);var t=_273*(1-(_272*(1-f)));switch(parseInt(h)){case 0:red=(_273*255+0.5);_275=(t*255+0.5);blue=(p*255+0.5);break;case 1:red=(q*255+0.5);_275=(_273*255+0.5);blue=(p*255+0.5);break;case 2:red=(p*255+0.5);_275=(_273*255+0.5);blue=(t*255+0.5);break;case 3:red=(p*255+0.5);_275=(q*255+0.5);blue=(_273*255+0.5);break;case 4:red=(t*255+0.5);_275=(p*255+0.5);blue=(_273*255+0.5);break;case 5:red=(_273*255+0.5);_275=(p*255+0.5);blue=(q*255+0.5);break;}}return {r:parseInt(red),g:parseInt(_275),b:parseInt(blue)};};Rico.Color.RGBtoHSB=function(r,g,b){var hue;var _280;var _281;var cmax=(r>g)?r:g;if(b>cmax){cmax=b;}var cmin=(r<g)?r:g;if(b<cmin){cmin=b;}_281=cmax/255;if(cmax!=0){_280=(cmax-cmin)/cmax;}else{_280=0;}if(_280==0){hue=0;}else{var redc=(cmax-r)/(cmax-cmin);var _285=(cmax-g)/(cmax-cmin);var _286=(cmax-b)/(cmax-cmin);if(r==cmax){hue=_286-_285;}else{if(g==cmax){hue=2+redc-_286;}else{hue=4+_285-redc;}}hue=hue/6;if(hue<0){hue=hue+1;}}return {h:hue,s:_280,b:_281};};Rico.Corner={round:function(e,_288){var e=$(e);this._setOptions(_288);var _28a=this.options.color;if(this.options.color=="fromElement"){_28a=this._background(e);}var _28b=this.options.bgColor;if(this.options.bgColor=="fromParent"){_28b=this._background(e.offsetParent);}this._roundCornersImpl(e,_28a,_28b);},_roundCornersImpl:function(e,_28d,_28e){if(this.options.border){this._renderBorder(e,_28e);}if(this._isTopRounded()){this._roundTopCorners(e,_28d,_28e);}if(this._isBottomRounded()){this._roundBottomCorners(e,_28d,_28e);}},_renderBorder:function(el,_290){var _291="1px solid "+this._borderColor(_290);var _292="border-left: "+_291;var _293="border-right: "+_291;var _294="style='"+_292+";"+_293+"'";el.innerHTML="<div "+_294+">"+el.innerHTML+"</div>";},_roundTopCorners:function(el,_296,_297){var _298=this._createCorner(_297);for(var i=0;i<this.options.numSlices;i++){_298.appendChild(this._createCornerSlice(_296,_297,i,"top"));}el.style.paddingTop=0;el.insertBefore(_298,el.firstChild);},_roundBottomCorners:function(el,_29b,_29c){var _29d=this._createCorner(_29c);for(var i=(this.options.numSlices-1);i>=0;i--){_29d.appendChild(this._createCornerSlice(_29b,_29c,i,"bottom"));}el.style.paddingBottom=0;el.appendChild(_29d);},_createCorner:function(_29f){var _2a0=document.createElement("div");_2a0.style.backgroundColor=(this._isTransparent()?"transparent":_29f);return _2a0;},_createCornerSlice:function(_2a1,_2a2,n,_2a4){var _2a5=document.createElement("span");var _2a6=_2a5.style;_2a6.backgroundColor=_2a1;_2a6.display="block";_2a6.height="1px";_2a6.overflow="hidden";_2a6.fontSize="1px";var _2a7=this._borderColor(_2a1,_2a2);if(this.options.border&&n==0){_2a6.borderTopStyle="solid";_2a6.borderTopWidth="1px";_2a6.borderLeftWidth="0px";_2a6.borderRightWidth="0px";_2a6.borderBottomWidth="0px";_2a6.height="0px";_2a6.borderColor=_2a7;}else{if(_2a7){_2a6.borderColor=_2a7;_2a6.borderStyle="solid";_2a6.borderWidth="0px 1px";}}if(!this.options.compact&&(n==(this.options.numSlices-1))){_2a6.height="2px";}this._setMargin(_2a5,n,_2a4);this._setBorder(_2a5,n,_2a4);return _2a5;},_setOptions:function(_2a8){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:true,border:false,compact:false};Object.extend(this.options,_2a8||{});this.options.numSlices=this.options.compact?2:4;if(this._isTransparent()){this.options.blend=false;}},_whichSideTop:function(){if(this._hasString(this.options.corners,"all","top")){return "";}if(this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0){return "";}if(this.options.corners.indexOf("tl")>=0){return "left";}else{if(this.options.corners.indexOf("tr")>=0){return "right";}}return "";},_whichSideBottom:function(){if(this._hasString(this.options.corners,"all","bottom")){return "";}if(this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0){return "";}if(this.options.corners.indexOf("bl")>=0){return "left";}else{if(this.options.corners.indexOf("br")>=0){return "right";}}return "";},_borderColor:function(_2a9,_2aa){if(_2a9=="transparent"){return _2aa;}else{if(this.options.border){return this.options.border;}else{if(this.options.blend){return this._blend(_2aa,_2a9);}else{return "";}}}},_setMargin:function(el,n,_2ad){var _2ae=this._marginSize(n);var _2af=_2ad=="top"?this._whichSideTop():this._whichSideBottom();if(_2af=="left"){el.style.marginLeft=_2ae+"px";el.style.marginRight="0px";}else{if(_2af=="right"){el.style.marginRight=_2ae+"px";el.style.marginLeft="0px";}else{el.style.marginLeft=_2ae+"px";el.style.marginRight=_2ae+"px";}}},_setBorder:function(el,n,_2b2){var _2b3=this._borderSize(n);var _2b4=_2b2=="top"?this._whichSideTop():this._whichSideBottom();if(_2b4=="left"){el.style.borderLeftWidth=_2b3+"px";el.style.borderRightWidth="0px";}else{if(_2b4=="right"){el.style.borderRightWidth=_2b3+"px";el.style.borderLeftWidth="0px";}else{el.style.borderLeftWidth=_2b3+"px";el.style.borderRightWidth=_2b3+"px";}}if(this.options.border!=false){el.style.borderLeftWidth=_2b3+"px";}el.style.borderRightWidth=_2b3+"px";},_marginSize:function(n){if(this._isTransparent()){return 0;}var _2b6=[5,3,2,1];var _2b7=[3,2,1,0];var _2b8=[2,1];var _2b9=[1,0];if(this.options.compact&&this.options.blend){return _2b9[n];}else{if(this.options.compact){return _2b8[n];}else{if(this.options.blend){return _2b7[n];}else{return _2b6[n];}}}},_borderSize:function(n){var _2bb=[5,3,2,1];var _2bc=[2,1,1,1];var _2bd=[1,0];var _2be=[0,2,0,0];if(this.options.compact&&(this.options.blend||this._isTransparent())){return 1;}else{if(this.options.compact){return _2bd[n];}else{if(this.options.blend){return _2bc[n];}else{if(this.options.border){return _2be[n];}else{if(this._isTransparent()){return _2bb[n];}}}}}return 0;},_hasString:function(str){for(var i=1;i<arguments.length;i++){if(str.indexOf(arguments[i])>=0){return true;}}return false;},_blend:function(c1,c2){var cc1=Rico.Color.createFromHex(c1);cc1.blend(Rico.Color.createFromHex(c2));return cc1;},_background:function(el){try{return Rico.Color.createColorFromBackground(el).asHex();}catch(err){return "#ffffff";}},_isTransparent:function(){return this.options.color=="transparent";},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr");},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br");},_hasSingleTextChild:function(el){return el.childNodes.length==1&&el.childNodes[0].nodeType==3;}};Rico.DragAndDrop=Class.create();Rico.DragAndDrop.prototype={initialize:function(){this.dropZones=new Array();this.draggables=new Array();this.currentDragObjects=new Array();this.dragElement=null;this.lastSelectedDraggable=null;this.currentDragObjectVisible=false;this.interestedInMotionEvents=false;this._mouseDown=this._mouseDownHandler.bindAsEventListener(this);this._mouseMove=this._mouseMoveHandler.bindAsEventListener(this);this._mouseUp=this._mouseUpHandler.bindAsEventListener(this);},registerDropZone:function(_2c6){this.dropZones[this.dropZones.length]=_2c6;},deregisterDropZone:function(_2c7){var _2c8=new Array();var j=0;for(var i=0;i<this.dropZones.length;i++){if(this.dropZones[i]!=_2c7){_2c8[j++]=this.dropZones[i];}}this.dropZones=_2c8;},clearDropZones:function(){this.dropZones=new Array();},registerDraggable:function(_2cb){this.draggables[this.draggables.length]=_2cb;this._addMouseDownHandler(_2cb);},clearSelection:function(){for(var i=0;i<this.currentDragObjects.length;i++){this.currentDragObjects[i].deselect();}this.currentDragObjects=new Array();this.lastSelectedDraggable=null;},hasSelection:function(){return this.currentDragObjects.length>0;},setStartDragFromElement:function(e,_2ce){this.origPos=RicoUtil.toDocumentPosition(_2ce);this.startx=e.screenX-this.origPos.x;this.starty=e.screenY-this.origPos.y;this.interestedInMotionEvents=this.hasSelection();this._terminateEvent(e);},updateSelection:function(_2cf,_2d0){if(!_2d0){this.clearSelection();}if(_2cf.isSelected()){this.currentDragObjects.removeItem(_2cf);_2cf.deselect();if(_2cf==this.lastSelectedDraggable){this.lastSelectedDraggable=null;}}else{this.currentDragObjects[this.currentDragObjects.length]=_2cf;_2cf.select();this.lastSelectedDraggable=_2cf;}},_mouseDownHandler:function(e){if(arguments.length==0){e=event;}var _2d2=e.which!=undefined;if((_2d2&&e.which!=1)||(!_2d2&&e.button!=1)){return;}var _2d3=e.target?e.target:e.srcElement;var _2d4=_2d3.draggable;var _2d5=_2d3;while(_2d4==null&&_2d5.parentNode){_2d5=_2d5.parentNode;_2d4=_2d5.draggable;}if(_2d4==null){return;}this.updateSelection(_2d4,e.ctrlKey);if(this.hasSelection()){for(var i=0;i<this.dropZones.length;i++){this.dropZones[i].clearPositionCache();}}this.setStartDragFromElement(e,_2d4.getMouseDownHTMLElement());},_mouseMoveHandler:function(e){var _2d8=e.which!=undefined;if(!this.interestedInMotionEvents){return;}if(!this.hasSelection()){return;}if(!this.currentDragObjectVisible){this._startDrag(e);}if(!this.activatedDropZones){this._activateRegisteredDropZones();}this._updateDraggableLocation(e);this._updateDropZonesHover(e);this._terminateEvent(e);},_makeDraggableObjectVisible:function(e){if(!this.hasSelection()){return;}var _2da;if(this.currentDragObjects.length>1){_2da=this.currentDragObjects[0].getMultiObjectDragGUI(this.currentDragObjects);}else{_2da=this.currentDragObjects[0].getSingleObjectDragGUI();}if(RicoUtil.getElementsComputedStyle(_2da,"position")!="absolute"){_2da.style.position="absolute";}if(_2da.parentNode==null||_2da.parentNode.nodeType==11){document.body.appendChild(_2da);}this.dragElement=_2da;this._updateDraggableLocation(e);this.currentDragObjectVisible=true;},_leftOffset:function(e){return e.offsetX?document.body.scrollLeft:0;},_topOffset:function(e){return e.offsetY?document.body.scrollTop:0;},_updateDraggableLocation:function(e){var _2de=this.dragElement.style;if(navigator.userAgent.toLowerCase().indexOf("safari")>=0){_2de.left=(e.screenX-this.startx)+"px";_2de.top=(e.screenY-this.starty)+"px";}else{_2de.left=(e.screenX+this._leftOffset(e)-this.startx)+"px";_2de.top=(e.screenY+this._topOffset(e)-this.starty)+"px";}},_updateDropZonesHover:function(e){var n=this.dropZones.length;for(var i=0;i<n;i++){if(this.dropZones[i].canAccept(this.currentDragObjects)){if(this._mousePointInDropZone(e,this.dropZones[i])){this.dropZones[i].showHover(this.currentDragObjects,e);}else{this.dropZones[i].hideHover(this.currentDragObjects);}}}},_startDrag:function(e){for(var i=0;i<this.currentDragObjects.length;i++){this.currentDragObjects[i].startDrag();}this._makeDraggableObjectVisible(e);},_mouseUpHandler:function(e){if(!this.hasSelection()){return;}var _2e5=e.which!=undefined;if((_2e5&&e.which!=1)||(!_2e5&&e.button!=1)){return;}this.interestedInMotionEvents=false;if(this.dragElement==null){this._terminateEvent(e);return;}if(this._placeDraggableInDropZone(e)){this._completeDropOperation(e);}else{this._terminateEvent(e);new Rico.Effect.Position(this.dragElement,this.origPos.x,this.origPos.y,200,20,{complete:this._doCancelDragProcessing.bind(this)});}Event.stopObserving(document.body,"mousemove",this._mouseMove);Event.stopObserving(document.body,"mouseup",this._mouseUp);},_retTrue:function(){return true;},_completeDropOperation:function(e){if(this.dragElement!=this.currentDragObjects[0].getMouseDownHTMLElement()){if(this.dragElement.parentNode!=null){this.dragElement.parentNode.removeChild(this.dragElement);}}this._deactivateRegisteredDropZones();this._endDrag();this.clearSelection();this.dragElement=null;this.currentDragObjectVisible=false;this._terminateEvent(e);},_doCancelDragProcessing:function(){this._cancelDrag();if(this.dragElement!=this.currentDragObjects[0].getMouseDownHTMLElement()&&this.dragElement){if(this.dragElement.parentNode!=null){this.dragElement.parentNode.removeChild(this.dragElement);}}this._deactivateRegisteredDropZones();this.dragElement=null;this.currentDragObjectVisible=false;},_placeDraggableInDropZone:function(e){var _2e8=false;var n=this.dropZones.length;for(var i=0;i<n;i++){if(this.dropZones[i].canAccept(this.currentDragObjects)){if(this._mousePointInDropZone(e,this.dropZones[i])){this.dropZones[i].hideHover(this.currentDragObjects);this.dropZones[i].accept(this.currentDragObjects);_2e8=true;break;}}}return _2e8;},_cancelDrag:function(){for(var i=0;i<this.currentDragObjects.length;i++){this.currentDragObjects[i].cancelDrag();}},_endDrag:function(){for(var i=0;i<this.currentDragObjects.length;i++){this.currentDragObjects[i].endDrag();}},_mousePointInDropZone:function(e,_2ee){var _2ef=_2ee.getAbsoluteRect();return e.clientY>_2ef.top+this._topOffset(e)&&e.clientY<_2ef.bottom+this._topOffset(e)&&e.clientX>_2ef.left+this._leftOffset(e)&&e.clientX<_2ef.right+this._leftOffset(e);},_addMouseDownHandler:function(_2f0){htmlElement=_2f0.getMouseDownHTMLElement();if(htmlElement!=null){htmlElement.draggable=_2f0;Event.observe(htmlElement,"mousedown",this._onmousedown.bindAsEventListener(this));Event.observe(htmlElement,"mousedown",this._mouseDown);}},_activateRegisteredDropZones:function(){var n=this.dropZones.length;for(var i=0;i<n;i++){var _2f3=this.dropZones[i];if(_2f3.canAccept(this.currentDragObjects)){_2f3.activate(this.currentDragObjects);}}this.activatedDropZones=true;},_deactivateRegisteredDropZones:function(){var n=this.dropZones.length;for(var i=0;i<n;i++){this.dropZones[i].deactivate();}this.activatedDropZones=false;},_onmousedown:function(){Event.observe(document.body,"mousemove",this._mouseMove);Event.observe(document.body,"mouseup",this._mouseUp);},_terminateEvent:function(e){if(e.stopPropagation!=undefined){e.stopPropagation();}else{if(e.cancelBubble!=undefined){e.cancelBubble=true;}}if(e.preventDefault!=undefined){e.preventDefault();}else{e.returnValue=false;}},initializeEventHandlers:function(){if(typeof document.implementation!="undefined"&&document.implementation.hasFeature("HTML","1.0")&&document.implementation.hasFeature("Events","2.0")&&document.implementation.hasFeature("CSS","2.0")){document.addEventListener("mouseup",this._mouseUpHandler.bindAsEventListener(this),false);document.addEventListener("mousemove",this._mouseMoveHandler.bindAsEventListener(this),false);}else{document.attachEvent("onmouseup",this._mouseUpHandler.bindAsEventListener(this));document.attachEvent("onmousemove",this._mouseMoveHandler.bindAsEventListener(this));}}};var dndMgr=new Rico.DragAndDrop();dndMgr.initializeEventHandlers();Rico.Draggable=Class.create();Rico.Draggable.prototype={initialize:function(type,_2f8){this.type=type;this.htmlElement=$(_2f8);this.selected=false;},getMouseDownHTMLElement:function(){return this.htmlElement;},select:function(){this.selected=true;if(this.showingSelected){return;}var _2f9=this.getMouseDownHTMLElement();var _2fa=Rico.Color.createColorFromBackground(_2f9);_2fa.isBright()?_2fa.darken(0.033):_2fa.brighten(0.033);this.saveBackground=RicoUtil.getElementsComputedStyle(_2f9,"backgroundColor","background-color");_2f9.style.backgroundColor=_2fa.asHex();this.showingSelected=true;},deselect:function(){this.selected=false;if(!this.showingSelected){return;}var _2fb=this.getMouseDownHTMLElement();_2fb.style.backgroundColor=this.saveBackground;this.showingSelected=false;},isSelected:function(){return this.selected;},startDrag:function(){},cancelDrag:function(){},endDrag:function(){},getSingleObjectDragGUI:function(){return this.htmlElement;},getMultiObjectDragGUI:function(_2fc){return this.htmlElement;},getDroppedGUI:function(){return this.htmlElement;},toString:function(){return this.type+":"+this.htmlElement+":";}};Rico.Dropzone=Class.create();Rico.Dropzone.prototype={initialize:function(_2fd){this.htmlElement=$(_2fd);this.absoluteRect=null;},getHTMLElement:function(){return this.htmlElement;},clearPositionCache:function(){this.absoluteRect=null;},getAbsoluteRect:function(){if(this.absoluteRect==null){var _2fe=this.getHTMLElement();var pos=RicoUtil.toViewportPosition(_2fe);this.absoluteRect={top:pos.y,left:pos.x,bottom:pos.y+_2fe.offsetHeight,right:pos.x+_2fe.offsetWidth};}return this.absoluteRect;},activate:function(){var _300=this.getHTMLElement();if(_300==null||this.showingActive){return;}this.showingActive=true;this.saveBackgroundColor=_300.style.backgroundColor;var _301="#ffea84";var _302=Rico.Color.createColorFromBackground(_300);if(_302==null){_300.style.backgroundColor=_301;}else{_302.isBright()?_302.darken(0.2):_302.brighten(0.2);_300.style.backgroundColor=_302.asHex();}},deactivate:function(){var _303=this.getHTMLElement();if(_303==null||!this.showingActive){return;}_303.style.backgroundColor=this.saveBackgroundColor;this.showingActive=false;this.saveBackgroundColor=null;},showHover:function(){var _304=this.getHTMLElement();if(_304==null||this.showingHover){return;}this.saveBorderWidth=_304.style.borderWidth;this.saveBorderStyle=_304.style.borderStyle;this.saveBorderColor=_304.style.borderColor;this.showingHover=true;_304.style.borderWidth="1px";_304.style.borderStyle="solid";_304.style.borderColor="#ffff00";},hideHover:function(){var _305=this.getHTMLElement();if(_305==null||!this.showingHover){return;}_305.style.borderWidth=this.saveBorderWidth;_305.style.borderStyle=this.saveBorderStyle;_305.style.borderColor=this.saveBorderColor;this.showingHover=false;},canAccept:function(_306){return true;},accept:function(_307){var _308=this.getHTMLElement();if(_308==null){return;}n=_307.length;for(var i=0;i<n;i++){var _30a=_307[i].getDroppedGUI();if(RicoUtil.getElementsComputedStyle(_30a,"position")=="absolute"){_30a.style.position="static";_30a.style.top="";_30a.style.top="";}_308.appendChild(_30a);}}};Rico.Effect={};Rico.Effect.SizeAndPosition=Class.create();Rico.Effect.SizeAndPosition.prototype={initialize:function(_30b,x,y,w,h,_310,_311,_312){this.element=$(_30b);this.x=x;this.y=y;this.w=w;this.h=h;this.duration=_310;this.steps=_311;this.options=arguments[7]||{};this.sizeAndPosition();},sizeAndPosition:function(){if(this.isFinished()){if(this.options.complete){this.options.complete(this);}return;}if(this.timer){clearTimeout(this.timer);}var _313=Math.round(this.duration/this.steps);var _314=this.element.offsetLeft;var _315=this.element.offsetTop;var _316=this.element.offsetWidth;var _317=this.element.offsetHeight;this.x=(this.x)?this.x:_314;this.y=(this.y)?this.y:_315;this.w=(this.w)?this.w:_316;this.h=(this.h)?this.h:_317;var difX=this.steps>0?(this.x-_314)/this.steps:0;var difY=this.steps>0?(this.y-_315)/this.steps:0;var difW=this.steps>0?(this.w-_316)/this.steps:0;var difH=this.steps>0?(this.h-_317)/this.steps:0;this.moveBy(difX,difY);this.resizeBy(difW,difH);this.duration-=_313;this.steps--;this.timer=setTimeout(this.sizeAndPosition.bind(this),_313);},isFinished:function(){return this.steps<=0;},moveBy:function(difX,difY){var _31e=this.element.offsetLeft;var _31f=this.element.offsetTop;var _320=parseInt(difX);var _321=parseInt(difY);var _322=this.element.style;if(_320!=0){_322.left=(_31e+_320)+"px";}if(_321!=0){_322.top=(_31f+_321)+"px";}},resizeBy:function(difW,difH){var _325=this.element.offsetWidth;var _326=this.element.offsetHeight;var _327=parseInt(difW);var _328=parseInt(difH);var _329=this.element.style;if(_327!=0){_329.width=(_325+_327)+"px";}if(_328!=0){_329.height=(_326+_328)+"px";}}};Rico.Effect.Size=Class.create();Rico.Effect.Size.prototype={initialize:function(_32a,w,h,_32d,_32e,_32f){new Rico.Effect.SizeAndPosition(_32a,null,null,w,h,_32d,_32e,_32f);}};Rico.Effect.Position=Class.create();Rico.Effect.Position.prototype={initialize:function(_330,x,y,_333,_334,_335){new Rico.Effect.SizeAndPosition(_330,x,y,null,null,_333,_334,_335);}};Rico.Effect.Round=Class.create();Rico.Effect.Round.prototype={initialize:function(_336,_337,_338){var _339=document.getElementsByTagAndClassName(_336,_337);for(var i=0;i<_339.length;i++){Rico.Corner.round(_339[i],_338);}}};Rico.Effect.FadeTo=Class.create();Rico.Effect.FadeTo.prototype={initialize:function(_33b,_33c,_33d,_33e,_33f){this.element=$(_33b);this.opacity=_33c;this.duration=_33d;this.steps=_33e;this.options=arguments[4]||{};this.fadeTo();},fadeTo:function(){if(this.isFinished()){if(this.options.complete){this.options.complete(this);}return;}if(this.timer){clearTimeout(this.timer);}var _340=Math.round(this.duration/this.steps);var _341=this.getElementOpacity();var _342=this.steps>0?(this.opacity-_341)/this.steps:0;this.changeOpacityBy(_342);this.duration-=_340;this.steps--;this.timer=setTimeout(this.fadeTo.bind(this),_340);},changeOpacityBy:function(v){var _344=this.getElementOpacity();var _345=Math.max(0,Math.min(_344+v,1));this.element.ricoOpacity=_345;this.element.style.filter="alpha(opacity:"+Math.round(_345*100)+")";this.element.style.opacity=_345;},isFinished:function(){return this.steps<=0;},getElementOpacity:function(){if(this.element.ricoOpacity==undefined){var _346=RicoUtil.getElementsComputedStyle(this.element,"opacity");this.element.ricoOpacity=_346!=undefined?_346:1;}return parseFloat(this.element.ricoOpacity);}};Rico.Effect.AccordionSize=Class.create();Rico.Effect.AccordionSize.prototype={initialize:function(e1,e2,_349,end,_34b,_34c,_34d){this.e1=$(e1);this.e2=$(e2);this.start=_349;this.end=end;this.duration=_34b;this.steps=_34c;this.options=arguments[6]||{};this.accordionSize();},accordionSize:function(){if(this.isFinished()){this.e1.style.height=this.start+"px";this.e2.style.height=this.end+"px";if(this.options.complete){this.options.complete(this);}return;}if(this.timer){clearTimeout(this.timer);}var _34e=Math.round(this.duration/this.steps);var diff=this.steps>0?(parseInt(this.e1.offsetHeight)-this.start)/this.steps:0;this.resizeBy(diff);this.duration-=_34e;this.steps--;this.timer=setTimeout(this.accordionSize.bind(this),_34e);},isFinished:function(){return this.steps<=0;},resizeBy:function(diff){var _351=this.e1.offsetHeight;var _352=this.e2.offsetHeight;var _353=parseInt(diff);if(diff!=0){this.e1.style.height=(_351-_353)+"px";this.e2.style.height=(_352+_353)+"px";}}};Rico.LiveGridMetaData=Class.create();Rico.LiveGridMetaData.prototype={initialize:function(_354,_355,_356,_357){this.pageSize=_354;this.totalRows=_355;this.setOptions(_357);this.ArrowHeight=16;this.columnCount=_356;},setOptions:function(_358){this.options={largeBufferSize:7,nearLimitFactor:0.2};Object.extend(this.options,_358||{});},getPageSize:function(){return this.pageSize;},getTotalRows:function(){return this.totalRows;},setTotalRows:function(n){this.totalRows=n;},getLargeBufferSize:function(){return parseInt(this.options.largeBufferSize*this.pageSize);},getLimitTolerance:function(){return parseInt(this.getLargeBufferSize()*this.options.nearLimitFactor);}};Rico.LiveGridScroller=Class.create();Rico.LiveGridScroller.prototype={initialize:function(_35a,_35b){this.isIE=navigator.userAgent.toLowerCase().indexOf("msie")>=0;this.liveGrid=_35a;this.metaData=_35a.metaData;this.createScrollBar();this.scrollTimeout=null;this.lastScrollPos=0;this.viewPort=_35b;this.rows=new Array();},isUnPlugged:function(){return this.scrollerDiv.onscroll==null;},plugin:function(){this.scrollerDiv.onscroll=this.handleScroll.bindAsEventListener(this);},unplug:function(){this.scrollerDiv.onscroll=null;},sizeIEHeaderHack:function(){if(!this.isIE){return;}var _35c=$(this.liveGrid.tableId+"_header");if(_35c){_35c.rows[0].cells[0].style.width=(_35c.rows[0].cells[0].offsetWidth+1)+"px";}},createScrollBar:function(){var _35d=this.liveGrid.viewPort.visibleHeight();this.scrollerDiv=document.createElement("div");var _35e=this.scrollerDiv.style;_35e.borderRight=this.liveGrid.options.scrollerBorderRight;_35e.position="relative";_35e.left=this.isIE?"-6px":"-3px";_35e.width="19px";_35e.height=_35d+"px";_35e.overflow="auto";this.heightDiv=document.createElement("div");this.heightDiv.style.width="1px";this.heightDiv.style.height=parseInt(_35d*this.metaData.getTotalRows()/this.metaData.getPageSize())+"px";this.scrollerDiv.appendChild(this.heightDiv);this.scrollerDiv.onscroll=this.handleScroll.bindAsEventListener(this);var _35f=this.liveGrid.table;_35f.parentNode.parentNode.insertBefore(this.scrollerDiv,_35f.parentNode.nextSibling);var _360=this.isIE?"mousewheel":"DOMMouseScroll";Event.observe(_35f,_360,function(evt){if(evt.wheelDelta>=0||evt.detail<0){this.scrollerDiv.scrollTop-=(2*this.viewPort.rowHeight);}else{this.scrollerDiv.scrollTop+=(2*this.viewPort.rowHeight);}this.handleScroll(false);}.bindAsEventListener(this),false);},updateSize:function(){var _362=this.liveGrid.table;var _363=this.viewPort.visibleHeight();this.heightDiv.style.height=parseInt(_363*this.metaData.getTotalRows()/this.metaData.getPageSize())+"px";},rowToPixel:function(_364){return (_364/this.metaData.getTotalRows())*this.heightDiv.offsetHeight;},moveScroll:function(_365){this.scrollerDiv.scrollTop=this.rowToPixel(_365);if(this.metaData.options.onscroll){this.metaData.options.onscroll(this.liveGrid,_365);}},handleScroll:function(){if(this.scrollTimeout){clearTimeout(this.scrollTimeout);}var _366=this.lastScrollPos-this.scrollerDiv.scrollTop;if(_366!=0){var r=this.scrollerDiv.scrollTop%this.viewPort.rowHeight;if(r!=0){this.unplug();if(_366<0){this.scrollerDiv.scrollTop+=(this.viewPort.rowHeight-r);}else{this.scrollerDiv.scrollTop-=r;}this.plugin();}}var _368=parseInt(this.scrollerDiv.scrollTop/this.viewPort.rowHeight);this.liveGrid.requestContentRefresh(_368);this.viewPort.scrollTo(this.scrollerDiv.scrollTop);if(this.metaData.options.onscroll){this.metaData.options.onscroll(this.liveGrid,_368);}this.scrollTimeout=setTimeout(this.scrollIdle.bind(this),1200);this.lastScrollPos=this.scrollerDiv.scrollTop;},scrollIdle:function(){if(this.metaData.options.onscrollidle){this.metaData.options.onscrollidle();}}};Rico.LiveGridBuffer=Class.create();Rico.LiveGridBuffer.prototype={initialize:function(_369,_36a){this.startPos=0;this.size=0;this.metaData=_369;this.rows=new Array();this.updateInProgress=false;this.viewPort=_36a;this.maxBufferSize=_369.getLargeBufferSize()*2;this.maxFetchSize=_369.getLargeBufferSize();this.lastOffset=0;},getBlankRow:function(){if(!this.blankRow){this.blankRow=new Array();for(var i=0;i<this.metaData.columnCount;i++){this.blankRow[i]="&nbsp;";}}return this.blankRow;},loadRows:function(_36c){var _36d=_36c.getElementsByTagName("rows")[0];this.updateUI=_36d.getAttribute("update_ui")=="true";var _36e=new Array();var trs=_36d.getElementsByTagName("tr");for(var i=0;i<trs.length;i++){var row=_36e[i]=new Array();var _372=trs[i].getElementsByTagName("td");for(var j=0;j<_372.length;j++){var cell=_372[j];var _375=cell.getAttribute("convert_spaces")=="true";var _376=RicoUtil.getContentAsString(cell);row[j]=_375?this.convertSpaces(_376):_376;if(!row[j]){row[j]="&nbsp;";}}}return _36e;},update:function(_377,_378){var _379=this.loadRows(_377);if(this.rows.length==0){this.rows=_379;this.size=this.rows.length;this.startPos=_378;return;}if(_378>this.startPos){if(this.startPos+this.rows.length<_378){this.rows=_379;this.startPos=_378;}else{this.rows=this.rows.concat(_379.slice(0,_379.length));if(this.rows.length>this.maxBufferSize){var _37a=this.rows.length;this.rows=this.rows.slice(this.rows.length-this.maxBufferSize,this.rows.length);this.startPos=this.startPos+(_37a-this.rows.length);}}}else{if(_378+_379.length<this.startPos){this.rows=_379;}else{this.rows=_379.slice(0,this.startPos).concat(this.rows);if(this.rows.length>this.maxBufferSize){this.rows=this.rows.slice(0,this.maxBufferSize);}}this.startPos=_378;}this.size=this.rows.length;},clear:function(){this.rows=new Array();this.startPos=0;this.size=0;},isOverlapping:function(_37b,size){return ((_37b<this.endPos())&&(this.startPos<_37b+size))||(this.endPos()==0);},isInRange:function(_37d){return (_37d>=this.startPos)&&(_37d+this.metaData.getPageSize()<=this.endPos());},isNearingTopLimit:function(_37e){return _37e-this.startPos<this.metaData.getLimitTolerance();},endPos:function(){return this.startPos+this.rows.length;},isNearingBottomLimit:function(_37f){return this.endPos()-(_37f+this.metaData.getPageSize())<this.metaData.getLimitTolerance();},isAtTop:function(){return this.startPos==0;},isAtBottom:function(){return this.endPos()==this.metaData.getTotalRows();},isNearingLimit:function(_380){return (!this.isAtTop()&&this.isNearingTopLimit(_380))||(!this.isAtBottom()&&this.isNearingBottomLimit(_380));},getFetchSize:function(_381){var _382=this.getFetchOffset(_381);var _383=0;if(_382>=this.startPos){var _384=this.maxFetchSize+_382;if(_384>this.metaData.totalRows){_384=this.metaData.totalRows;}_383=_384-_382;if(_382==0&&_383<this.maxFetchSize){_383=this.maxFetchSize;}}else{var _385=this.startPos-_382;if(_385>this.maxFetchSize){_385=this.maxFetchSize;}}return _385;},getFetchOffset:function(_386){var _387=_386;if(_386>this.startPos){_387=(_386>this.endPos())?_386:this.endPos();}else{if(_386+this.maxFetchSize>=this.startPos){var _388=this.startPos-this.maxFetchSize;if(_388<0){_388=0;}}}this.lastOffset=_388;return _388;},getRows:function(_389,_38a){var _38b=_389-this.startPos;var _38c=_38b+_38a;if(_38c>this.size){_38c=this.size;}var _38d=new Array();var _38e=0;for(var i=_38b;i<_38c;i++){_38d[_38e++]=this.rows[i];}return _38d;},convertSpaces:function(s){return s.split(" ").join("&nbsp;");}};Rico.GridViewPort=Class.create();Rico.GridViewPort.prototype={initialize:function(_391,_392,_393,_394,_395){this.lastDisplayedStartPos=0;this.div=_391.parentNode;this.table=_391;this.rowHeight=_392;this.div.style.height=(this.rowHeight*_393)+"px";this.div.style.overflow="hidden";this.buffer=_394;this.liveGrid=_395;this.visibleRows=_393+1;this.lastPixelOffset=0;this.startPos=0;},populateRow:function(_396,row){for(var j=0;j<row.length;j++){_396.cells[j].innerHTML=row[j];}},bufferChanged:function(){this.refreshContents(parseInt(this.lastPixelOffset/this.rowHeight));},clearRows:function(){if(!this.isBlank){this.liveGrid.table.className=this.liveGrid.options.loadingClass;for(var i=0;i<this.visibleRows;i++){this.populateRow(this.table.rows[i],this.buffer.getBlankRow());}this.isBlank=true;}},clearContents:function(){this.clearRows();this.scrollTo(0);this.startPos=0;this.lastStartPos=-1;},refreshContents:function(_39a){if(_39a==this.lastRowPos&&!this.isPartialBlank&&!this.isBlank){return;}if((_39a+this.visibleRows<this.buffer.startPos)||(this.buffer.startPos+this.buffer.size<_39a)||(this.buffer.size==0)){this.clearRows();return;}this.isBlank=false;var _39b=this.buffer.startPos>_39a;var _39c=_39b?this.buffer.startPos:_39a;var _39d=(this.buffer.startPos+this.buffer.size<_39a+this.visibleRows)?this.buffer.startPos+this.buffer.size:_39a+this.visibleRows;var _39e=_39d-_39c;var rows=this.buffer.getRows(_39c,_39e);var _3a0=this.visibleRows-_39e;var _3a1=_39b?0:_39e;var _3a2=_39b?_3a0:0;for(var i=0;i<rows.length;i++){this.populateRow(this.table.rows[i+_3a2],rows[i]);}for(var i=0;i<_3a0;i++){this.populateRow(this.table.rows[i+_3a1],this.buffer.getBlankRow());}this.isPartialBlank=_3a0>0;this.lastRowPos=_39a;this.liveGrid.table.className=this.liveGrid.options.tableClass;var _3a5=this.liveGrid.options.onRefreshComplete;if(_3a5!=null){_3a5();}},scrollTo:function(_3a6){if(this.lastPixelOffset==_3a6){return;}this.refreshContents(parseInt(_3a6/this.rowHeight));this.div.scrollTop=_3a6%this.rowHeight;this.lastPixelOffset=_3a6;},visibleHeight:function(){return parseInt(RicoUtil.getElementsComputedStyle(this.div,"height"));}};Rico.LiveGridRequest=Class.create();Rico.LiveGridRequest.prototype={initialize:function(_3a7,_3a8){this.requestOffset=_3a7;}};Rico.LiveGrid=Class.create();Rico.LiveGrid.prototype={initialize:function(_3a9,_3aa,_3ab,url,_3ad,_3ae){this.options={tableClass:$(_3a9).className,loadingClass:$(_3a9).className,scrollerBorderRight:"1px solid #ababab",bufferTimeout:20000,sortAscendImg:"images/sort_asc.gif",sortDescendImg:"images/sort_desc.gif",sortImageWidth:9,sortImageHeight:5,ajaxSortURLParms:[],onRefreshComplete:null,requestParameters:null,inlineStyles:true};Object.extend(this.options,_3ad||{});this.ajaxOptions={parameters:null};Object.extend(this.ajaxOptions,_3ae||{});this.tableId=_3a9;this.table=$(_3a9);this.addLiveGridHtml();var _3af=this.table.rows[0].cells.length;this.metaData=new Rico.LiveGridMetaData(_3aa,_3ab,_3af,_3ad);this.buffer=new Rico.LiveGridBuffer(this.metaData);var _3b0=this.table.rows.length;this.viewPort=new Rico.GridViewPort(this.table,this.table.offsetHeight/_3b0,_3aa,this.buffer,this);this.scroller=new Rico.LiveGridScroller(this,this.viewPort);this.options.sortHandler=this.sortHandler.bind(this);if($(_3a9+"_header")){this.sort=new Rico.LiveGridSort(_3a9+"_header",this.options);}this.processingRequest=null;this.unprocessedRequest=null;this.initAjax(url);if(this.options.prefetchBuffer||this.options.prefetchOffset>0){var _3b1=0;if(this.options.offset){_3b1=this.options.offset;this.scroller.moveScroll(_3b1);this.viewPort.scrollTo(this.scroller.rowToPixel(_3b1));}if(this.options.sortCol){this.sortCol=_3ad.sortCol;this.sortDir=_3ad.sortDir;}this.requestContentRefresh(_3b1);}},addLiveGridHtml:function(){if(this.table.getElementsByTagName("thead").length>0){var _3b2=this.table.cloneNode(true);_3b2.setAttribute("id",this.tableId+"_header");_3b2.setAttribute("class",this.table.className+"_header");for(var i=0;i<_3b2.tBodies.length;i++){_3b2.removeChild(_3b2.tBodies[i]);}this.table.deleteTHead();this.table.parentNode.insertBefore(_3b2,this.table);}new Insertion.Before(this.table,"<div id='"+this.tableId+"_container'></div>");this.table.previousSibling.appendChild(this.table);new Insertion.Before(this.table,"<div id='"+this.tableId+"_viewport' style='float:left;'></div>");this.table.previousSibling.appendChild(this.table);},resetContents:function(){this.scroller.moveScroll(0);this.buffer.clear();this.viewPort.clearContents();},sortHandler:function(_3b4){if(!_3b4){return;}this.sortCol=_3b4.name;this.sortDir=_3b4.currentSort;this.resetContents();this.requestContentRefresh(0);},adjustRowSize:function(){},setTotalRows:function(_3b5){this.resetContents();this.metaData.setTotalRows(_3b5);this.scroller.updateSize();},initAjax:function(url){ajaxEngine.registerRequest(this.tableId+"_request",url);ajaxEngine.registerAjaxObject(this.tableId+"_updater",this);},invokeAjax:function(){},handleTimedOut:function(){this.processingRequest=null;this.processQueuedRequest();},fetchBuffer:function(_3b7){if(this.buffer.isInRange(_3b7)&&!this.buffer.isNearingLimit(_3b7)){return;}if(this.processingRequest){this.unprocessedRequest=new Rico.LiveGridRequest(_3b7);return;}var _3b8=this.buffer.getFetchOffset(_3b7);this.processingRequest=new Rico.LiveGridRequest(_3b7);this.processingRequest.bufferOffset=_3b8;var _3b9=this.buffer.getFetchSize(_3b7);var _3ba=false;var _3bb;if(this.options.requestParameters){_3bb=this._createQueryString(this.options.requestParameters,0);}_3bb=(_3bb==null)?"":_3bb+"&";_3bb=_3bb+"id="+this.tableId+"&page_size="+_3b9+"&offset="+_3b8;if(this.sortCol){_3bb=_3bb+"&sort_col="+escape(this.sortCol)+"&sort_dir="+this.sortDir;}this.ajaxOptions.parameters=_3bb;ajaxEngine.sendRequest(this.tableId+"_request",this.ajaxOptions);this.timeoutHandler=setTimeout(this.handleTimedOut.bind(this),this.options.bufferTimeout);},setRequestParams:function(){this.options.requestParameters=[];for(var i=0;i<arguments.length;i++){this.options.requestParameters[i]=arguments[i];}},requestContentRefresh:function(_3bd){this.fetchBuffer(_3bd);},ajaxUpdate:function(_3be){try{clearTimeout(this.timeoutHandler);this.buffer.update(_3be,this.processingRequest.bufferOffset);this.viewPort.bufferChanged();}catch(err){}finally{this.processingRequest=null;}this.processQueuedRequest();},_createQueryString:function(_3bf,_3c0){var _3c1="";if(!_3bf){return _3c1;}for(var i=_3c0;i<_3bf.length;i++){if(i!=_3c0){_3c1+="&";}var _3c3=_3bf[i];if(_3c3.name!=undefined&&_3c3.value!=undefined){_3c1+=_3c3.name+"="+escape(_3c3.value);}else{var ePos=_3c3.indexOf("=");var _3c5=_3c3.substring(0,ePos);var _3c6=_3c3.substring(ePos+1);_3c1+=_3c5+"="+escape(_3c6);}}return _3c1;},processQueuedRequest:function(){if(this.unprocessedRequest!=null){this.requestContentRefresh(this.unprocessedRequest.requestOffset);this.unprocessedRequest=null;}}};Rico.LiveGridSort=Class.create();Rico.LiveGridSort.prototype={initialize:function(_3c7,_3c8){this.headerTableId=_3c7;this.headerTable=$(_3c7);this.options=_3c8;this.setOptions();this.applySortBehavior();if(this.options.sortCol){this.setSortUI(this.options.sortCol,this.options.sortDir);}},setSortUI:function(_3c9,_3ca){var cols=this.options.columns;for(var i=0;i<cols.length;i++){if(cols[i].name==_3c9){this.setColumnSort(i,_3ca);break;}}},setOptions:function(){new Image().src=this.options.sortAscendImg;new Image().src=this.options.sortDescendImg;this.sort=this.options.sortHandler;if(!this.options.columns){this.options.columns=this.introspectForColumnInfo();}else{this.options.columns=this.convertToTableColumns(this.options.columns);}},applySortBehavior:function(){var _3cd=this.headerTable.rows[0];var _3ce=_3cd.cells;for(var i=0;i<_3ce.length;i++){this.addSortBehaviorToColumn(i,_3ce[i]);}},addSortBehaviorToColumn:function(n,cell){if(this.options.columns[n].isSortable()){cell.id=this.headerTableId+"_"+n;cell.style.cursor="pointer";cell.onclick=this.headerCellClicked.bindAsEventListener(this);cell.innerHTML=cell.innerHTML+"<span id=\""+this.headerTableId+"_img_"+n+"\">"+"&nbsp;&nbsp;&nbsp;</span>";}},headerCellClicked:function(evt){var _3d3=evt.target?evt.target:evt.srcElement;var _3d4=_3d3.id;var _3d5=parseInt(_3d4.substring(_3d4.lastIndexOf("_")+1));var _3d6=this.getSortedColumnIndex();if(_3d6!=-1){if(_3d6!=_3d5){this.removeColumnSort(_3d6);this.setColumnSort(_3d5,Rico.TableColumn.SORT_ASC);}else{this.toggleColumnSort(_3d6);}}else{this.setColumnSort(_3d5,Rico.TableColumn.SORT_ASC);}if(this.options.sortHandler){this.options.sortHandler(this.options.columns[_3d5]);}},removeColumnSort:function(n){this.options.columns[n].setUnsorted();this.setSortImage(n);},setColumnSort:function(n,_3d9){if(isNaN(n)){return;}this.options.columns[n].setSorted(_3d9);this.setSortImage(n);},toggleColumnSort:function(n){this.options.columns[n].toggleSort();this.setSortImage(n);},setSortImage:function(n){var _3dc=this.options.columns[n].getSortDirection();var _3dd=$(this.headerTableId+"_img_"+n);if(_3dc==Rico.TableColumn.UNSORTED){_3dd.innerHTML="&nbsp;&nbsp;";}else{if(_3dc==Rico.TableColumn.SORT_ASC){_3dd.innerHTML="&nbsp;&nbsp;<img width=\""+this.options.sortImageWidth+"\" "+"height=\""+this.options.sortImageHeight+"\" "+"src=\""+this.options.sortAscendImg+"\"/>";}else{if(_3dc==Rico.TableColumn.SORT_DESC){_3dd.innerHTML="&nbsp;&nbsp;<img width=\""+this.options.sortImageWidth+"\" "+"height=\""+this.options.sortImageHeight+"\" "+"src=\""+this.options.sortDescendImg+"\"/>";}}}},getSortedColumnIndex:function(){var cols=this.options.columns;for(var i=0;i<cols.length;i++){if(cols[i].isSorted()){return i;}}return -1;},introspectForColumnInfo:function(){var _3e0=new Array();var _3e1=this.headerTable.rows[0];var _3e2=_3e1.cells;for(var i=0;i<_3e2.length;i++){_3e0.push(new Rico.TableColumn(this.deriveColumnNameFromCell(_3e2[i],i),true));}return _3e0;},convertToTableColumns:function(cols){var _3e5=new Array();for(var i=0;i<cols.length;i++){_3e5.push(new Rico.TableColumn(cols[i][0],cols[i][1]));}return _3e5;},deriveColumnNameFromCell:function(cell,_3e8){var _3e9=cell.innerText!=undefined?cell.innerText:cell.textContent;return _3e9?_3e9.toLowerCase().split(" ").join("_"):"col_"+_3e8;}};Rico.TableColumn=Class.create();Rico.TableColumn.UNSORTED=0;Rico.TableColumn.SORT_ASC="ASC";Rico.TableColumn.SORT_DESC="DESC";Rico.TableColumn.prototype={initialize:function(name,_3eb){this.name=name;this.sortable=_3eb;this.currentSort=Rico.TableColumn.UNSORTED;},isSortable:function(){return this.sortable;},isSorted:function(){return this.currentSort!=Rico.TableColumn.UNSORTED;},getSortDirection:function(){return this.currentSort;},toggleSort:function(){if(this.currentSort==Rico.TableColumn.UNSORTED||this.currentSort==Rico.TableColumn.SORT_DESC){this.currentSort=Rico.TableColumn.SORT_ASC;}else{if(this.currentSort==Rico.TableColumn.SORT_ASC){this.currentSort=Rico.TableColumn.SORT_DESC;}}},setUnsorted:function(_3ec){this.setSorted(Rico.TableColumn.UNSORTED);},setSorted:function(_3ed){this.currentSort=_3ed;}};var RicoUtil={getElementsComputedStyle:function(_3ee,_3ef,_3f0){if(arguments.length==2){_3f0=_3ef;}var el=$(_3ee);if(el.currentStyle){return el.currentStyle[_3ef];}else{cs=document.defaultView.getComputedStyle(el,null);if(cs){return cs.getPropertyValue(_3f0);}else{return null;}}},createXmlDocument:function(){if(document.implementation&&document.implementation.createDocument){var doc=document.implementation.createDocument("","",null);if(doc.readyState==null){doc.readyState=1;doc.addEventListener("load",function(){doc.readyState=4;if(typeof doc.onreadystatechange=="function"){doc.onreadystatechange();}},false);}return doc;}if(window.ActiveXObject){return Try.these(function(){return new ActiveXObject("MSXML2.DomDocument");},function(){return new ActiveXObject("Microsoft.DomDocument");},function(){return new ActiveXObject("MSXML.DomDocument");},function(){return new ActiveXObject("MSXML3.DomDocument");})||false;}return null;},getContentAsString:function(_3f3){return _3f3.xml!=undefined?this._getContentAsStringIE(_3f3):this._getContentAsStringMozilla(_3f3);},_getContentAsStringIE:function(_3f4){var _3f5="";for(var i=0;i<_3f4.childNodes.length;i++){var n=_3f4.childNodes[i];if(n.nodeType==4){_3f5+=n.nodeValue;}else{_3f5+=n.xml;}}return _3f5;},_getContentAsStringMozilla:function(_3f8){var _3f9=new XMLSerializer();var _3fa="";for(var i=0;i<_3f8.childNodes.length;i++){var n=_3f8.childNodes[i];if(n.nodeType==4){_3fa+=n.nodeValue;}else{_3fa+=_3f9.serializeToString(n);}}return _3fa;},toViewportPosition:function(_3fd){return this._toAbsolute(_3fd,true);},toDocumentPosition:function(_3fe){return this._toAbsolute(_3fe,false);},_toAbsolute:function(_3ff,_400){if(navigator.userAgent.toLowerCase().indexOf("msie")==-1){return this._toAbsoluteMozilla(_3ff,_400);}var x=0;var y=0;var _403=_3ff;while(_403){var _404=0;var _405=0;if(_403!=_3ff){var _406=parseInt(this.getElementsComputedStyle(_403,"borderLeftWidth"));var _407=parseInt(this.getElementsComputedStyle(_403,"borderTopWidth"));_406=isNaN(_406)?0:_406;_407=isNaN(_407)?0:_407;}x+=_403.offsetLeft-_403.scrollLeft+_406;y+=_403.offsetTop-_403.scrollTop+_407;_403=_403.offsetParent;}if(_400){x-=this.docScrollLeft();y-=this.docScrollTop();}return {x:x,y:y};},_toAbsoluteMozilla:function(_408,_409){var x=0;var y=0;var _40c=_408;while(_40c){x+=_40c.offsetLeft;y+=_40c.offsetTop;_40c=_40c.offsetParent;}_40c=_408;while(_40c&&_40c!=document.body&&_40c!=document.documentElement){if(_40c.scrollLeft){x-=_40c.scrollLeft;}if(_40c.scrollTop){y-=_40c.scrollTop;}_40c=_40c.parentNode;}if(_409){x-=this.docScrollLeft();y-=this.docScrollTop();}return {x:x,y:y};},docScrollLeft:function(){if(window.pageXOffset){return window.pageXOffset;}else{if(document.documentElement&&document.documentElement.scrollLeft){return document.documentElement.scrollLeft;}else{if(document.body){return document.body.scrollLeft;}else{return 0;}}}},docScrollTop:function(){if(window.pageYOffset){return window.pageYOffset;}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop;}else{if(document.body){return document.body.scrollTop;}else{return 0;}}}}};String.prototype.parseColor=function(){var _40d="#";if(this.slice(0,4)=="rgb("){var cols=this.slice(4,this.length-1).split(",");var i=0;do{_40d+=parseInt(cols[i]).toColorPart();}while(++i<3);}else{if(this.slice(0,1)=="#"){if(this.length==4){for(var i=1;i<4;i++){_40d+=(this.charAt(i)+this.charAt(i)).toLowerCase();}}if(this.length==7){_40d=this.toLowerCase();}}}return (_40d.length==7?_40d:(arguments[0]||this));};Element.collectTextNodes=function(_411){return $A($(_411).childNodes).collect(function(node){return (node.nodeType==3?node.nodeValue:(node.hasChildNodes()?Element.collectTextNodes(node):""));}).flatten().join("");};Element.collectTextNodesIgnoreClass=function(_413,_414){return $A($(_413).childNodes).collect(function(node){return (node.nodeType==3?node.nodeValue:((node.hasChildNodes()&&!Element.hasClassName(node,_414))?Element.collectTextNodesIgnoreClass(node,_414):""));}).flatten().join("");};Element.setContentZoom=function(_416,_417){_416=$(_416);Element.setStyle(_416,{fontSize:(_417/100)+"em"});if(navigator.appVersion.indexOf("AppleWebKit")>0){window.scrollBy(0,0);}};Element.getOpacity=function(_418){var _419;if(_419=Element.getStyle(_418,"opacity")){return parseFloat(_419);}if(_419=(Element.getStyle(_418,"filter")||"").match(/alpha\(opacity=(.*)\)/)){if(_419[1]){return parseFloat(_419[1])/100;}}return 1;};Element.setOpacity=function(_41a,_41b){_41a=$(_41a);if(_41b==1){Element.setStyle(_41a,{opacity:(/Gecko/.test(navigator.userAgent)&&!/Konqueror|Safari|KHTML/.test(navigator.userAgent))?0.999999:1});if(/MSIE/.test(navigator.userAgent)&&!window.opera){Element.setStyle(_41a,{filter:Element.getStyle(_41a,"filter").replace(/alpha\([^\)]*\)/gi,"")});}}else{if(_41b<0.00001){_41b=0;}Element.setStyle(_41a,{opacity:_41b});if(/MSIE/.test(navigator.userAgent)&&!window.opera){Element.setStyle(_41a,{filter:Element.getStyle(_41a,"filter").replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+_41b*100+")"});}}};Element.getInlineOpacity=function(_41c){return $(_41c).style.opacity||"";};Element.childrenWithClassName=function(_41d,_41e,_41f){var _420=new RegExp("(^|\\s)"+_41e+"(\\s|$)");var _421=$A($(_41d).getElementsByTagName("*"))[_41f?"detect":"select"](function(c){return (c.className&&c.className.match(_420));});if(!_421){_421=[];}return _421;};Element.forceRerendering=function(_423){try{_423=$(_423);var n=document.createTextNode(" ");_423.appendChild(n);_423.removeChild(n);}catch(e){}};Array.prototype.call=function(){var args=arguments;this.each(function(f){f.apply(this,args);});};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},tagifyText:function(_427){if(typeof Builder=="undefined"){throw ("Effect.tagifyText requires including script.aculo.us' builder.js library");}var _428="position:relative";if(/MSIE/.test(navigator.userAgent)&&!window.opera){_428+=";zoom:1";}_427=$(_427);$A(_427.childNodes).each(function(_429){if(_429.nodeType==3){_429.nodeValue.toArray().each(function(_42a){_427.insertBefore(Builder.node("span",{style:_428},_42a==" "?String.fromCharCode(160):_42a),_429);});Element.remove(_429);}});},multiple:function(_42b,_42c){var _42d;if(((typeof _42b=="object")||(typeof _42b=="function"))&&(_42b.length)){_42d=_42b;}else{_42d=$(_42b).childNodes;}var _42e=Object.extend({speed:0.1,delay:0},arguments[2]||{});var _42f=_42e.delay;$A(_42d).each(function(_430,_431){new _42c(_430,Object.extend(_42e,{delay:_431*_42e.speed+_42f}));});},PAIRS:{"slide":["SlideDown","SlideUp"],"blind":["BlindDown","BlindUp"],"appear":["Appear","Fade"]},toggle:function(_432,_433){_432=$(_432);_433=(_433||"appear").toLowerCase();var _434=Object.extend({queue:{position:"end",scope:(_432.id||"global"),limit:1}},arguments[2]||{});Effect[_432.visible()?Effect.PAIRS[_433][1]:Effect.PAIRS[_433][0]](_432,_434);}};var Effect2=Effect;Effect.Transitions={};Effect.Transitions.linear=Prototype.K;Effect.Transitions.sinoidal=function(pos){return (-Math.cos(pos*Math.PI)/2)+0.5;};Effect.Transitions.reverse=function(pos){return 1-pos;};Effect.Transitions.flicker=function(pos){return ((-Math.cos(pos*Math.PI)/4)+0.75)+Math.random()/4;};Effect.Transitions.wobble=function(pos){return (-Math.cos(pos*Math.PI*(9*pos))/2)+0.5;};Effect.Transitions.pulse=function(pos){return (Math.floor(pos*10)%2==0?(pos*10-Math.floor(pos*10)):1-(pos*10-Math.floor(pos*10)));};Effect.Transitions.none=function(pos){return 0;};Effect.Transitions.full=function(pos){return 1;};Effect.ScopedQueue=Class.create();Object.extend(Object.extend(Effect.ScopedQueue.prototype,Enumerable),{initialize:function(){this.effects=[];this.interval=null;},_each:function(_43c){this.effects._each(_43c);},add:function(_43d){var _43e=new Date().getTime();var _43f=(typeof _43d.options.queue=="string")?_43d.options.queue:_43d.options.queue.position;switch(_43f){case "front":this.effects.findAll(function(e){return e.state=="idle";}).each(function(e){e.startOn+=_43d.finishOn;e.finishOn+=_43d.finishOn;});break;case "end":_43e=this.effects.pluck("finishOn").max()||_43e;break;}_43d.startOn+=_43e;_43d.finishOn+=_43e;if(!_43d.options.queue.limit||(this.effects.length<_43d.options.queue.limit)){this.effects.push(_43d);}if(!this.interval){this.interval=setInterval(this.loop.bind(this),40);}},remove:function(_442){this.effects=this.effects.reject(function(e){return e==_442;});if(this.effects.length==0){clearInterval(this.interval);this.interval=null;}},loop:function(){var _444=new Date().getTime();this.effects.invoke("loop",_444);}});Effect.Queues={instances:$H(),get:function(_445){if(typeof _445!="string"){return _445;}if(!this.instances[_445]){this.instances[_445]=new Effect.ScopedQueue();}return this.instances[_445];}};Effect.Queue=Effect.Queues.get("global");Effect.DefaultOptions={transition:Effect.Transitions.sinoidal,duration:1,fps:25,sync:false,from:0,to:1,delay:0,queue:"parallel"};Effect.Base=function(){};Effect.Base.prototype={position:null,start:function(_446){this.options=Object.extend(Object.extend({},Effect.DefaultOptions),_446||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.event("beforeStart");if(!this.options.sync){Effect.Queues.get(typeof this.options.queue=="string"?"global":this.options.queue.scope).add(this);}},loop:function(_447){if(_447>=this.startOn){if(_447>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");if(this.finish){this.finish();}this.event("afterFinish");return;}var pos=(_447-this.startOn)/(this.finishOn-this.startOn);var _449=Math.round(pos*this.options.fps*this.options.duration);if(_449>this.currentFrame){this.render(pos);this.currentFrame=_449;}}},render:function(pos){if(this.state=="idle"){this.state="running";this.event("beforeSetup");if(this.setup){this.setup();}this.event("afterSetup");}if(this.state=="running"){if(this.options.transition){pos=this.options.transition(pos);}pos*=(this.options.to-this.options.from);pos+=this.options.from;this.position=pos;this.event("beforeUpdate");if(this.update){this.update(pos);}this.event("afterUpdate");}},cancel:function(){if(!this.options.sync){Effect.Queues.get(typeof this.options.queue=="string"?"global":this.options.queue.scope).remove(this);}this.state="finished";},event:function(_44b){if(this.options[_44b+"Internal"]){this.options[_44b+"Internal"](this);}if(this.options[_44b]){this.options[_44b](this);}},inspect:function(){return "#<Effect:"+$H(this).inspect()+",options:"+$H(this.options).inspect()+">";}};Effect.Parallel=Class.create();Object.extend(Object.extend(Effect.Parallel.prototype,Effect.Base.prototype),{initialize:function(_44c){this.effects=_44c||[];this.start(arguments[1]);},update:function(_44d){this.effects.invoke("render",_44d);},finish:function(_44e){this.effects.each(function(_44f){_44f.render(1);_44f.cancel();_44f.event("beforeFinish");if(_44f.finish){_44f.finish(_44e);}_44f.event("afterFinish");});}});Effect.Opacity=Class.create();Object.extend(Object.extend(Effect.Opacity.prototype,Effect.Base.prototype),{initialize:function(_450){this.element=$(_450);if(!this.element){throw (Effect._elementDoesNotExistError);}if(/MSIE/.test(navigator.userAgent)&&!window.opera&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1});}var _451=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(_451);},update:function(_452){this.element.setOpacity(_452);}});Effect.Move=Class.create();Object.extend(Object.extend(Effect.Move.prototype,Effect.Base.prototype),{initialize:function(_453){this.element=$(_453);if(!this.element){throw (Effect._elementDoesNotExistError);}var _454=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(_454);},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop;}},update:function(_455){this.element.setStyle({left:Math.round(this.options.x*_455+this.originalLeft)+"px",top:Math.round(this.options.y*_455+this.originalTop)+"px"});}});Effect.MoveBy=function(_456,_457,_458){return new Effect.Move(_456,Object.extend({x:_458,y:_457},arguments[3]||{}));};Effect.Scale=Class.create();Object.extend(Object.extend(Effect.Scale.prototype,Effect.Base.prototype),{initialize:function(_459,_45a){this.element=$(_459);if(!this.element){throw (Effect._elementDoesNotExistError);}var _45b=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:_45a},arguments[2]||{});this.start(_45b);},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle("position");this.originalStyle={};["top","left","width","height","fontSize"].each(function(k){this.originalStyle[k]=this.element.style[k];}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var _45d=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(_45e){if(_45d.indexOf(_45e)>0){this.fontSize=parseFloat(_45d);this.fontSizeType=_45e;}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=="box"){this.dims=[this.element.offsetHeight,this.element.offsetWidth];}if(/^content/.test(this.options.scaleMode)){this.dims=[this.element.scrollHeight,this.element.scrollWidth];}if(!this.dims){this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth];}},update:function(_45f){var _460=(this.options.scaleFrom/100)+(this.factor*_45f);if(this.options.scaleContent&&this.fontSize){this.element.setStyle({fontSize:this.fontSize*_460+this.fontSizeType});}this.setDimensions(this.dims[0]*_460,this.dims[1]*_460);},finish:function(_461){if(this.restoreAfterFinish){this.element.setStyle(this.originalStyle);}},setDimensions:function(_462,_463){var d={};if(this.options.scaleX){d.width=Math.round(_463)+"px";}if(this.options.scaleY){d.height=Math.round(_462)+"px";}if(this.options.scaleFromCenter){var topd=(_462-this.dims[0])/2;var _466=(_463-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY){d.top=this.originalTop-topd+"px";}if(this.options.scaleX){d.left=this.originalLeft-_466+"px";}}else{if(this.options.scaleY){d.top=-topd+"px";}if(this.options.scaleX){d.left=-_466+"px";}}}this.element.setStyle(d);}});Effect.Highlight=Class.create();Object.extend(Object.extend(Effect.Highlight.prototype,Effect.Base.prototype),{initialize:function(_467){this.element=$(_467);if(!this.element){throw (Effect._elementDoesNotExistError);}var _468=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(_468);},setup:function(){if(this.element.getStyle("display")=="none"){this.cancel();return;}this.oldStyle={backgroundImage:this.element.getStyle("background-image")};this.element.setStyle({backgroundImage:"none"});if(!this.options.endcolor){this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff");}if(!this.options.restorecolor){this.options.restorecolor=this.element.getStyle("background-color");}this._base=$R(0,2).map(function(i){return parseInt(this.options.startcolor.slice(i*2+1,i*2+3),16);}.bind(this));this._delta=$R(0,2).map(function(i){return parseInt(this.options.endcolor.slice(i*2+1,i*2+3),16)-this._base[i];}.bind(this));},update:function(_46b){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(m,v,i){return m+(Math.round(this._base[i]+(this._delta[i]*_46b)).toColorPart());}.bind(this))});},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}));}});Effect.ScrollTo=Class.create();Object.extend(Object.extend(Effect.ScrollTo.prototype,Effect.Base.prototype),{initialize:function(_46f){this.element=$(_46f);this.start(arguments[1]||{});},setup:function(){Position.prepare();var _470=Position.cumulativeOffset(this.element);if(this.options.offset){_470[1]+=this.options.offset;}var max=window.innerHeight?window.height-window.innerHeight:document.body.scrollHeight-(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight);this.scrollStart=Position.deltaY;this.delta=(_470[1]>max?max:_470[1])-this.scrollStart;},update:function(_472){Position.prepare();window.scrollTo(Position.deltaX,this.scrollStart+(_472*this.delta));}});Effect.Fade=function(_473){_473=$(_473);var _474=_473.getInlineOpacity();var _475=Object.extend({from:_473.getOpacity()||1,to:0,afterFinishInternal:function(_476){if(_476.options.to!=0){return;}_476.element.hide();_476.element.setStyle({opacity:_474});}},arguments[1]||{});return new Effect.Opacity(_473,_475);};Effect.Appear=function(_477){_477=$(_477);var _478=Object.extend({from:(_477.getStyle("display")=="none"?0:_477.getOpacity()||0),to:1,afterFinishInternal:function(_479){_479.element.forceRerendering();},beforeSetup:function(_47a){_47a.element.setOpacity(_47a.options.from);_47a.element.show();}},arguments[1]||{});return new Effect.Opacity(_477,_478);};Effect.Puff=function(_47b){_47b=$(_47b);var _47c={opacity:_47b.getInlineOpacity(),position:_47b.getStyle("position"),top:_47b.style.top,left:_47b.style.left,width:_47b.style.width,height:_47b.style.height};return new Effect.Parallel([new Effect.Scale(_47b,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(_47b,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(_47d){Position.absolutize(_47d.effects[0].element);},afterFinishInternal:function(_47e){_47e.effects[0].element.hide();_47e.effects[0].element.setStyle(_47c);}},arguments[1]||{}));};Effect.BlindUp=function(_47f){_47f=$(_47f);_47f.makeClipping();return new Effect.Scale(_47f,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(_480){_480.element.hide();_480.element.undoClipping();}},arguments[1]||{}));};Effect.BlindDown=function(_481){_481=$(_481);var _482=_481.getDimensions();return new Effect.Scale(_481,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:_482.height,originalWidth:_482.width},restoreAfterFinish:true,afterSetup:function(_483){_483.element.makeClipping();_483.element.setStyle({height:"0px"});_483.element.show();},afterFinishInternal:function(_484){_484.element.undoClipping();}},arguments[1]||{}));};Effect.SwitchOff=function(_485){_485=$(_485);var _486=_485.getInlineOpacity();return new Effect.Appear(_485,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(_487){new Effect.Scale(_487.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(_488){_488.element.makePositioned();_488.element.makeClipping();},afterFinishInternal:function(_489){_489.element.hide();_489.element.undoClipping();_489.element.undoPositioned();_489.element.setStyle({opacity:_486});}});}},arguments[1]||{}));};Effect.DropOut=function(_48a){_48a=$(_48a);var _48b={top:_48a.getStyle("top"),left:_48a.getStyle("left"),opacity:_48a.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(_48a,{x:0,y:100,sync:true}),new Effect.Opacity(_48a,{sync:true,to:0})],Object.extend({duration:0.5,beforeSetup:function(_48c){_48c.effects[0].element.makePositioned();},afterFinishInternal:function(_48d){_48d.effects[0].element.hide();_48d.effects[0].element.undoPositioned();_48d.effects[0].element.setStyle(_48b);}},arguments[1]||{}));};Effect.Shake=function(_48e){_48e=$(_48e);var _48f={top:_48e.getStyle("top"),left:_48e.getStyle("left")};return new Effect.Move(_48e,{x:20,y:0,duration:0.05,afterFinishInternal:function(_490){new Effect.Move(_490.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(_491){new Effect.Move(_491.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(_492){new Effect.Move(_492.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(_493){new Effect.Move(_493.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(_494){new Effect.Move(_494.element,{x:-20,y:0,duration:0.05,afterFinishInternal:function(_495){_495.element.undoPositioned();_495.element.setStyle(_48f);}});}});}});}});}});}});};Effect.SlideDown=function(_496){_496=$(_496);_496.cleanWhitespace();var _497=$(_496.firstChild).getStyle("bottom");var _498=_496.getDimensions();return new Effect.Scale(_496,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:_498.height,originalWidth:_498.width},restoreAfterFinish:true,afterSetup:function(_499){_499.element.makePositioned();_499.element.firstChild.makePositioned();if(window.opera){_499.element.setStyle({top:""});}_499.element.makeClipping();_499.element.setStyle({height:"0px"});_499.element.show();},afterUpdateInternal:function(_49a){_49a.element.firstChild.setStyle({bottom:(_49a.dims[0]-_49a.element.clientHeight)+"px"});},afterFinishInternal:function(_49b){_49b.element.undoClipping();if(/MSIE/.test(navigator.userAgent)&&!window.opera){_49b.element.undoPositioned();_49b.element.firstChild.undoPositioned();}else{_49b.element.firstChild.undoPositioned();_49b.element.undoPositioned();}_49b.element.firstChild.setStyle({bottom:_497});}},arguments[1]||{}));};Effect.SlideUp=function(_49c){_49c=$(_49c);_49c.cleanWhitespace();var _49d=$(_49c.firstChild).getStyle("bottom");return new Effect.Scale(_49c,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,restoreAfterFinish:true,beforeStartInternal:function(_49e){_49e.element.makePositioned();_49e.element.firstChild.makePositioned();if(window.opera){_49e.element.setStyle({top:""});}_49e.element.makeClipping();_49e.element.show();},afterUpdateInternal:function(_49f){_49f.element.firstChild.setStyle({bottom:(_49f.dims[0]-_49f.element.clientHeight)+"px"});},afterFinishInternal:function(_4a0){_4a0.element.hide();_4a0.element.undoClipping();_4a0.element.firstChild.undoPositioned();_4a0.element.undoPositioned();_4a0.element.setStyle({bottom:_49d});}},arguments[1]||{}));};Effect.Squish=function(_4a1){return new Effect.Scale(_4a1,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(_4a2){_4a2.element.makeClipping(_4a2.element);},afterFinishInternal:function(_4a3){_4a3.element.hide(_4a3.element);_4a3.element.undoClipping(_4a3.element);}});};Effect.Grow=function(_4a4){_4a4=$(_4a4);var _4a5=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var _4a6={top:_4a4.style.top,left:_4a4.style.left,height:_4a4.style.height,width:_4a4.style.width,opacity:_4a4.getInlineOpacity()};var dims=_4a4.getDimensions();var _4a8,initialMoveY;var _4a9,moveY;switch(_4a5.direction){case "top-left":_4a8=initialMoveY=_4a9=moveY=0;break;case "top-right":_4a8=dims.width;initialMoveY=moveY=0;_4a9=-dims.width;break;case "bottom-left":_4a8=_4a9=0;initialMoveY=dims.height;moveY=-dims.height;break;case "bottom-right":_4a8=dims.width;initialMoveY=dims.height;_4a9=-dims.width;moveY=-dims.height;break;case "center":_4a8=dims.width/2;initialMoveY=dims.height/2;_4a9=-dims.width/2;moveY=-dims.height/2;break;}return new Effect.Move(_4a4,{x:_4a8,y:initialMoveY,duration:0.01,beforeSetup:function(_4aa){_4aa.element.hide();_4aa.element.makeClipping();_4aa.element.makePositioned();},afterFinishInternal:function(_4ab){new Effect.Parallel([new Effect.Opacity(_4ab.element,{sync:true,to:1,from:0,transition:_4a5.opacityTransition}),new Effect.Move(_4ab.element,{x:_4a9,y:moveY,sync:true,transition:_4a5.moveTransition}),new Effect.Scale(_4ab.element,100,{scaleMode:{originalHeight:dims.height,originalWidth:dims.width},sync:true,scaleFrom:window.opera?1:0,transition:_4a5.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(_4ac){_4ac.effects[0].element.setStyle({height:"0px"});_4ac.effects[0].element.show();},afterFinishInternal:function(_4ad){_4ad.effects[0].element.undoClipping();_4ad.effects[0].element.undoPositioned();_4ad.effects[0].element.setStyle(_4a6);}},_4a5));}});};Effect.Shrink=function(_4ae){_4ae=$(_4ae);var _4af=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var _4b0={top:_4ae.style.top,left:_4ae.style.left,height:_4ae.style.height,width:_4ae.style.width,opacity:_4ae.getInlineOpacity()};var dims=_4ae.getDimensions();var _4b2,moveY;switch(_4af.direction){case "top-left":_4b2=moveY=0;break;case "top-right":_4b2=dims.width;moveY=0;break;case "bottom-left":_4b2=0;moveY=dims.height;break;case "bottom-right":_4b2=dims.width;moveY=dims.height;break;case "center":_4b2=dims.width/2;moveY=dims.height/2;break;}return new Effect.Parallel([new Effect.Opacity(_4ae,{sync:true,to:0,from:1,transition:_4af.opacityTransition}),new Effect.Scale(_4ae,window.opera?1:0,{sync:true,transition:_4af.scaleTransition,restoreAfterFinish:true}),new Effect.Move(_4ae,{x:_4b2,y:moveY,sync:true,transition:_4af.moveTransition})],Object.extend({beforeStartInternal:function(_4b3){_4b3.effects[0].element.makePositioned();_4b3.effects[0].element.makeClipping();},afterFinishInternal:function(_4b4){_4b4.effects[0].element.hide();_4b4.effects[0].element.undoClipping();_4b4.effects[0].element.undoPositioned();_4b4.effects[0].element.setStyle(_4b0);}},_4af));};Effect.Pulsate=function(_4b5){_4b5=$(_4b5);var _4b6=arguments[1]||{};var _4b7=_4b5.getInlineOpacity();var _4b8=_4b6.transition||Effect.Transitions.sinoidal;var _4b9=function(pos){return _4b8(1-Effect.Transitions.pulse(pos));};_4b9.bind(_4b8);return new Effect.Opacity(_4b5,Object.extend(Object.extend({duration:3,from:0,afterFinishInternal:function(_4bb){_4bb.element.setStyle({opacity:_4b7});}},_4b6),{transition:_4b9}));};Effect.Fold=function(_4bc){_4bc=$(_4bc);var _4bd={top:_4bc.style.top,left:_4bc.style.left,width:_4bc.style.width,height:_4bc.style.height};Element.makeClipping(_4bc);return new Effect.Scale(_4bc,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(_4be){new Effect.Scale(_4bc,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(_4bf){_4bf.element.hide();_4bf.element.undoClipping();_4bf.element.setStyle(_4bd);}});}},arguments[1]||{}));};["setOpacity","getOpacity","getInlineOpacity","forceRerendering","setContentZoom","collectTextNodes","collectTextNodesIgnoreClass","childrenWithClassName"].each(function(f){Element.Methods[f]=Element[f];});Element.Methods.visualEffect=function(_4c1,_4c2,_4c3){s=_4c2.gsub(/_/,"-").camelize();effect_class=s.charAt(0).toUpperCase()+s.substring(1);new Effect[effect_class](_4c1,_4c3);return $(_4c1);};Element.addMethods();if(typeof console=="undefined"){console={log:function(msg){}};}function safeify(func,name){return function(){try{return func.apply(this,arguments);}catch(e){console.log("Error in "+(name||func)+" at "+e.lineNumber+": "+e);return null;}};}function find(_4c7,item){if(len_of(_4c7)){var i;for(i=0;i<_4c7.length;i++){if(_4c7[i]==item){return i;}}}return -1;}function insertBeforeInList(_4ca,_4cb,_4cc){if(len_of(_4ca)){var i;for(i=_4ca.length-1;i>-1;i--){_4ca[i+1]=_4ca[i];if(_4ca[i]==_4cc){_4ca[i]=_4cb;return i;}}}_4ca[0]=_4cb;return -1;}function insertAfterInList(_4ce,_4cf,_4d0){if(len_of(_4ce)){var i;for(i=_4ce.length-1;i>-1;i--){_4ce[i+1]=_4ce[i];if(_4ce[i]==_4d0){_4ce[i+1]=_4cf;return i;}}}_4ce[0]=_4cf;return -1;}function addClass(_4d2,_4d3){if(!hasClass(_4d2,_4d3)){_4d2.className+=_4d2.className?" "+_4d3:_4d3;}}function removeClass(_4d4,_4d5){var re=new RegExp("\\b"+_4d5+"\\b");_4d4.className=_4d4.className.replace(re,"").trim().replace("  "," ");}function hasClass(_4d7,_4d8){return new RegExp("\\b"+_4d8+"\\b").test(_4d7.className);}function len_of(_4d9){return (_4d9&&_4d9.length?_4d9.length:0);}function evalHTML(_4da){if(typeof (_4da)!="string"){return null;}_4da=_4da.strip();if(_4da.length==0){return null;}var _4db=document.createElement("DIV");_4db.innerHTML="<TABLE><TBODY>"+_4da+"</TBODY></TABLE>";var body=_4db.firstChild.firstChild;var html=document.createDocumentFragment();var _4de;for(i=0;i<body.childNodes.length;i++){_4de=body.childNodes[i];html.appendChild(_4de);}return html;}function addLoadEvent(func){var _4e0=window.onload;if(typeof window.onload!="function"){window.onload=func;}else{window.onload=function(){if(_4e0){_4e0();}func();};}}function toggle(obj){if(obj.style.display=="none"){obj.style.display=obj.getAttribute("desired_display");}else{obj.setAttribute("desired_display",obj.style.display);obj.style.display="none";}}function insertAfter(_4e2,_4e3){if(_4e3.nextSibling){_4e3.parentNode.insertBefore(_4e2,_4e3.nextSibling);}else{_4e3.parentNode.appendChild(_4e2);}}function debugThing(){}var AddTaskDraggable=Class.create();AddTaskDraggable.prototype=(new Rico.Draggable()).extend({initialize:function(_4e4,name){this.type="AddTask";this.refElement=$(_4e4);this.htmlElement=this.refElement;this.name=name;}});var ColumnDraggable=Class.create();ColumnDraggable.prototype=(new Rico.Draggable()).extend({initialize:function(name){this.type="Column";this.htmlElement=$(name+"-heading");this.name=name;this.parent=$("column-heading");},startDrag:function(){var _4e7=this.htmlElement;var _4e8=false;$A(this.parent.getElementsByClassName("draggable-column-heading")).each(function(col,i){if(col==_4e7){col.tmpIndex=null;_4e8=true;}else{col.tmpIndex=_4e8?i-1:i;}});$A($("tasks").getElementsByClassName(this.name+"-column")).each(function(col){addClass(col,"currently-dragged-column");});},__finishDrag:function(){$A($("tasks").getElementsByClassName(this.name+"-column")).each(function(col){removeClass(col,"currently-dragged-column");});},endDrag:function(){this.__finishDrag();},cancelDrag:function(){this.__finishDrag();},getSingleObjectDragGUI:function(){var el=this.htmlElement;var div=document.createElement("div");div.className="customDraggable";div.style.width=this.htmlElement.offsetWidth;var text=el.innerHTML;new Insertion.Top(div,text);return div;}});var TaskItemDraggable=Class.create();TaskItemDraggable.prototype=(new Rico.Draggable()).extend({initialize:function(_4f0,_4f1,_4f2,name){this.type="Custom";this.refElement=$(_4f1);this.htmlElement=$(_4f0);this.owner=$(_4f2);this.name=name;},startDrag:function(){addClass(this.refElement,"drag");this.owner.dropzones.each(function(_4f4){dndMgr.deregisterDropZone(_4f4);});var _4f5=function(list){$A(list).each(function(node){addClass($("draggable_"+node.getAttribute("task_id")),"undroppable");_4f5(node.childTasks);node.dropzones.each(function(_4f8){dndMgr.deregisterDropZone(_4f8);});});};_4f5(this.owner.childTasks);},cancelDrag:function(){removeClass(this.refElement,"drag");this.endDrag();},endDrag:function(){this.owner.dropzones.each(function(_4f9){dndMgr.registerDropZone(_4f9);});var reg=function(list){$A(list).each(function(node){removeClass($("draggable_"+node.getAttribute("task_id")),"undroppable");reg(node.childTasks);node.dropzones.each(function(_4fd){dndMgr.registerDropZone(_4fd);});});};reg(this.owner.childTasks);},getSingleObjectDragGUI:function(){var el=this.htmlElement;var div=document.createElement("div");div.className="customDraggable";div.style.width=this.htmlElement.offsetWidth;var text=el.innerHTML;new Insertion.Top(div,text);return div;}});var ColumnDropzone=Class.create();ColumnDropzone.prototype=(new Rico.Dropzone()).extend({lastColIndex:-1,initialize:function(name){this.colName=name;this.htmlElement=$(name+"-heading");this.absoluteRect=null;this.acceptedObjects=[];this.halfWidth=this.htmlElement.offsetWidth/2;},canAccept:function(_502){var l=_502[0];if(l.type!="Column"){return false;}if(l.name==this.colName){return false;}return true;},activate:function(_504){return;},showHover:function(_505,e){var _507=this.__mouseInMyLeftHalf(e);var _508=this.htmlElement.tmpIndex;if(_507){_508-=0.5;}else{_508+=0.5;}if(_508==ColumnDropzone.lastColIndex){return;}if(_507){moveSecondBeforeFirst(this.colName,_505[0].name);}else{moveSecondAfterFirst(this.colName,_505[0].name);}ColumnDropzone.lastColIndex=_508;},hideHover:function(_509){return;},__mouseInMyLeftHalf:function(e){return e.clientX<(this.getAbsoluteRect().left+this.halfWidth+(e.offsetX?document.body.scrollLeft:0));},accept:function(_50b){ColumnDropzone.lastColLeft=ColumnDropzone.lastColRight=null;var _50c=[];$A($("column-heading").getElementsByTagName("TH")).each(function(col){var name=col.id.replace("-heading","");if(name=="status"){return;}_50c[_50c.length]=name;});_50c=_50c.join(",");setPermalink("columnOrder",_50c);}});var TaskItemDropzone=Class.create();TaskItemDropzone.prototype=(new Rico.Dropzone()).extend({initialize:function(_50f,_510,_511,_512,_513,_514){this.htmlElement=$(_50f);this.refElement=$(_510);this.owner=$(_511);this.absoluteRect=null;this.acceptedObjects=[];this.task_id=_512;this.indicator=$(_514);this.drop_reparent=_513;},showHover:function(){removeClass(this.indicator,"hidden");},activate:function(){return;},hideHover:function(){addClass(this.indicator,"hidden");},canAccept:function(_515){var l=_515.length;var i;for(i=0;i<l;i++){if(_515[i].type=="Column"){return false;}}return true;},accept:function(_518){var l=_518.length;var i;for(i=0;i<l;i++){doDrop(_518[i].refElement,this.refElement,this);}}});function createColumnDragDrop(_51b){dndMgr.registerDraggable(new ColumnDraggable(_51b));dndMgr.registerDropZone(new ColumnDropzone(_51b));}function createDragDrop(){if(!initialized&&hasReorderableTasks()){initialized=true;dndMgr.registerDropZone(new TaskItemDropzone("sibling_dropzone_0","sibling_dropzone_0",0,0,false,"sibling_dropzone_indicator_0"));$A($("tasks").getElementsByClassName("task-item")).each(function(node){enableDragDrop(node);});if($("deadline-heading")){createColumnDragDrop("deadline");}if($("updated-heading")){createColumnDragDrop("updated");}if($("priority-heading")){createColumnDragDrop("priority");}if($("owner-heading")){createColumnDragDrop("owner");}}}function enableDragDrop(node){var id=node.getAttribute("task_id");dndMgr.registerDraggable(node.draggable=new TaskItemDraggable("draggable_"+id,"draggable_"+id,node.id,"draggable-name"));node.dropzones=[];dndMgr.registerDropZone(node.dropzones[0]=new TaskItemDropzone("child_dropzone_"+id,"child_dropzone_"+id,node.id,id,true,"child_dropzone_indicator_"+id));dndMgr.registerDropZone(node.dropzones[1]=new TaskItemDropzone("sibling_dropzone_"+id,"sibling_dropzone_"+id,node.id,id,false,"sibling_dropzone_indicator_"+id));}var myrules={".draggable":function(_51f){_51f.onclick=function(e){e=e||event;if(hasClass(_51f,"drag")){removeClass(_51f,"drag");return false;}else{if(e.target&&e.target.doclick){return e.target.doclick(e);}else{if(e.srcElement&&e.srcElement.doclick){return e.srcElement.doclick(e);}}}};},"a#add_a_task":function(_521){_521.doclick=function(){showTaskCreate();return false;};},"img.treewidget":function(_522){_522.doclick=function(){toggleCollapse(_522.id.replace("handle_",""));return false;};},"a.task_item":function(_523){_523.doclick=function(){return true;};},"a#show_description":function(_524){_524.onclick=function(){$("hideable_add_description").hide();$("hideable_title_label").show();$("description_field").show();$("text").focus();return false;};},".post-link":function(_525){var form=Builder.node("form",{action:_525.getAttribute("href"),method:"POST"});form.style.display="inline";_525.parentNode.insertBefore(form,_525);_525.onclick=function(){var msg=_525.getAttribute("confirm_msg");if((msg&&confirm(msg))||!msg){form.submit();}return false;};},"th.draggable-column-heading":function(_528){_528.onclick=function(){if(!this.columnName){this.columnName=this.id.replace("-heading","");}sortBy(this.columnName);return false;};},".unfolded":function(_529){_529.onclick=unfold;},"a.uses_permalink":function(_52a){var _52b=$("permalink");if(_52b){_52a.href=_52a.getAttribute("base_href")+"?"+_52b.getAttribute("permalink");}}};Behavior.register(myrules);function showFilterColumn(_52c){$(_52c+"-filter-label").hide();$(_52c+"_filter").show();$(_52c+"_filter").focus();}function hasTasks(){return $("tasks");}function hasReorderableTasks(){var _52d=hasTasks();return _52d&&_52d.getAttribute("hasReorderableTasks")=="True"&&_52d.getElementsByTagName("TH").length;}function setTaskParents(){var _52e=hasTasks();if(_52e){$A(_52e.getElementsByClassName("task-item")).each(function(task){var _530;var _531;if(!task.childTasks){task.childTasks=[];}if((_530=task.getAttribute("parentID"))&&(_531=$("task_"+_530))){if(len_of(_531.childTasks)){_531.childTasks[_531.childTasks.length]=task;}else{_531.childTasks=[task];}}});}}function setupEmptyList(){in_task_show=$("subtasks")?1:0;if($("tasks")&&!($("tasks").getElementsByClassName("task-item").length)&&!in_task_show){showTaskCreate();}}function filterDeadline(task){var _533=$("deadline_filter").value;if(_533=="All"){return false;}if(_533=="None"){if(task.getAttribute("deadline")!="None"){return true;}else{return false;}}var _534=_533.split(",");var min;var max;if(_534.length==1){min=-1*parseInt(_534[0]);max=parseInt(_534[0]);}else{min=parseInt(_534[0]);max=parseInt(_534[1]);}var _537=new Date();var _538=new Date();_537.setDate(_537.getDate()-min);_538.setDate(_538.getDate()+max+1);var _539=task.getAttribute("deadline");if(_539!="None"){var db=new DateBocks();var _53b=db.parseDateString(_539);if(!(_53b<_538)){return true;}if(min<=max&&!(_53b>_537)){return true;}return false;}else{return true;}}function filterUpdated(task){var _53d=$("updated_filter").value;if(_53d=="All"){return false;}if(_53d=="None"){if(task.getAttribute("updated")){return true;}else{return false;}}var _53e=_53d.split(",");var min;var max;if(_53e.length==1){min=-1*parseInt(_53e[0]);max=parseInt(_53e[0]);}else{min=-1*parseInt(_53e[0]);max=-1*parseInt(_53e[1]);}var _541=new Date();var _542=new Date();_541.setDate(_541.getDate()-min);_542.setDate(_542.getDate()+max+1);var _543=task.getAttribute("updated");if(_543){var db=new DateBocks();var _545=db.parseDateString(_543);if(!(_545<_542)){return true;}if(min>=max&&!(_545>=_541)){return true;}return false;}else{return true;}}function filterField(_546,task){if(_546=="deadline"){return filterDeadline(task);}if(_546=="updated"){return filterUpdated(task);}filtervalue=$(_546+"_filter").value;if(filtervalue=="All"){return false;}if(task.getAttribute(_546)!=filtervalue){return true;}}function filterNodeByAllFields(node){var _549=false;var _54a=$("task_"+node.getAttribute("parentID"));node.depth_adjustment=0;if(_54a){node.depth_adjustment=_54a.depth_adjustment||0;}$A(["status","deadline","priority","owner","updated"]).each(function(_54b){var _54c=false;var _54d=$(_54b+"_filter");if(!_54d){return;}var _54e=_54d.value;setPermalink(_54b,_54e);if(_54e=="All"){_54c=true;}if(!_54c&&!_549){if(filterField(_54b,node)){var _54f=$("second_line_"+node.getAttribute("task_id"));if(_54f){_54f.hide();}--node.depth_adjustment;_549=true;}}reindentTask(node.getAttribute("task_id"),node.depth_adjustment);});return _549;}function filterListByAllFields(){$A($("tasks").getElementsByClassName("task-item")).each(function(node){if(filterNodeByAllFields(node)){node.hide();$("second_line_"+node.getAttribute("task_id")).hide();}else{node.show();$("second_line_"+node.getAttribute("task_id")).show();}});}filterLookups=new Object;filterLookups.deadline=new Object;filterLookups.deadline["Past due"]="-1";filterLookups.deadline["Due today"]="0";filterLookups.deadline["Due tomorrow"]="1";filterLookups.deadline["Due in the next week"]="0,7";filterLookups.deadline["No deadline"]="None";filterLookups.priority=new Object;filterLookups.priority["No priority"]="None";filterLookups.owner=new Object;filterLookups.owner["No owner"]="None";filterLookups.updated=new Object;filterLookups.updated["Today"]="0";filterLookups.updated["Yesterday"]="-1";filterLookups.updated["In the past week"]="-7,0";function sortAndFilter(){if(!hasReorderableTasks()||!$("permalink")){return;}var _551=$("permalink").getAttribute("permalink");_551=_551.split("&");var i;var _553=false;var _554=false;var _555=false;for(i=0;i<_551.length;++i){var key=_551[i].split("=");var val=key[1];key=key[0];if(key=="sortBy"){_554=val;}else{if(key=="sortOrder"){if(val=="up"||val=="down"){_555=val;}}else{var _558=$(key+"_filter");if(_558){_558.value=val;if(_558.value!=val){val=filterLookups[key][val];_558.value=val;}if(_558.value==val){_553=true;}}}}}if(_554){sortBy(_554,_555);}if(_553){filterListByAllFields();}}function viewChangeableField(_559,_55a){selected_form=$(_55a+"-form_"+_559);selected_label=$(_55a+"-label_"+_559);selected_label.hide();selected_form.show();$(_55a+"_"+_559).focus();}function hideChangeableField(_55b,_55c){selected_form=null;selected_label=null;$(_55c+"-form_"+_55b).hide();$(_55c+"-label_"+_55b).show();}function restoreAddTask(){$("add_task_anchor").appendChild($("movable_add_task"));showTaskCreate();$("add_task_form_parentID").setAttribute("value",0);$("add_task_form_siblingID").setAttribute("value",0);return false;}function doneAddingTask(req){$("error").innerHTML="";var _55e=parseInt($("add_task_form_parentID").getAttribute("value"));var _55f=parseInt($("add_task_form_siblingID").getAttribute("value"));var _560=evalHTML(req.responseText);var _561=_560.firstChild;var _562=$("no_tasks_placeholder");if(_562){_562.parentNode.removeChild(_562);}var _563=$("tasks");if(_55f!=0){var _564=$("task_"+_55f);insertAfter(_560,_564);}else{if(_55e!=0&&!hasClass(_563,"all_tasks")){var _565=$("task_"+_55e);insertAfter(_560,_565);updateTaskItem(_55e);if($("movable_add_task")){$("movable_add_task").parentNode.appendChild($("movable_add_task"));}}else{target=_563;for(i=0;i<_563.childNodes.length;++i){child=_563.childNodes[i];if(child.tagName=="TBODY"){target=child;break;}}tt=target;nf=_560;target.appendChild(_560);}}$("num_uncompleted").innerHTML=parseInt($("num_uncompleted").innerHTML)+1;_561.childTasks=[];enableDragDrop(_561);Behavior.apply();$A($("add_task_form").getElements()).each(function(node){if(node.type=="checkbox"){node.checked=false;}else{if(node.type=="submit"||node.type=="hidden"){return;}else{node.value="";}}});$("title").focus();if($("post_add_task")){eval($("post_add_task").getAttribute("func"))();}return;}doneAddingTask=safeify(doneAddingTask,"doneAddingTask");function failedAddingTask(req){$("error").innerHTML=req.responseText;console.log("failed to add task");}function changeField(_568,_569){if(changeEventsDisabled){return;}var _56a=$(_569+"_"+_568);_56a.disabled=true;var _56b=$("authenticator").value;var _56c=$("global-values").getAttribute("change_url");var url=_56c+_568+"?field="+_569+"&authenticator="+_56b;var _56e=(_56a.type=="checkbox")?_56a.checked:_56a.value;_56e=encodeURIComponent(_56e);var _56f=$("task_"+_568);var _570=_56f.getAttribute("is_preview");var _571=_56f.getAttribute("is_flat");var _572=_56f.getAttribute("editable_title");var _573=$("global-values");_573=(_573?_573.getAttribute("depth"):0);var _574;if($("permalink")){_574=$("permalink").getAttribute("permalink");if(_574){_574=_574.match(/columnOrder=[\w,]+/);if(_574){_574=_574[0];}}}console.log(url);var req=new Ajax.Request(url,{asynchronous:true,evalScripts:true,method:"post",parameters:_569+"="+_56e+"&is_preview="+_570+"&is_flat="+_571+"&editable_title="+_572+"&depth="+_573+(_574?"&columnOrder="+_574:""),onSuccess:doneChangingField.bind([_568,_569]),onFailure:failedChangingField.bind([_568,_569])});}var selected_form;var selected_label;function recalculateUncompletedChildren(_576){var _577=0;var _578=function(task){if(task.getAttribute("status")!="done"){++_577;}task.childTasks.each(function(_57a){_578(_57a);});};_576.childTasks.each(function(_57b){_578(_57b);});var _57c=_576.getElementsByClassName("num_subtasks")[0];_57c.innerHTML=_577;if(_577==0){_57c.parentNode.hide();}else{_57c.parentNode.show();}var _57d=_576.getElementsByClassName("the-word-task")[0];if(_577==1){_57d.innerHTML="task";}else{_57d.innerHTML="tasks";}}function updateTaskItem(_57e){var _57f=$("title_"+_57e);var _580=$("task_"+_57e);var _581=$("handle_"+_57e);var _582;if(_580.getAttribute("status")=="done"){_582="completed-task";}else{var db=new DateBocks();var date=_580.getAttribute("deadline");_582="uncompleted-task";if(date&&date!="None"){var now=new Date();if(date&&db.parseDateString(date)<now){_582="overdue-task";}}}var root;if(_580.childNodes[1].nodeType==1){root=(parseInt(_580.childNodes[1].getAttribute("depth"))===0)?"root-task":"sub-task";}else{root="root-task";}_57f.setAttribute("class",_582+" "+root);if(len_of(_580.childTasks)){expandTask(_57e);}else{flattenTask(_57e);}recalculateUncompletedChildren(_580);uncompletedTasks=0;$A(document.getElementsByClassName("task-item")).each(function(task){if(task.getAttribute("status")!="done"){++uncompletedTasks;}});$("num_uncompleted").innerHTML=uncompletedTasks;}function revertField(_588,_589){var _58a=$(_589+"_"+_588);var orig=_58a.getAttribute("originalvalue");var _58c=$(_589+"-label_"+_588);_58a.value=orig;_58c.innerHTML=orig;hideChangeableField(_588,_589);}function doneChangingField(req){console.log(req);if(req.status==200){succeededChangingField.bind(this)(req);}else{failedChangingField.bind(this)(req);}}function updateParentTask(_58e){recalculateUncompletedChildren(_58e);var _58f=_58e.getAttribute("parentID");if(_58f){var _590=$("task_"+_58f);if(_590){updateParentTask(_590);}}}function succeededChangingField(req){var _592=this[0];var _593=evalHTML(req.responseText);var _594=$("task_"+_592);var _595=$("task_"+_594.getAttribute("parentID"));_594.parentNode.replaceChild(_593,_594);_593=$("task_"+_592);_593.childTasks=_594.childTasks;var _596;if(_595&&len_of(_595.childTasks)){for(_596=0;_596<_595.childTasks.length;_596++){if(_595.childTasks[_596]==_594){break;}}}if(_595&&_595.getAttribute("is_flat")!="True"){if(len_of(_595.childTasks)){if(_596>=_595.childTasks.length){_595.childTasks[length]=_593;}else{insertBeforeInList(_595.childTasks,_593,_595.childTasks[_596]);}}else{_595.childTasks[0]=_593;}_595.childTasks.removeItem(_594);}var _597=this[1];if($("post_edit_task")){func=eval($("post_edit_task").getAttribute("func"));func(_592,_597);}enableDragDrop(_593);if(_595){updateParentTask(_595);}}function failedChangingField(req){var _599=this[0];var _59a=this[1];var _59b=$(_59a+"_"+_599);var _59c=$(_59a+"-label_"+_599);revertField(_599,_59a);_59b.disabled=false;_59c.style.color="red";}function reindentTask(_59d,_59e){var task=$("task_"+_59d);var _5a0=task.getElementsByTagName("SPAN")[0];var _5a1=$$("#task_"+_59d+" .handle")[0];var _5a2=parseInt(_5a0.getAttribute("depth"))+_59e;_5a1.style.marginLeft=15*_5a2+"px";}function doneMovingTask(req){var _5a4=eval(req.responseText);var _5a5=$$("#breaking-row")[0].parentNode;var _5a6=_5a5;_5a4.each(function(_5a7){var task=$("task_"+_5a7.id);if(_5a7.has_children){expandTask(_5a7.id);}else{flattenTask(_5a7.id);}var _5a9=_5a7.depth;var _5aa=task.getElementsByTagName("SPAN")[0];_5aa.setAttribute("depth",_5a9);var _5ab=$$("#task_"+_5a7.id+" .handle")[0];_5ab.style.marginLeft=15*_5a9+"px";var _5ac=$("second_line_"+_5a7.id);insertAfter(task,_5a6);insertAfter(_5ac,task);_5a6=_5ac;});}function showTaskCreate(){removeClass($("create"),"hidden");$("show_create").hide();$("title").focus();return false;}var mode="view";function doneDestroyingTask(req){var _5ae=this;$("task_"+_5ae).remove();$("second_line_"+_5ae).remove();}function failedDestroyingTask(req){var _5b0=this;$("task_"+_5b0).show();$("second_line_"+_5b0).show();}function destroyTask(_5b1,_5b2){var _5b3=_5b1.getAttribute("task_id");$("task_"+_5b3).hide();$("second_line_"+_5b3).hide();var req=new Ajax.Request("/task/destroy/"+_5b3,{asynchronous:true,evalScripts:true,method:"post",onSuccess:doneDestroyingTask.bind(_5b3),onFailure:failedDestroyingTask.bind(_5b3)});}function doDrop(_5b5,_5b6,_5b7){var id;if(_5b6==_5b5){return;}if(!_5b5.id.match("draggable")){if(_5b6.id.match(/^title_/)){id=parseInt(_5b6.id.replace(/^title_/,""));$("add_task_form_parentID").setAttribute("value",id);$("add_task_form_siblingID").setAttribute("value",0);var _5b9=$("task_"+id);var tr=document.createElement("TR");tr.className="taskrow";var td=document.createElement("TD");td.appendChild(_5b5);tr.appendChild(td);insertAfter(tr,_5b9);}else{id=parseInt(_5b6.id.replace(/^handle_/,""));$("add_task_form_parentID").setAttribute("value",0);$("add_task_form_siblingID").setAttribute("value",id);var _5bc=$("task_"+id);var _5bd=_5bc.parentNode;var tr=document.createElement("TR");tr.className="taskrow";tr.appendChild(_5b5);insertAfter(_5b5,_5bc);}return;}var _5bf=_5b5.id.replace("draggable_","");var _5c0=$("task_"+_5bf).getAttribute("parentID");id=parseInt(_5b7.task_id);if(_5b7.drop_reparent){var _5c1=$("task_"+id);var _5c2=$("global-values").getAttribute("move_url");new Ajax.Request(_5c2+_5bf,{asynchronous:true,evalScripts:true,method:"post",parameters:"new_parent="+id,onSuccess:doneMovingTask,onFailure:debugThing});}else{var _5c3=$("task_"+id);new Ajax.Request("/task/move/"+_5bf,{asynchronous:true,evalScripts:true,method:"post",parameters:"new_sibling="+id,onSuccess:doneMovingTask,onFailure:debugThing});}}function removeRow(ul,row){ul.removeChild(row);var id=row.getAttribute("task_id");row.second_line=$("second_line_"+id);ul.removeChild(row.second_line);}function sortListBy(ul,_5c8,_5c9,_5ca){if(!_5ca){_5ca="0";}items=$A(ul.getElementsByClassName("task-item")).filter(function(i){return i.getAttribute("parentID")==_5ca;});items=items.sort(function(x,y){var a=x.getAttribute(_5c8);var b=y.getAttribute(_5c8);if(!a&&b){return 1*_5c9;}else{if(!b&&a){return -1*_5c9;}else{if(a>b){return 1*_5c9;}else{if(b>a){return -1*_5c9;}else{if(x.getAttribute("sort_index")>y.getAttribute("sort_index")){return 1*_5c9;}else{if(x.getAttribute("sort_index")<y.getAttribute("sort_index")){return -1*_5c9;}else{return 0;}}}}}}});ul=ul.getElementsByTagName("TBODY")[0];items.each(function(x){removeRow(ul,x);$A(x.childTasks).each(function(i){removeRow(ul,i);});});items.each(function(x){ul.appendChild(x);ul.appendChild(x.second_line);$A(x.childTasks).each(function(i){ul.appendChild(i);ul.appendChild(i.second_line);});if(len_of(x.childTasks)){sortListBy($("tasks"),_5c8,_5c9,x.getAttribute("task_id"));}});}function setCollapse(_5d4,val){var node=$("task_"+_5d4);var _5d7=$("handle_"+_5d4);var _5d8=val?"minus.png":"plus.png";if(val){if(!filterNodeByAllFields(node)){node.show();$("second_line_"+_5d4).show();}}else{node.hide();$("second_line_"+_5d4).hide();}if(!val||_5d7.src.match("plus.png")){$A(node.childTasks).each(function(n){setCollapse(n.getAttribute("task_id"),val);});}}function toggleCollapse(_5da){var _5db=$("handle_"+_5da);if(_5db.src.match("minus.png")){_5db.src=_5db.src.replace("minus.png","plus.png");$A($("task_"+_5da).childTasks).each(function(node){setCollapse(node.getAttribute("task_id"),1);});}else{if(_5db.src.match("plus.png")){_5db.src=_5db.src.replace("plus.png","minus.png");$A($("task_"+_5da).childTasks).each(function(node){setCollapse(node.getAttribute("task_id"),0);});}}}function expandTask(_5de){var _5df=$("handle_"+_5de);if(_5df.src.match("blank.png")){_5df.src=_5df.src.replace("blank.png","plus.png");}else{if(_5df.src.match("minus.png")){toggleCollapse(_5de);}}}function flattenTask(_5e0){var _5e1=$("handle_"+_5e0);_5e1.src=_5e1.src.replace(/(plus|minus).png$/,"blank.png");}function sortBy(_5e2,_5e3){$A(document.getElementsByClassName("sort-arrows")).each(function(e){e.hide();});$A(document.getElementsByClassName("column-heading")).each(function(e){if(hasClass(e,_5e2+"-column")){if(!_5e3){_5e3=e.getAttribute("sortOrder")=="up"?"down":"up";}e.setAttribute("sortOrder",_5e3);addClass(e,"selected-column");_5e3=e.getAttribute("sortOrder");}else{e.setAttribute("sortOrder","");removeClass(e,"selected-column");}});$(_5e2+"-arrows").show();var _5e6=(_5e3=="up")?"down":"up";addClass($(_5e2+"-"+_5e6+"-arrow"),"grayed-out");removeClass($(_5e2+"-"+_5e3+"-arrow"),"grayed-out");setPermalink("sortBy",_5e2);setPermalink("sortOrder",_5e3);sortListBy($("tasks"),_5e2,_5e3=="up"?1:-1);}var initialized=false;function unfold(){var _5e7=$("edit_"+this.id);_5e7.style["display"]="block";$(this).hide();}function setPermalink(_5e8,_5e9){var _5ea=$("permalink");if(!_5ea){return;}var _5eb=_5ea.getAttribute("permalink");function wrapitup(){_5ea.setAttribute("permalink",_5eb);_5ea.href=_5ea.getAttribute("base")+"?"+_5ea.getAttribute("permalink");Behavior.applySelectedRule("a.uses_permalink");}var _5ec=_5eb.split("&");var i;for(i=0;i<_5ec.length;++i){var key=_5ec[i].split("=");var val=key[1];var key=key[0];if(key==_5e8){if(_5e9=="All"){_5eb=_5eb.replace(key+"="+val+"&","");}else{_5eb=_5eb.replace(key+"="+val,_5e8+"="+_5e9);}wrapitup();return;}}if(_5e9=="All"){return;}_5eb+=(_5e8+"="+_5e9+"&");wrapitup();}function onBodyClick(_5f1){trigger=Event.element(_5f1);node=trigger;while(node.parentNode){if(node==selected_form){return;}node=node.parentNode;}if(selected_form){selected_form.hide();selected_form=null;selected_label.show();selected_label=null;}}function moveSecondNextToFirst(a,b,_5f4){var x=a+"-column";var y=b+"-column";$A($("tasks").getElementsByTagName("TR")).each(function(row){var one=row.getElementsByClassName(x)[0];var two=row.getElementsByClassName(y)[0];if(one&&two){if(_5f4){row.insertBefore(two,one);}else{insertAfter(two,one);}}});}function moveSecondBeforeFirst(a,b){moveSecondNextToFirst(a,b,true);}function moveSecondAfterFirst(a,b){moveSecondNextToFirst(a,b,false);}Event.observe(document,"mousedown",onBodyClick);addLoadEvent(createDragDrop);addLoadEvent(setupEmptyList);addLoadEvent(setTaskParents);addLoadEvent(sortAndFilter);function utc(d){return Date.UTC(d.getFullYear(),d.getMonth(),d.getDate());}function date_diff(_5ff,_600){var _601=utc(_5ff);var _602=utc(_600);return (_601-_602)/86400000;}function dayOfWeek(day){return "SunMonTueWedThuFriSatSun".substr(day*3,3);}function monthName(_604){var _605=["January","February","March","April","May","June","July","August","September","October","November","December"];return _605[_604];}function pretty_date_engine(now,date){var diff=date_diff(date,now);if(diff==-1){return "Yesterday";}if(diff==0){return "Today";}if(diff==1){return "Tomorrow";}if(diff<7&&diff>0){return dayOfWeek(date.getDay());}if(diff<90&&date.getYear()==now.getYear()){return monthName(date.getMonth())+" "+date.getDate();}return monthName(date.getMonth())+" "+date.getDate()+", "+date.getFullYear();}function pretty_date_from_text(text,now){if(text=="No deadline"){return text;}console.log(text);parts=text.split("/");return pretty_date(new Date(parseInt(parts[2],10),parseInt(parts[0],10)-1,parseInt(parts[1],10)),now);}function pretty_date(date,now){if(!now){now=new Date();}return pretty_date_engine(now,date);}function test_pretty_date(){var now=new Date(2006,0,1);var _60e=[["Today",new Date(2006,0,1)],["Tomorrow",new Date(2006,0,2)],["Yesterday",new Date(2005,11,31)],["December 30, 2005",new Date(2005,11,30)],["Tue",new Date(2006,0,3)],["Sat",new Date(2006,0,7)],["January 8",new Date(2006,0,8)],["December 8, 2006",new Date(2006,11,8)],["January 8, 2007",new Date(2007,0,8)]];var i;for(i=0;i<_60e.length;i++){var date=_60e[i][1];var pd=pretty_date_engine(now,date);if(pd!=_60e[i][0]){alert("failure mapping "+date+" to "+_60e[i][0]+", got "+pd);}}now=new Date(2006,0,1);_60e=[["Today","01/01/2006"],["Tomorrow","01/02/2006"],["Yesterday","12/31/2005"],["December 30, 2005","12/30/2005"],["Tue","01/03/2006"],["Sat","01/07/2006"],["January 8","01/08/2006"],["December 8, 2006","12/08/2006"],["January 8, 2007","01/08/2007"]];var i;for(i=0;i<_60e.length;i++){var date=_60e[i][1];var pd=pretty_date_from_text(date,now);if(pd!=_60e[i][0]){alert("failure mapping "+date+" to "+_60e[i][0]+", got "+pd);}}}var Builder={NODEMAP:{AREA:"map",CAPTION:"table",COL:"table",COLGROUP:"table",LEGEND:"fieldset",OPTGROUP:"select",OPTION:"select",PARAM:"object",TBODY:"table",TD:"table",TFOOT:"table",TH:"table",THEAD:"table",TR:"table"},node:function(_615){_615=_615.toUpperCase();var _616=this.NODEMAP[_615]||"div";var _617=document.createElement(_616);try{_617.innerHTML="<"+_615+"></"+_615+">";}catch(e){}var _618=_617.firstChild||null;if(_618&&(_618.tagName!=_615)){_618=_618.getElementsByTagName(_615)[0];}if(!_618){_618=document.createElement(_615);}if(!_618){return;}if(arguments[1]){if(this._isStringOrNumber(arguments[1])||(arguments[1] instanceof Array)){this._children(_618,arguments[1]);}else{var _619=this._attributes(arguments[1]);if(_619.length){try{_617.innerHTML="<"+_615+" "+_619+"></"+_615+">";}catch(e){}_618=_617.firstChild||null;if(!_618){_618=document.createElement(_615);for(attr in arguments[1]){_618[attr=="class"?"className":attr]=arguments[1][attr];}}if(_618.tagName!=_615){_618=_617.getElementsByTagName(_615)[0];}}}}if(arguments[2]){this._children(_618,arguments[2]);}return _618;},_text:function(text){return document.createTextNode(text);},_attributes:function(_61b){var _61c=[];for(attribute in _61b){_61c.push((attribute=="className"?"class":attribute)+"=\""+_61b[attribute].toString().escapeHTML()+"\"");}return _61c.join(" ");},_children:function(_61d,_61e){if(typeof _61e=="object"){_61e.flatten().each(function(e){if(typeof e=="object"){_61d.appendChild(e);}else{if(Builder._isStringOrNumber(e)){_61d.appendChild(Builder._text(e));}}});}else{if(Builder._isStringOrNumber(_61e)){_61d.appendChild(Builder._text(_61e));}}},_isStringOrNumber:function(_620){return (typeof _620=="string"||typeof _620=="number");}};if(typeof Effect=="undefined"){throw ("controls.js requires including script.aculo.us' effects.js library");}var changeEventsDisabled=false;function reEnableChangeEvents(){changeEventsDisabled=false;}var Autocompleter={};Autocompleter.Base=function(){};Autocompleter.Base.prototype={baseInitialize:function(_621,_622,_623){this.element=$(_621);this.update=$(_622);this.hasFocus=false;this.changed=false;this.active=false;this.index=0;this.entryCount=0;if(this.setOptions){this.setOptions(_623);}else{this.options=_623||{};}this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.onShow=this.options.onShow||function(_624,_625){if(!_625.style.position||_625.style.position=="absolute"){_625.style.position="absolute";Position.clone(_624,_625,{setHeight:false,offsetTop:_624.offsetHeight});}Effect.Appear(_625,{duration:0.15});};this.options.onHide=this.options.onHide||function(_626,_627){new Effect.Fade(_627,{duration:0.15});};if(typeof (this.options.tokens)=="string"){this.options.tokens=new Array(this.options.tokens);}this.observer=null;this.element.setAttribute("autocomplete","off");Element.hide(this.update);Event.observe(this.element,"blur",this.onBlur.bindAsEventListener(this));Event.observe(this.element,"keypress",this.onKeyPress.bindAsEventListener(this));},show:function(){if(Element.getStyle(this.update,"display")=="none"){this.options.onShow(this.element,this.update);}if(!this.iefix&&(navigator.appVersion.indexOf("MSIE")>0)&&(navigator.userAgent.indexOf("Opera")<0)&&(Element.getStyle(this.update,"position")=="absolute")){new Insertion.After(this.update,"<iframe id=\""+this.update.id+"_iefix\" "+"style=\"display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);\" "+"src=\"javascript:false;\" frameborder=\"0\" scrolling=\"no\"></iframe>");this.iefix=$(this.update.id+"_iefix");}if(this.iefix){setTimeout(this.fixIEOverlapping.bind(this),50);}},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:(!this.update.style.height)});this.iefix.style.zIndex=1;this.update.style.zIndex=2;Element.show(this.iefix);},hide:function(){this.stopIndicator();if(Element.getStyle(this.update,"display")!="none"){this.options.onHide(this.element,this.update);}if(this.iefix){Element.hide(this.iefix);}},startIndicator:function(){if(this.options.indicator){Element.show(this.options.indicator);}},stopIndicator:function(){if(this.options.indicator){Element.hide(this.options.indicator);}},onKeyPress:function(_628){if(this.active){switch(_628.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();Event.stop(_628);case Event.KEY_ESC:this.hide();this.active=false;Event.stop(_628);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();if(navigator.appVersion.indexOf("AppleWebKit")>0){Event.stop(_628);}return;case Event.KEY_DOWN:this.markNext();this.render();if(navigator.appVersion.indexOf("AppleWebKit")>0){Event.stop(_628);}return;}}else{if(_628.keyCode==Event.KEY_TAB||_628.keyCode==Event.KEY_RETURN||(navigator.appVersion.indexOf("AppleWebKit")>0&&_628.keyCode==0)){return;}}this.changed=true;this.hasFocus=true;if(this.observer){clearTimeout(this.observer);}this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000);},activate:function(){this.changed=false;this.hasFocus=true;this.getUpdatedChoices();},onHover:function(_629){var _62a=Event.findElement(_629,"LI");if(this.index!=_62a.autocompleteIndex){this.index=_62a.autocompleteIndex;this.render();}Event.stop(_629);},onClick:function(_62b){changeEventsDisabled=false;var _62c=Event.findElement(_62b,"LI");this.index=_62c.autocompleteIndex;this.selectEntry();this.hide();},onBlur:function(_62d){changeEventsDisabled=true;setTimeout(reEnableChangeEvents,250);setTimeout(this.hide.bind(this),250);this.hasFocus=false;this.active=false;},render:function(){if(this.entryCount>0){for(var i=0;i<this.entryCount;i++){this.index==i?Element.addClassName(this.getEntry(i),"selected"):Element.removeClassName(this.getEntry(i),"selected");}if(this.hasFocus){this.show();this.active=true;}}else{this.active=false;this.hide();}},markPrevious:function(){if(this.index>0){this.index--;}else{this.index=this.entryCount-1;}this.getEntry(this.index).scrollIntoView(true);},markNext:function(){if(this.index<this.entryCount-1){this.index++;}else{this.index=0;}this.getEntry(this.index).scrollIntoView(false);},getEntry:function(_62f){return this.update.firstChild.childNodes[_62f];},getCurrentEntry:function(){return this.getEntry(this.index);},selectEntry:function(){this.active=false;this.updateElement(this.getCurrentEntry());},updateElement:function(_630){if(this.options.updateElement){this.options.updateElement(_630);return;}var _631="";if(this.options.select){var _632=document.getElementsByClassName(this.options.select,_630)||[];if(_632.length>0){_631=Element.collectTextNodes(_632[0],this.options.select);}}else{_631=Element.collectTextNodesIgnoreClass(_630,"informal");}var _633=this.findLastToken();if(_633!=-1){var _634=this.element.value.substr(0,_633+1);var _635=this.element.value.substr(_633+1).match(/^\s+/);if(_635){_634+=_635[0];}this.element.value=_634+_631;}else{this.element.value=_631;}this.element.focus();if(this.options.afterUpdateElement){this.options.afterUpdateElement(this.element,_630);}},updateChoices:function(_636){if(!this.changed&&this.hasFocus){this.update.innerHTML=_636;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.firstChild);if(this.update.firstChild&&this.update.firstChild.childNodes){this.entryCount=this.update.firstChild.childNodes.length;for(var i=0;i<this.entryCount;i++){var _638=this.getEntry(i);_638.autocompleteIndex=i;this.addObservers(_638);}}else{this.entryCount=0;}this.stopIndicator();this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide();}else{this.render();}}},addObservers:function(_639){Event.observe(_639,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(_639,"click",this.onClick.bindAsEventListener(this));},onObserverEvent:function(){this.changed=false;if(this.getToken().length>=this.options.minChars){this.startIndicator();this.getUpdatedChoices();}else{this.active=false;this.hide();}},getToken:function(){var _63a=this.findLastToken();if(_63a!=-1){var ret=this.element.value.substr(_63a+1).replace(/^\s+/,"").replace(/\s+$/,"");}else{var ret=this.element.value;}return /\n/.test(ret)?"":ret;},findLastToken:function(){var _63d=-1;for(var i=0;i<this.options.tokens.length;i++){var _63f=this.element.value.lastIndexOf(this.options.tokens[i]);if(_63f>_63d){_63d=_63f;}}return _63d;}};Ajax.Autocompleter=Class.create();Object.extend(Object.extend(Ajax.Autocompleter.prototype,Autocompleter.Base.prototype),{initialize:function(_640,_641,url,_643){this.baseInitialize(_640,_641,_643);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=url;},getUpdatedChoices:function(){entry=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,entry):entry;if(this.options.defaultParams){this.options.parameters+="&"+this.options.defaultParams;}new Ajax.Request(this.url,this.options);},onComplete:function(_644){this.updateChoices(_644.responseText);}});Autocompleter.Local=Class.create();Autocompleter.Local.prototype=Object.extend(new Autocompleter.Base(),{initialize:function(_645,_646,_647,_648){this.baseInitialize(_645,_646,_648);this.options.array=_647;},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this));},setOptions:function(_649){this.options=Object.extend({choices:10,partialSearch:true,partialChars:2,ignoreCase:true,fullSearch:false,selector:function(_64a){var ret=[];var _64c=[];var _64d=_64a.getToken();var _64e=0;for(var i=0;i<_64a.options.array.length&&ret.length<_64a.options.choices;i++){var elem=_64a.options.array[i];var _651=_64a.options.ignoreCase?elem.toLowerCase().indexOf(_64d.toLowerCase()):elem.indexOf(_64d);while(_651!=-1){if(_651==0&&elem.length!=_64d.length){ret.push("<li><strong>"+elem.substr(0,_64d.length)+"</strong>"+elem.substr(_64d.length)+"</li>");break;}else{if(_64d.length>=_64a.options.partialChars&&_64a.options.partialSearch&&_651!=-1){if(_64a.options.fullSearch||/\s/.test(elem.substr(_651-1,1))){_64c.push("<li>"+elem.substr(0,_651)+"<strong>"+elem.substr(_651,_64d.length)+"</strong>"+elem.substr(_651+_64d.length)+"</li>");break;}}}_651=_64a.options.ignoreCase?elem.toLowerCase().indexOf(_64d.toLowerCase(),_651+1):elem.indexOf(_64d,_651+1);}}if(_64c.length){ret=ret.concat(_64c.slice(0,_64a.options.choices-ret.length));}return "<ul>"+ret.join("")+"</ul>";}},_649||{});}});Field.scrollFreeActivate=function(_652){setTimeout(function(){Field.activate(_652);},1);};Ajax.InPlaceEditor=Class.create();Ajax.InPlaceEditor.defaultHighlightColor="#FFFF99";Ajax.InPlaceEditor.prototype={initialize:function(_653,url,_655){this.url=url;this.element=$(_653);this.options=Object.extend({okButton:true,okText:"ok",cancelLink:true,cancelText:"cancel",savingText:"Saving...",clickToEditText:"Click to edit",okText:"ok",rows:1,onComplete:function(_656,_657){new Effect.Highlight(_657,{startcolor:this.options.highlightcolor});},onFailure:function(_658){alert("Error communicating with the server: "+_658.responseText.stripTags());},callback:function(form){return Form.serialize(form);},handleLineBreaks:true,loadingText:"Loading...",savingClassName:"inplaceeditor-saving",loadingClassName:"inplaceeditor-loading",formClassName:"inplaceeditor-form",highlightcolor:Ajax.InPlaceEditor.defaultHighlightColor,highlightendcolor:"#FFFFFF",externalControl:null,submitOnBlur:false,ajaxOptions:{},evalScripts:false},_655||{});if(!this.options.formId&&this.element.id){this.options.formId=this.element.id+"-inplaceeditor";if($(this.options.formId)){this.options.formId=null;}}if(this.options.externalControl){this.options.externalControl=$(this.options.externalControl);}this.originalBackground=Element.getStyle(this.element,"background-color");if(!this.originalBackground){this.originalBackground="transparent";}this.element.title=this.options.clickToEditText;this.onclickListener=this.enterEditMode.bindAsEventListener(this);this.mouseoverListener=this.enterHover.bindAsEventListener(this);this.mouseoutListener=this.leaveHover.bindAsEventListener(this);Event.observe(this.element,"click",this.onclickListener);Event.observe(this.element,"mouseover",this.mouseoverListener);Event.observe(this.element,"mouseout",this.mouseoutListener);if(this.options.externalControl){Event.observe(this.options.externalControl,"click",this.onclickListener);Event.observe(this.options.externalControl,"mouseover",this.mouseoverListener);Event.observe(this.options.externalControl,"mouseout",this.mouseoutListener);}},enterEditMode:function(evt){if(this.saving){return;}if(this.editing){return;}this.editing=true;this.onEnterEditMode();if(this.options.externalControl){Element.hide(this.options.externalControl);}Element.hide(this.element);this.createForm();this.element.parentNode.insertBefore(this.form,this.element);if(!this.options.loadTextURL){Field.scrollFreeActivate(this.editField);}if(evt){Event.stop(evt);}return false;},createForm:function(){this.form=document.createElement("form");this.form.id=this.options.formId;Element.addClassName(this.form,this.options.formClassName);this.form.onsubmit=this.onSubmit.bind(this);this.createEditField();if(this.options.textarea){var br=document.createElement("br");this.form.appendChild(br);}if(this.options.okButton){okButton=document.createElement("input");okButton.type="submit";okButton.value=this.options.okText;okButton.className="editor_ok_button";this.form.appendChild(okButton);}if(this.options.cancelLink){cancelLink=document.createElement("a");cancelLink.href="#";cancelLink.appendChild(document.createTextNode(this.options.cancelText));cancelLink.onclick=this.onclickCancel.bind(this);cancelLink.className="editor_cancel";this.form.appendChild(cancelLink);}},hasHTMLLineBreaks:function(_65c){if(!this.options.handleLineBreaks){return false;}return _65c.match(/<br/i)||_65c.match(/<p>/i);},convertHTMLLineBreaks:function(_65d){return _65d.replace(/<br>/gi,"\n").replace(/<br\/>/gi,"\n").replace(/<\/p>/gi,"\n").replace(/<p>/gi,"");},createEditField:function(){var text;if(this.options.loadTextURL){text=this.options.loadingText;}else{text=this.getText();}var obj=this;if(this.options.rows==1&&!this.hasHTMLLineBreaks(text)){this.options.textarea=false;var _660=document.createElement("input");_660.obj=this;_660.type="text";_660.name="value";_660.value=text;_660.style.backgroundColor=this.options.highlightcolor;_660.className="editor_field";var size=this.options.size||this.options.cols||0;if(size!=0){_660.size=size;}if(this.options.submitOnBlur){_660.onblur=this.onSubmit.bind(this);}this.editField=_660;}else{this.options.textarea=true;var _662=document.createElement("textarea");_662.obj=this;_662.name="value";_662.value=this.convertHTMLLineBreaks(text);_662.rows=this.options.rows;_662.cols=this.options.cols||40;_662.className="editor_field";if(this.options.submitOnBlur){_662.onblur=this.onSubmit.bind(this);}this.editField=_662;}if(this.options.loadTextURL){this.loadExternalText();}this.form.appendChild(this.editField);},getText:function(){return this.element.innerHTML;},loadExternalText:function(){Element.addClassName(this.form,this.options.loadingClassName);this.editField.disabled=true;new Ajax.Request(this.options.loadTextURL,Object.extend({asynchronous:true,onComplete:this.onLoadedExternalText.bind(this)},this.options.ajaxOptions));},onLoadedExternalText:function(_663){Element.removeClassName(this.form,this.options.loadingClassName);this.editField.disabled=false;this.editField.value=_663.responseText.stripTags();Field.scrollFreeActivate(this.editField);},onclickCancel:function(){this.onComplete();this.leaveEditMode();return false;},onFailure:function(_664){this.options.onFailure(_664);if(this.oldInnerHTML){this.element.innerHTML=this.oldInnerHTML;this.oldInnerHTML=null;}return false;},onSubmit:function(){var form=this.form;var _666=this.editField.value;this.onLoading();if(this.options.evalScripts){new Ajax.Request(this.url,Object.extend({parameters:this.options.callback(form,_666),onComplete:this.onComplete.bind(this),onFailure:this.onFailure.bind(this),asynchronous:true,evalScripts:true},this.options.ajaxOptions));}else{new Ajax.Updater({success:this.element,failure:null},this.url,Object.extend({parameters:this.options.callback(form,_666),onComplete:this.onComplete.bind(this),onFailure:this.onFailure.bind(this)},this.options.ajaxOptions));}if(arguments.length>1){Event.stop(arguments[0]);}return false;},onLoading:function(){this.saving=true;this.removeForm();this.leaveHover();this.showSaving();},showSaving:function(){this.oldInnerHTML=this.element.innerHTML;this.element.innerHTML=this.options.savingText;Element.addClassName(this.element,this.options.savingClassName);this.element.style.backgroundColor=this.originalBackground;Element.show(this.element);},removeForm:function(){if(this.form){if(this.form.parentNode){Element.remove(this.form);}this.form=null;}},enterHover:function(){if(this.saving){return;}this.element.style.backgroundColor=this.options.highlightcolor;if(this.effect){this.effect.cancel();}Element.addClassName(this.element,this.options.hoverClassName);},leaveHover:function(){if(this.options.backgroundColor){this.element.style.backgroundColor=this.oldBackground;}Element.removeClassName(this.element,this.options.hoverClassName);if(this.saving){return;}this.effect=new Effect.Highlight(this.element,{startcolor:this.options.highlightcolor,endcolor:this.options.highlightendcolor,restorecolor:this.originalBackground});},leaveEditMode:function(){Element.removeClassName(this.element,this.options.savingClassName);this.removeForm();this.leaveHover();this.element.style.backgroundColor=this.originalBackground;Element.show(this.element);if(this.options.externalControl){Element.show(this.options.externalControl);}this.editing=false;this.saving=false;this.oldInnerHTML=null;this.onLeaveEditMode();},onComplete:function(_667){this.leaveEditMode();this.options.onComplete.bind(this)(_667,this.element);},onEnterEditMode:function(){},onLeaveEditMode:function(){},dispose:function(){if(this.oldInnerHTML){this.element.innerHTML=this.oldInnerHTML;}this.leaveEditMode();Event.stopObserving(this.element,"click",this.onclickListener);Event.stopObserving(this.element,"mouseover",this.mouseoverListener);Event.stopObserving(this.element,"mouseout",this.mouseoutListener);if(this.options.externalControl){Event.stopObserving(this.options.externalControl,"click",this.onclickListener);Event.stopObserving(this.options.externalControl,"mouseover",this.mouseoverListener);Event.stopObserving(this.options.externalControl,"mouseout",this.mouseoutListener);}}};Ajax.InPlaceCollectionEditor=Class.create();Object.extend(Ajax.InPlaceCollectionEditor.prototype,Ajax.InPlaceEditor.prototype);Object.extend(Ajax.InPlaceCollectionEditor.prototype,{createEditField:function(){if(!this.cached_selectTag){var _668=document.createElement("select");var _669=this.options.collection||[];var _66a;_669.each(function(e,i){_66a=document.createElement("option");_66a.value=(e instanceof Array)?e[0]:e;if((typeof this.options.value=="undefined")&&((e instanceof Array)?this.element.innerHTML==e[1]:e==_66a.value)){_66a.selected=true;}if(this.options.value==_66a.value){_66a.selected=true;}_66a.appendChild(document.createTextNode((e instanceof Array)?e[1]:e));_668.appendChild(_66a);}.bind(this));this.cached_selectTag=_668;}this.editField=this.cached_selectTag;if(this.options.loadTextURL){this.loadExternalText();}this.form.appendChild(this.editField);this.options.callback=function(form,_66e){return "value="+encodeURIComponent(_66e);};}});Form.Element.DelayedObserver=Class.create();Form.Element.DelayedObserver.prototype={initialize:function(_66f,_670,_671){this.delay=_670||0.5;this.element=$(_66f);this.callback=_671;this.timer=null;this.lastValue=$F(this.element);Event.observe(this.element,"keyup",this.delayedListener.bindAsEventListener(this));},delayedListener:function(_672){if(this.lastValue==$F(this.element)){return;}if(this.timer){clearTimeout(this.timer);}this.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1000);this.lastValue=$F(this.element);},onTimerEvent:function(){this.timer=null;this.callback(this.element,$F(this.element));}};function updateItem(list){list=$(list);var _674=list.getElementsByTagName("li");$(list.getAttribute("field")).value=$A(_674).map(getItemName).join(",");}function deleteItem(_675){var list=$(_675).parentNode;$(_675).remove();updateItem(list);}function getItemName(_677){return _677.getElementsByTagName("span")[0].childNodes[0].nodeValue;}function addItem(list,item){item=item.replace(/[^A-Za-z0-9 ]/g,"");if(item.length<1){return;}var _67a=$(list);var _67b=_67a.getElementsByTagName("li");for(var i=0;i<_67b.length;++i){if(getItemName(_67b[i])==item){return;}}var _67d=+list+"_"+"item_"+_67b.length;var li=Builder.node("li",{className:"removable_list_item"},[Builder.node("span",item+" ")]);var _67f=_67a.firstChild;while(_67f.nextSibling){_67f=_67f.nextSibling;}_67a.insertBefore(li,_67f);li.appendChild(Builder.node("span",{className:"command delete_button"},"[ - ]"));Behavior.applySelectedRule("li.removable_list_item .delete_button");updateItem(list);}var myrules={"li.removable_list_item .delete_button":function(_680){_680.onclick=function(){deleteItem(_680.parentNode);};}};Behavior.register(myrules);Array.prototype.indexOf=function(item){for(var i=0;i<this.length;i++){if(this[i]==item){return i;}}return -1;};Array.prototype.filter=function(test){var _684=[];for(var i=0;i<this.length;i++){if(test(this[i])){_684[_684.length]=this[i];}}return _684;};String.prototype.right=function(_686){if(_686>=this.length){return this;}else{return this.substr(this.length-_686,_686);}};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"");};var Class={create:function(){return function(){this.initialize.apply(this,arguments);};}};Object.extend=function(_687,_688){for(var _689 in _688){_687[_689]=_688[_689];}return _687;};var DateBocks=Class.create();DateBocks.VERSION="3.0.0";DateBocks.prototype={dateType:"iso",messageSpanSuffix:"Msg",messageSpanErrorClass:"error",messageSpanSuccessClass:"",dateBocksElementId:"",autoRollOver:true,calendarAlign:"Br",calendarIfFormat:null,calendarFormatString:null,"monthNames":["January","February","March","April","May","June","July","August","September","October","November","December"],"weekdayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dateParsePatterns:[{re:/^tod|now/i,handler:function(db,bits){return new Date();}},{re:/^tom/i,handler:function(db,bits){var d=new Date();d.setDate(d.getDate()+1);return d;}},{re:/^yes/i,handler:function(db,bits){var d=new Date();d.setDate(d.getDate()-1);return d;}},{re:/^(\d{1,2})(st|nd|rd|th)?$/i,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear();var dd=parseInt(bits[1],10);var mm=d.getMonth();if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/^(\d{1,2})(?:st|nd|rd|th)? (?:of\s)?(\w+)$/i,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear();var dd=parseInt(bits[1],10);var mm=db.parseMonth(bits[2]);if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/^(\d{1,2})(?:st|nd|rd|th)? (?:of )?(\w+),? (\d{4})$/i,handler:function(db,bits){var d=new Date();d.setDate(parseInt(bits[1],10));d.setMonth(db.parseMonth(bits[2]));d.setYear(bits[3]);return d;}},{re:/^(\w+) (\d{1,2})(?:st|nd|rd|th)?$/i,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear();var dd=parseInt(bits[2],10);var mm=db.parseMonth(bits[1]);if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/^(\w+) (\d{1,2})(?:st|nd|rd|th)?,? (\d{4})$/i,handler:function(db,bits){var yyyy=parseInt(bits[3],10);var dd=parseInt(bits[2],10);var mm=db.parseMonth(bits[1]);if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/((next|last)\s(week|month|year))/i,handler:function(db,bits){var _6ae=new Date();var dd=_6ae.getDate();var mm=_6ae.getMonth();var yyyy=_6ae.getFullYear();switch(bits[3]){case "week":var _6b2=(bits[2]=="next")?(dd+7):(dd-7);_6ae.setDate(_6b2);break;case "month":var _6b3=(bits[2]=="next")?(mm+1):(mm-1);_6ae.setMonth(_6b3);break;case "year":var _6b4=(bits[2]=="next")?(yyyy+1):(yyyy-1);_6ae.setYear(_6b4);break;}return _6ae;}},{re:/^(next|this)?\s?(\w+)$/i,handler:function(db,bits){var d=new Date();var day=d.getDay();var _6b9=db.parseWeekday(bits[2]);var _6ba=_6b9-day;if(_6b9<=day){_6ba+=7;}d.setDate(d.getDate()+_6ba);return d;}},{re:/^last (\w+)$/i,handler:function(db,bits){var d=new Date();var wd=d.getDay();var nwd=db.parseWeekday(bits[1]);var _6c0=(-1*(wd+7-nwd))%7;if(0==_6c0){_6c0=-7;}d.setDate(d.getDate()+_6c0);return d;}},{re:/(\d{1,2})\/(\d{1,2})\/(\d{4})/,handler:function(db,bits){if(db.dateType=="dd/mm/yyyy"){var yyyy=parseInt(bits[3],10);var dd=parseInt(bits[1],10);var mm=parseInt(bits[2],10)-1;}else{var yyyy=parseInt(bits[3],10);var dd=parseInt(bits[2],10);var mm=parseInt(bits[1],10)-1;}if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})\/(\d{1,2})\/(\d{1,2})/,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear()-(d.getFullYear()%100)+parseInt(bits[3],10);var dd=parseInt(bits[2],10);var mm=parseInt(bits[1],10)-1;if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})\/(\d{1,2})/,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear();var dd=parseInt(bits[2],10);var mm=parseInt(bits[1],10)-1;if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})-(\d{1,2})-(\d{4})/,handler:function(db,bits){if(db.dateType=="dd-mm-yyyy"){var yyyy=parseInt(bits[3],10);var dd=parseInt(bits[1],10);var mm=parseInt(bits[2],10)-1;}else{var yyyy=parseInt(bits[3],10);var dd=parseInt(bits[2],10);var mm=parseInt(bits[1],10)-1;}if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})\.(\d{1,2})\.(\d{4})/,handler:function(db,bits){var dd=parseInt(bits[1],10);var mm=parseInt(bits[2],10)-1;var yyyy=parseInt(bits[3],10);if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{4})-(\d{1,2})-(\d{1,2})/,handler:function(db,bits){var yyyy=parseInt(bits[1],10);var dd=parseInt(bits[3],10);var mm=parseInt(bits[2],10)-1;if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})-(\d{1,2})-(\d{1,2})/,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear()-(d.getFullYear()%100)+parseInt(bits[1],10);var dd=parseInt(bits[3],10);var mm=parseInt(bits[2],10)-1;if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})-(\d{1,2})/,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear();var dd=parseInt(bits[2],10);var mm=parseInt(bits[1],10)-1;if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}}],initialize:function(_6f3){Object.extend(this,_6f3);switch(this.dateType){case "mm/dd/yyyy":case "us":this.calendarIfFormat="%m/%d/%Y";this.calendarFormatString="mm/dd/yyyy";break;case "mm.dd.yyyy":case "de":this.calendarIfFormat="%m.%d.%Y";this.calendarFormatString="mm.dd.yyyy";break;case "dd/mm/yyyy":this.calendarIfFormat="%d/%m/%Y";this.calendarFormatString="dd/mm/yyyy";break;case "dd-mm-yyyy":this.calendarIfFormat="%d-%m-%Y";this.calendarFormatString="dd-mm-yyyy";break;case "yyyy-mm-dd":case "iso":case "default":default:this.calendarIfFormat="%Y-%m-%d";this.calendarFormatString="yyyy-mm-dd";break;}},parseMonth:function(_6f4){var _6f5=this.monthNames.filter(function(item){return new RegExp("^"+_6f4,"i").test(item);});if(_6f5.length==0){throw new Error("Invalid month string");}if(_6f5.length<1){throw new Error("Ambiguous month");}return this.monthNames.indexOf(_6f5[0]);},parseWeekday:function(_6f7){var _6f8=this.weekdayNames.filter(function(item){return new RegExp("^"+_6f7,"i").test(item);});if(_6f8.length==0){throw new Error("Invalid day string");}if(_6f8.length<1){throw new Error("Ambiguous weekday");}return this.weekdayNames.indexOf(_6f8[0]);},dateInRange:function(yyyy,mm,dd){if(mm<0||mm>11){throw new Error("Invalid month value.  Valid months values are 1 to 12");}if(!this.autoRollOver){var d=(11==mm)?new Date(yyyy+1,0,0):new Date(yyyy,mm+1,0);if(dd<1||dd>d.getDate()){throw new Error("Invalid date value.  Valid date values for "+this.monthNames[mm]+" are 1 to "+d.getDate().toString());}}return true;},getDateObj:function(yyyy,mm,dd){var obj=new Date();obj.setDate(1);obj.setYear(yyyy);obj.setMonth(mm);obj.setDate(dd);return obj;},parseDateString:function(s){var _703=this.dateParsePatterns;for(var i=0;i<_703.length;i++){var re=_703[i].re;var _706=_703[i].handler;var bits=re.exec(s);if(bits){return _706(this,bits);}}throw new Error("Invalid date string");},zeroPad:function(_708){if(_708<10){return "0"+_708;}else{return _708;}},magicDate:function(){var _709=document.getElementById(this.dateBocksElementId);var _70a=document.getElementById(_709.id+this.messageSpanSuffix);try{var num=_709.id.replace("deadline_","");if(!_709.value){console.log("OO");if(num!=_709.id){return changeField(num,"deadline");}}var d=this.parseDateString(_709.value);var day=this.zeroPad(d.getDate());var _70e=this.zeroPad(d.getMonth()+1);var year=d.getFullYear();switch(this.dateType){case "dd/mm/yyyy":_709.value=day+"/"+_70e+"/"+year;break;case "dd-mm-yyyy":_709.value=day+"-"+_70e+"-"+year;break;case "mm/dd/yyyy":case "us":_709.value=_70e+"/"+day+"/"+year;break;case "mm.dd.yyyy":case "de":_709.value=_70e+"."+day+"."+year;break;case "default":case "iso":case "yyyy-mm-dd":default:_709.value=year+"-"+_70e+"-"+day;break;}_709.className="";if(_70a){_70a.innerHTML=d.toDateString();_70a.className=this.messageSpanSuccessClass;}if(num!=_709.id){changeField(num,"deadline");}}catch(e){if(_70a){var _710=e.message;if(_710.indexOf("is null or not an object")>-1){_710="Invalid date string";}_70a.innerHTML=_710;_70a.className=this.messageSpanErrorClass;}}},trim:function(_711){return _711.replace(/^\s+|\s+$/,"");},keyObserver:function(_712,_713){var _714=_712.keyCode?_712.keyCode:((_712.which)?_712.which:_712.charCode);if(_714==13||_714==10){switch(_713){case "parse":this.magicDate();break;case "return":case "false":default:return false;break;}}},setDefaultFormatMessage:function(){document.getElementById(this.dateBocksElementId+"Msg").innerHTML=this.calendarFormatString;}};Calendar=function(_715,_716,_717,_718){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=_717||null;this.onClose=_718||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof _715=="number"?_715:Calendar._FD;this.showsOtherMonths=false;this.dateStr=_716;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3;}var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len);}Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3;}ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len);}Calendar._SMN=ar;}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(el){var SL=0,ST=0;var _71e=/^div$/i.test(el.tagName);if(_71e&&el.scrollLeft){SL=el.scrollLeft;}if(_71e&&el.scrollTop){ST=el.scrollTop;}var r={x:el.offsetLeft-SL,y:el.offsetTop-ST};if(el.offsetParent){var tmp=this.getAbsolutePos(el.offsetParent);r.x+=tmp.x;r.y+=tmp.y;}return r;};Calendar.isRelated=function(el,evt){var _723=evt.relatedTarget;if(!_723){var type=evt.type;if(type=="mouseover"){_723=evt.fromElement;}else{if(type=="mouseout"){_723=evt.toElement;}}}while(_723){if(_723==el){return true;}_723=_723.parentNode;}return false;};Calendar.removeClass=function(el,_726){if(!(el&&el.className)){return;}var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=_726){ar[ar.length]=cls[i];}}el.className=ar.join(" ");};Calendar.addClass=function(el,_72b){Calendar.removeClass(el,_72b);el.className+=" "+_72b;};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName)){f=f.parentNode;}return f;};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1){f=f.parentNode;}return f;};Calendar.stopEvent=function(ev){ev||(ev=window.event);if(Calendar.is_ie){ev.cancelBubble=true;ev.returnValue=false;}else{ev.preventDefault();ev.stopPropagation();}return false;};Calendar.addEvent=function(el,_732,func){if(el.attachEvent){el.attachEvent("on"+_732,func);}else{if(el.addEventListener){el.addEventListener(_732,func,true);}else{el["on"+_732]=func;}}};Calendar.removeEvent=function(el,_735,func){if(el.detachEvent){el.detachEvent("on"+_735,func);}else{if(el.removeEventListener){el.removeEventListener(_735,func,true);}else{el["on"+_735]=null;}}};Calendar.createElement=function(type,_738){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",type);}else{el=document.createElement(type);}if(typeof _738!="undefined"){_738.appendChild(el);}return el;};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true);}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el;}else{if(typeof el.parentNode.month!="undefined"){return el.parentNode;}}return null;};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el;}else{if(typeof el.parentNode.year!="undefined"){return el.parentNode;}}return null;};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false;}var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active");}var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px";}else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined"){mcw=50;}s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px";}s.top=(cd.offsetTop+cd.offsetHeight)+"px";};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false;}var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active");}cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var show=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";show=true;}else{yr.style.display="none";}yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep;}if(show){var s=yc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px";}else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined"){ycw=50;}s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px";}s.top=(cd.offsetTop+cd.offsetHeight)+"px";}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false;}if(cal.timeout){clearTimeout(cal.timeout);}var el=cal.activeDiv;if(!el){return false;}var _752=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(_752==el||_752.parentNode==el){Calendar.cellClick(el,ev);}var mon=Calendar.findMonth(_752);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler();}}else{var year=Calendar.findYear(_752);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler();}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev);}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return;}var el=cal.activeDiv;var _759=Calendar.getTargetElement(ev);if(_759==el||_759.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite");}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2))){Calendar.removeClass(el,"active");}Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite");}ev||(ev=window.event);if(el.navtype==50&&_759!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var _75e=true;if(x>pos.x+w){dx=x-pos.x-w;_75e=false;}else{dx=pos.x-x;}if(dx<0){dx=0;}var _75f=el._range;var _760=el._current;var _761=Math.floor(dx/10)%_75f.length;for(var i=_75f.length;--i>=0;){if(_75f[i]==_760){break;}}while(_761-->0){if(_75e){if(--i<0){i=_75f.length-1;}}else{if(++i>=_75f.length){i=0;}}}var _763=_75f[i];el.innerHTML=_763;cal.onUpdateTime();}var mon=Calendar.findMonth(_759);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon;}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}var year=Calendar.findYear(_759);if(year){if(year.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}Calendar.addClass(year,"hilite");cal.hilitedYear=year;}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}}}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}}}return Calendar.stopEvent(ev);};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev);}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false;}var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft;}else{posX=ev.pageX;posY=ev.pageY;}cal.hideShowCovered();var st=cal.element.style;st.left=(posX-cal.xOffs)+"px";st.top=(posY-cal.yOffs)+"px";return Calendar.stopEvent(ev);};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false;}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev);}cal.hideShowCovered();};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false;}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver);}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver);}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp);}}else{if(cal.isPopup){cal._dragStart(ev);}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout);}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250);}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout);}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250);}else{cal.timeout=null;}}return Calendar.stopEvent(ev);};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty();}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false;}if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1);}el.calendar.tooltips.innerHTML=el.ttip;}if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite");}}return Calendar.stopEvent(ev);};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false;}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite");}if(el.calendar){el.calendar.tooltips.innerHTML=_TT["SEL_DATE"];}return stopEvent(ev);}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var _779=false;var _77a=false;var date=null;if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");_779=(cal.currentDateEl==el);if(!_779){cal.currentDateEl=el;}}cal.date.setDateOnly(el.caldate);date=cal.date;var _77c=!(cal.dateClicked=!el.otherMonth);if(!_77c&&!cal.currentDateEl){cal._toggleMultipleDate(new Date(date));}else{_77a=!el.disabled;}if(_77c){cal._init(cal.firstDayOfWeek,date);}}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return;}date=new Date(cal.date);if(el.navtype==0){date.setDateOnly(new Date());}cal.dateClicked=false;var year=date.getFullYear();var mon=date.getMonth();function setMonth(m){var day=date.getDate();var max=date.getMonthDays(m);if(day>max){date.setDate(max);}date.setMonth(m);}switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var text=Calendar._TT["ABOUT"];if(typeof text!="undefined"){text+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:"";}else{text="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+"the corresponding file in \"lang\" subdir to match calendar-en.js\n"+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n";}alert(text);return;case -2:if(year>cal.minYear){date.setFullYear(year-1);}break;case -1:if(mon>0){setMonth(mon-1);}else{if(year-->cal.minYear){date.setFullYear(year);setMonth(11);}}break;case 1:if(mon<11){setMonth(mon+1);}else{if(year<cal.maxYear){date.setFullYear(year+1);setMonth(0);}}break;case 2:if(year<cal.maxYear){date.setFullYear(year+1);}break;case 100:cal.setFirstDayOfWeek(el.fdow);return;case 50:var _783=el._range;var _784=el.innerHTML;for(var i=_783.length;--i>=0;){if(_783[i]==_784){break;}}if(ev&&ev.shiftKey){if(--i<0){i=_783.length-1;}}else{if(++i>=_783.length){i=0;}}var _786=_783[i];el.innerHTML=_786;cal.onUpdateTime();return;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(date,date.getFullYear(),date.getMonth(),date.getDate())){return false;}break;}if(!date.equalsTo(cal.date)){cal.setDate(date);_77a=true;}else{if(el.navtype==0){_77a=_779=true;}}}if(_77a){ev&&cal.callHandler();}if(_779){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler();}};Calendar.prototype.create=function(_par){var _788=null;if(!_par){_788=document.getElementsByTagName("body")[0];this.isPopup=true;}else{_788=_par;this.isPopup=false;}this.date=this.dateStr?new Date(this.dateStr):new Date();var _789=Calendar.createElement("table");this.table=_789;_789.cellSpacing=0;_789.cellPadding=0;_789.calendar=this;Calendar.addEvent(_789,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none";}div.appendChild(_789);var _78b=Calendar.createElement("thead",_789);var cell=null;var row=null;var cal=this;var hh=function(text,cs,_792){cell=Calendar.createElement("td",row);cell.colSpan=cs;cell.className="button";if(_792!=0&&Math.abs(_792)<=2){cell.className+=" nav";}Calendar._add_evs(cell);cell.calendar=cal;cell.navtype=_792;cell.innerHTML="<div unselectable='on'>"+text+"</div>";return cell;};row=Calendar.createElement("tr",_78b);var _793=6;(this.isPopup)&&--_793;(this.weekNumbers)&&++_793;hh("?",1,400).ttip=Calendar._TT["INFO"];this.title=hh("",_793,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";hh("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"];}row=Calendar.createElement("tr",_78b);row.className="headrow";this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];row=Calendar.createElement("tr",_78b);row.className="daynames";if(this.weekNumbers){cell=Calendar.createElement("td",row);cell.className="name wn";cell.innerHTML=Calendar._TT["WK"];}for(var i=7;i>0;--i){cell=Calendar.createElement("td",row);if(!i){cell.navtype=100;cell.calendar=this;Calendar._add_evs(cell);}}this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var _795=Calendar.createElement("tbody",_789);this.tbody=_795;for(i=6;i>0;--i){row=Calendar.createElement("tr",_795);if(this.weekNumbers){cell=Calendar.createElement("td",row);}for(var j=7;j>0;--j){cell=Calendar.createElement("td",row);cell.calendar=this;Calendar._add_evs(cell);}}if(this.showsTime){row=Calendar.createElement("tr",_795);row.className="time";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;cell.innerHTML=Calendar._TT["TIME"]||"&nbsp;";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(_797,init,_799,_79a){var part=Calendar.createElement("span",cell);part.className=_797;part.innerHTML=init;part.calendar=cal;part.ttip=Calendar._TT["TIME_PART"];part.navtype=50;part._range=[];if(typeof _799!="number"){part._range=_799;}else{for(var i=_799;i<=_79a;++i){var txt;if(i<10&&_79a>=10){txt="0"+i;}else{txt=""+i;}part._range[part._range.length]=txt;}}Calendar._add_evs(part);return part;}var hrs=cal.date.getHours();var mins=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm){hrs-=12;}var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var span=Calendar.createElement("span",cell);span.innerHTML=":";span.className="colon";var M=makeTimePart("minute",mins,0,59);var AP=null;cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;if(t12){AP=makeTimePart("ampm",pm?"pm":"am",["am","pm"]);}else{cell.innerHTML="&nbsp;";}cal.onSetTime=function(){var pm,hrs=this.date.getHours(),mins=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm){hrs-=12;}if(hrs==0){hrs=12;}AP.innerHTML=pm?"pm":"am";}H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(mins<10)?("0"+mins):mins;};cal.onUpdateTime=function(){var date=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(/pm/i.test(AP.innerHTML)&&h<12){h+=12;}else{if(/am/i.test(AP.innerHTML)&&h==12){h=0;}}}var d=date.getDate();var m=date.getMonth();var y=date.getFullYear();date.setHours(h);date.setMinutes(parseInt(M.innerHTML,10));date.setFullYear(y);date.setMonth(m);date.setDate(d);this.dateClicked=false;this.callHandler();};})();}else{this.onSetTime=this.onUpdateTime=function(){};}var _7ac=Calendar.createElement("tfoot",_789);row=Calendar.createElement("tr",_7ac);row.className="footrow";cell=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);cell.className="ttip";if(this.isPopup){cell.ttip=Calendar._TT["DRAG_TO_MOVE"];cell.style.cursor="move";}this.tooltips=cell;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn);}div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr);}this._init(this.firstDayOfWeek,this.date);_788.appendChild(this.element);};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false;}(Calendar.is_ie)&&(ev=window.event);var act=(Calendar.is_ie||ev.type=="keypress"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break;default:return false;}}else{switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 27:act&&cal.callCloseHandler();break;case 37:case 38:case 39:case 40:if(act){var prev,x,y,ne,el,step;prev=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x];}setVars();function prevMonth(){var date=new Date(cal.date);date.setDate(date.getDate()-step);cal.setDate(date);}function nextMonth(){var date=new Date(cal.date);date.setDate(date.getDate()+step);cal.setDate(date);}while(1){switch(K){case 37:if(--x>=0){ne=cal.ar_days[y][x];}else{x=6;K=38;continue;}break;case 38:if(--y>=0){ne=cal.ar_days[y][x];}else{prevMonth();setVars();}break;case 39:if(++x<7){ne=cal.ar_days[y][x];}else{x=0;K=40;continue;}break;case 40:if(++y<cal.ar_days.length){ne=cal.ar_days[y][x];}else{nextMonth();setVars();}break;}break;}if(ne){if(!ne.disabled){Calendar.cellClick(ne);}else{if(prev){prevMonth();}else{nextMonth();}}}}break;case 13:if(act){Calendar.cellClick(cal.currentDateEl,ev);}break;default:return false;}}return Calendar.stopEvent(ev);};Calendar.prototype._init=function(_7b6,date){var _7b8=new Date(),TY=_7b8.getFullYear(),TM=_7b8.getMonth(),TD=_7b8.getDate();this.table.style.visibility="hidden";var year=date.getFullYear();if(year<this.minYear){year=this.minYear;date.setFullYear(year);}else{if(year>this.maxYear){year=this.maxYear;date.setFullYear(year);}}this.firstDayOfWeek=_7b6;this.date=new Date(date);var _7ba=date.getMonth();var mday=date.getDate();var _7bc=date.getMonthDays();date.setDate(1);var day1=(date.getDay()-this.firstDayOfWeek)%7;if(day1<0){day1+=7;}date.setDate(-day1);date.setDate(date.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[_7ba];var _7c0=this.ar_days=new Array();var _7c1=Calendar._TT["WEEKEND"];var _7c2=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var cell=row.firstChild;if(this.weekNumbers){cell.className="day wn";cell.innerHTML=date.getWeekNumber();cell=cell.nextSibling;}row.className="daysrow";var _7c5=false,iday,dpos=_7c0[i]=[];for(var j=0;j<7;++j,cell=cell.nextSibling,date.setDate(iday+1)){iday=date.getDate();var wday=date.getDay();cell.className="day";cell.pos=i<<4|j;dpos[j]=cell;var _7c8=(date.getMonth()==_7ba);if(!_7c8){if(this.showsOtherMonths){cell.className+=" othermonth";cell.otherMonth=true;}else{cell.className="emptycell";cell.innerHTML="&nbsp;";cell.disabled=true;continue;}}else{cell.otherMonth=false;_7c5=true;}cell.disabled=false;cell.innerHTML=this.getDateText?this.getDateText(date,iday):iday;if(_7c2){_7c2[date.print("%Y%m%d")]=cell;}if(this.getDateStatus){var _7c9=this.getDateStatus(date,year,_7ba,iday);if(this.getDateToolTip){var _7ca=this.getDateToolTip(date,year,_7ba,iday);if(_7ca){cell.title=_7ca;}}if(_7c9===true){cell.className+=" disabled";cell.disabled=true;}else{if(/disabled/i.test(_7c9)){cell.disabled=true;}cell.className+=" "+_7c9;}}if(!cell.disabled){cell.caldate=new Date(date);cell.ttip="_";if(!this.multiple&&_7c8&&iday==mday&&this.hiliteToday){cell.className+=" selected";this.currentDateEl=cell;}if(date.getFullYear()==TY&&date.getMonth()==TM&&iday==TD){cell.className+=" today";cell.ttip+=Calendar._TT["PART_TODAY"];}if(_7c1.indexOf(wday.toString())!=-1){cell.className+=cell.otherMonth?" oweekend":" weekend";}}}if(!(_7c5||this.showsOtherMonths)){row.className="emptyrow";}}this.title.innerHTML=Calendar._MN[_7ba]+", "+year;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates();};Calendar.prototype._initMultipleDates=function(){if(this.multiple){if(Prototype){this.muliple.each(function(_7cb){var cell=this.datesCells[_7cb.key];var d=_7cb.value;if(!d){return;}if(cell){cell.className+=" selected";}});}else{for(var i in this.multiple){var cell=this.datesCells[i];var d=this.multiple[i];if(!d){continue;}if(cell){cell.className+=" selected";}}}}};Calendar.prototype._toggleMultipleDate=function(date){if(this.multiple){var ds=date.print("%Y%m%d");var cell=this.datesCells[ds];if(cell){var d=this.multiple[ds];if(!d){Calendar.addClass(cell,"selected");this.multiple[ds]=date;}else{Calendar.removeClass(cell,"selected");delete this.multiple[ds];}}}};Calendar.prototype.setDateToolTipHandler=function(_7d5){this.getDateToolTip=_7d5;};Calendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this._init(this.firstDayOfWeek,date);}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date);};Calendar.prototype.setFirstDayOfWeek=function(_7d7){this._init(_7d7,this.date);this._displayWeekdays();};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(_7d8){this.getDateStatus=_7d8;};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z;};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat));}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this);}this.hideShowCovered();};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null;};Calendar.prototype.reparent=function(_7dc){var el=this.element;el.parentNode.removeChild(el);_7dc.appendChild(el);};Calendar._checkCalendar=function(ev){var _7df=window._dynarch_popupCalendar;if(!_7df){return false;}var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=_7df.element;el=el.parentNode){}if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev);}};Calendar.prototype.show=function(){var rows=this.table.getElementsByTagName("tr");for(var i=rows.length;i>0;){var row=rows[--i];Calendar.removeClass(row,"rowhilite");var _7e4=row.getElementsByTagName("td");for(var j=_7e4.length;j>0;){var cell=_7e4[--j];Calendar.removeClass(cell,"hilite");Calendar.removeClass(cell,"active");}}this.element.style.display="block";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar);}this.hideShowCovered();};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar);}this.element.style.display="none";this.hidden=true;this.hideShowCovered();};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show();};Calendar.prototype.showAtElement=function(el,opts){var self=this;var p=Calendar.getAbsolutePos(el);if(!opts||typeof opts!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true;}function fixPosition(box){if(box.x<0){box.x=0;}if(box.y<0){box.y=0;}var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);if(Calendar.is_ie){br.y+=document.body.scrollTop;br.x+=document.body.scrollLeft;}else{br.y+=window.scrollY;br.x+=window.scrollX;}var tmp=box.x+box.width-br.x;if(tmp>0){box.x-=tmp;}tmp=box.y+box.height-br.y;if(tmp>0){box.y-=tmp;}}this.element.style.display="block";Calendar.continuation_for_the_fucking_khtml_browser=function(){var w=self.element.offsetWidth;var h=self.element.offsetHeight;self.element.style.display="none";var _7f5=opts.substr(0,1);var _7f6="l";if(opts.length>1){_7f6=opts.substr(1,1);}switch(_7f5){case "T":p.y-=h;break;case "B":p.y+=el.offsetHeight;break;case "C":p.y+=(el.offsetHeight-h)/2;break;case "t":p.y+=el.offsetHeight-h;break;case "b":break;}switch(_7f6){case "L":p.x-=w;break;case "R":p.x+=el.offsetWidth;break;case "C":p.x+=(el.offsetWidth-w)/2;break;case "l":p.x+=el.offsetWidth-w;break;case "r":break;}p.width=w;p.height=h+40;self.monthsCombo.style.display="none";fixPosition(p);self.showAt(p.x,p.y);};if(Calendar.is_khtml){setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10);}else{Calendar.continuation_for_the_fucking_khtml_browser();}};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str;};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str;};Calendar.prototype.parseDate=function(str,fmt){if(!fmt){fmt=this.dateFormat;}this.setDate(Date.parseDate(str,fmt));};Calendar.prototype.hideShowCovered=function(){if(!Calendar.is_ie&&!Calendar.is_opera){return;}function getVisib(obj){var _7fc=obj.style.visibility;if(!_7fc){if(document.defaultView&&typeof (document.defaultView.getComputedStyle)=="function"){if(!Calendar.is_khtml){_7fc=document.defaultView.getComputedStyle(obj,"").getPropertyValue("visibility");}else{_7fc="";}}else{if(obj.currentStyle){_7fc=obj.currentStyle.visibility;}else{_7fc="";}}}return _7fc;}var tags=new Array("applet","iframe","select");var el=this.element;var p=Calendar.getAbsolutePos(el);var EX1=p.x;var EX2=el.offsetWidth+EX1;var EY1=p.y;var EY2=el.offsetHeight+EY1;for(var k=tags.length;k>0;){var ar=document.getElementsByTagName(tags[--k]);var cc=null;for(var i=ar.length;i>0;){cc=ar[--i];p=Calendar.getAbsolutePos(cc);var CX1=p.x;var CX2=cc.offsetWidth+CX1;var CY1=p.y;var CY2=cc.offsetHeight+CY1;if(this.hidden||(CX1>EX2)||(CX2<EX1)||(CY1>EY2)||(CY2<EY1)){if(!cc.__msh_save_visibility){cc.__msh_save_visibility=getVisib(cc);}cc.style.visibility=cc.__msh_save_visibility;}else{if(!cc.__msh_save_visibility){cc.__msh_save_visibility=getVisib(cc);}cc.style.visibility="hidden";}}}};Calendar.prototype._displayWeekdays=function(){var fdow=this.firstDayOfWeek;var cell=this.firstdayname;var _80e=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){cell.className="day name";var _810=(i+fdow)%7;if(i){cell.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[_810]);cell.navtype=100;cell.calendar=this;cell.fdow=_810;Calendar._add_evs(cell);}if(_80e.indexOf(_810.toString())!=-1){Calendar.addClass(cell,"weekend");}cell.innerHTML=Calendar._SDN[(i+fdow)%7];cell=cell.nextSibling;}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none";};Calendar.prototype._dragStart=function(ev){if(this.dragging){return;}this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft;}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX;}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd);}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.parseDate=function(str,fmt){var _817=new Date();var y=0;var m=-1;var d=0;var a=str.split(/\W+/);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i]){continue;}switch(b[i]){case "%d":case "%e":d=parseInt(a[i],10);break;case "%m":m=parseInt(a[i],10)-1;break;case "%Y":case "%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case "%b":case "%B":for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){m=j;break;}}break;case "%H":case "%I":case "%k":case "%l":hr=parseInt(a[i],10);break;case "%P":case "%p":if(/pm/i.test(a[i])&&hr<12){hr+=12;}else{if(/am/i.test(a[i])&&hr>=12){hr-=12;}}break;case "%M":min=parseInt(a[i],10);break;}}if(isNaN(y)){y=_817.getFullYear();}if(isNaN(m)){m=_817.getMonth();}if(isNaN(d)){d=_817.getDate();}if(isNaN(hr)){hr=_817.getHours();}if(isNaN(min)){min=_817.getMinutes();}if(y!=0&&m!=-1&&d!=0){return new Date(y,m,d,hr,min,0);}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break;}}if(t!=-1){if(m!=-1){d=m+1;}m=t;}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1;}else{if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);}else{if(d==0){d=a[i];}}}}}if(y==0){y=_817.getFullYear();}if(m!=-1&&d!=0){return new Date(y,m,d,hr,min,0);}return _817;};Date.prototype.getMonthDays=function(_821){var year=this.getFullYear();if(typeof _821=="undefined"){_821=this.getMonth();}if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&_821==1){return 29;}else{return Date._MD[_821];}};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var then=new Date(this.getFullYear(),0,0,0,0,0);var time=now-then;return Math.floor(time/Date.DAY);};Date.prototype.getWeekNumber=function(){var d=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var DoW=d.getDay();d.setDate(d.getDate()-(DoW+6)%7+3);var ms=d.valueOf();d.setMonth(0);d.setDate(4);return Math.round((ms-d.valueOf())/(7*86400000))+1;};Date.prototype.equalsTo=function(date){return ((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()));};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate());};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0){ir=12;}var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?"PM":"AM";s["%P"]=pm?"pm":"am";s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(""+y).substr(2,2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return str.replace(re,function(par){return s[par]||par;});}var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],"g");str=str.replace(re,tmp);}}return str;};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth()){this.setDate(28);}this.__msh_oldSetFullYear(y);};window._dynarch_popupCalendar=null;Calendar.setup=function(_840){function param_default(_841,def){if(typeof _840[_841]=="undefined"){_840[_841]=def;}}param_default("inputField",null);param_default("displayArea",null);param_default("button",null);param_default("help",null);param_default("eventName","click");param_default("ifFormat","%Y/%m/%d");param_default("daFormat","%Y/%m/%d");param_default("singleClick",true);param_default("disableFunc",null);param_default("dateStatusFunc",_840["disableFunc"]);param_default("dateText",null);param_default("firstDay",null);param_default("align","Br");param_default("range",[1900,2999]);param_default("weekNumbers",true);param_default("flat",null);param_default("flatCallback",null);param_default("onSelect",null);param_default("onClose",null);param_default("onUpdate",null);param_default("date",null);param_default("showsTime",false);param_default("timeFormat","24");param_default("electric",true);param_default("step",2);param_default("position",null);param_default("cache",false);param_default("showOthers",false);param_default("multiple",null);var tmp=["inputField","displayArea","button","help"];for(var i=0;i<tmp.length;i++){if(typeof _840[tmp[i]]=="string"){_840[tmp[i]]=document.getElementById(_840[tmp[i]]);}}if(!(_840.flat||_840.multiple||_840.inputField||_840.displayArea||_840.button)){alert("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false;}function onSelect(cal){var p=cal.params;var _847=(cal.dateClicked||p.electric);if(_847&&p.inputField){p.inputField.value=cal.date.print(p.ifFormat);if(typeof p.inputField.onchange=="function"){p.inputField.onchange();}}if(_847&&p.displayArea){p.displayArea.innerHTML=cal.date.print(p.daFormat);}if(_847&&typeof p.onUpdate=="function"){p.onUpdate(cal);}if(_847&&p.flat){if(typeof p.flatCallback=="function"){p.flatCallback(cal);}}if(_847&&p.singleClick&&cal.dateClicked){cal.callCloseHandler();}}if(_840.flat!=null){if(typeof _840.flat=="string"){_840.flat=document.getElementById(_840.flat);}if(!_840.flat){alert("Calendar.setup:\n  Flat specified but can't find parent.");return false;}var cal=new Calendar(_840.firstDay,_840.date,_840.onSelect||onSelect);cal.showsOtherMonths=_840.showOthers;cal.showsTime=_840.showsTime;cal.time24=(_840.timeFormat=="24");cal.params=_840;cal.weekNumbers=_840.weekNumbers;cal.setRange(_840.range[0],_840.range[1]);cal.setDateStatusHandler(_840.dateStatusFunc);cal.getDateText=_840.dateText;if(_840.ifFormat){cal.setDateFormat(_840.ifFormat);}if(_840.inputField&&typeof _840.inputField.value=="string"){cal.parseDate(_840.inputField.value);}cal.create(_840.flat);cal.show();return false;}var _849=_840.help;_849["on"+_840.eventName]=function(){DateBocks.windowOpenCenter("/calendar-help.html","dateBocksHelp","width=500,height=430,autocenter=true");};var _84a=_840.button||_840.displayArea||_840.inputField;_84a["on"+_840.eventName]=function(){var _84b=_840.inputField||_840.displayArea;var _84c=_840.inputField?_840.ifFormat:_840.daFormat;var _84d=false;var cal=window.calendar;if(_84b){_840.date=Date.parseDate(_84b.value||_84b.innerHTML,_84c);}if(!(cal&&_840.cache)){window.calendar=cal=new Calendar(_840.firstDay,_840.date,_840.onSelect||onSelect,_840.onClose||function(cal){cal.hide();});cal.showsTime=_840.showsTime;cal.time24=(_840.timeFormat=="24");cal.weekNumbers=_840.weekNumbers;_84d=true;}else{if(_840.date){cal.setDate(_840.date);}cal.hide();}if(_840.multiple){cal.multiple={};for(var i=_840.multiple.length;--i>=0;){var d=_840.multiple[i];var ds=d.print("%Y%m%d");cal.multiple[ds]=d;}}cal.showsOtherMonths=_840.showOthers;cal.yearStep=_840.step;cal.setRange(_840.range[0],_840.range[1]);cal.params=_840;cal.setDateStatusHandler(_840.dateStatusFunc);cal.getDateText=_840.dateText;cal.setDateFormat(_84c);if(_84d){cal.create();}cal.refresh();if(!_840.position){cal.showAtElement(_840.button||_840.displayArea||_840.inputField,_840.align);}else{cal.showAt(_840.position[0],_840.position[1]);}return false;};return cal;};Calendar._DN=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");Calendar._SDN=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun");Calendar._FD=0;Calendar._MN=new Array("January","February","March","April","May","June","July","August","September","October","November","December");Calendar._SMN=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");Calendar._TT={};Calendar._TT["INFO"]="About the calendar";Calendar._TT["ABOUT"]="DHTML Date/Time Selector\n"+"(c) dynarch.com 2002-2005 / Author: Mihai Bazon\n"+"For latest version visit: http://www.dynarch.com/projects/calendar/\n"+"Distributed under GNU LGPL.  See http://gnu.org/licenses/lgpl.html for details."+"\n\n"+"Date selection:\n"+"- Use the \xab, \xbb buttons to select year\n"+"- Use the "+String.fromCharCode(8249)+", "+String.fromCharCode(8250)+" buttons to select month\n"+"- Hold mouse button on any of the above buttons for faster selection.";Calendar._TT["ABOUT_TIME"]="\n\n"+"Time selection:\n"+"- Click on any of the time parts to increase it\n"+"- or Shift-click to decrease it\n"+"- or click and drag for faster selection.";Calendar._TT["PREV_YEAR"]="Prev. year (hold for menu)";Calendar._TT["PREV_MONTH"]="Prev. month (hold for menu)";Calendar._TT["GO_TODAY"]="Go Today";Calendar._TT["NEXT_MONTH"]="Next month (hold for menu)";Calendar._TT["NEXT_YEAR"]="Next year (hold for menu)";Calendar._TT["SEL_DATE"]="Select date";Calendar._TT["DRAG_TO_MOVE"]="Drag to move";Calendar._TT["PART_TODAY"]=" (today)";Calendar._TT["DAY_FIRST"]="Display %s first";Calendar._TT["WEEKEND"]="0,6";Calendar._TT["CLOSE"]="Close";Calendar._TT["TODAY"]="Today";Calendar._TT["TIME_PART"]="(Shift-)Click or drag to change value";Calendar._TT["DEF_DATE_FORMAT"]="%Y-%m-%d";Calendar._TT["TT_DATE_FORMAT"]="%a, %b %e";Calendar._TT["WK"]="wk";Calendar._TT["TIME"]="Time:";DateBocks.windowProperties=function(_853){var _854=new RegExp("");_854.compile("(?:^|,)([^=]+)=(\\d+|yes|no|auto)","gim");var _855=new Object();var _856;while((_856=_854.exec(_853))!=null){var _857=_856[2];if(_857==("yes"||"1")){_855[_856[1]]=true;}else{if((!isNaN(_857)&&_857!=0)||("auto"==_857)){_855[_856[1]]=_857;}}}return _855;};DateBocks.windowOpenCenter=function(url,name,_85a){try{var _85b=DateBocks.windowProperties(_85a);w=parseInt(_85b["width"]);h=parseInt(_85b["height"]);w=w>0?w:640;h=h>0?h:480;if(screen){t=(screen.height-h)/2;l=(screen.width-w)/2;}else{t=250;l=250;}_85a=(w>0?",width="+w:"")+(h>0?",height="+h:"")+(t>0?",top="+t:"")+(l>0?",left="+l:"")+","+_85a.replace(/,(width=\s*\d+\s*|height=\s*\d+\s*|top=\s*\d+\s*||left=\s*\d+\s*)/gi,"");return window.open(url,name,_85a);}catch(e){}};
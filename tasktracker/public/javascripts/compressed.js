var Prototype={Version:"1.5.0_rc1",ScriptFragment:"(?:<script.*?>)((\n|\r|.)*?)(?:</script>)",emptyFunction:function(){},K:function(x){return x;}};var Class={create:function(){return function(){this.initialize.apply(this,arguments);};}};var Abstract=new Object();Object.extend=function(_2,_3){for(var _4 in _3){_2[_4]=_3[_4];}return _2;};Object.extend(Object,{inspect:function(_5){try{if(_5==undefined){return "undefined";}if(_5==null){return "null";}return _5.inspect?_5.inspect():_5.toString();}catch(e){if(e instanceof RangeError){return "...";}throw e;}},keys:function(_6){var _7=[];for(var _8 in _6){_7.push(_8);}return _7;},values:function(_9){var _a=[];for(var _b in _9){_a.push(_9[_b]);}return _a;},clone:function(_c){return Object.extend({},_c);}});Function.prototype.bind=function(){var _d=this,args=$A(arguments),object=args.shift();return function(){return _d.apply(object,args.concat($A(arguments)));};};Function.prototype.bindAsEventListener=function(_e){var _f=this,args=$A(arguments),_e=args.shift();return function(_10){return _f.apply(_e,[(_10||window.event)].concat(args).concat($A(arguments)));};};Object.extend(Number.prototype,{toColorPart:function(){var _11=this.toString(16);if(this<16){return "0"+_11;}return _11;},succ:function(){return this+1;},times:function(_12){$R(0,this,true).each(_12);return this;}});var Try={these:function(){var _13;for(var i=0;i<arguments.length;i++){var _15=arguments[i];try{_13=_15();break;}catch(e){}}return _13;}};var PeriodicalExecuter=Class.create();PeriodicalExecuter.prototype={initialize:function(_16,_17){this.callback=_16;this.frequency=_17;this.currentlyExecuting=false;this.registerCallback();},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000);},stop:function(){if(!this.timer){return;}clearInterval(this.timer);this.timer=null;},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.callback(this);}finally{this.currentlyExecuting=false;}}}};Object.extend(String.prototype,{gsub:function(_18,_19){var _1a="",source=this,match;_19=arguments.callee.prepareReplacement(_19);while(source.length>0){if(match=source.match(_18)){_1a+=source.slice(0,match.index);_1a+=(_19(match)||"").toString();source=source.slice(match.index+match[0].length);}else{_1a+=source,source="";}}return _1a;},sub:function(_1b,_1c,_1d){_1c=this.gsub.prepareReplacement(_1c);_1d=_1d===undefined?1:_1d;return this.gsub(_1b,function(_1e){if(--_1d<0){return _1e[0];}return _1c(_1e);});},scan:function(_1f,_20){this.gsub(_1f,_20);return this;},truncate:function(_21,_22){_21=_21||30;_22=_22===undefined?"...":_22;return this.length>_21?this.slice(0,_21-_22.length)+_22:this;},strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"");},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"");},stripScripts:function(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"");},extractScripts:function(){var _23=new RegExp(Prototype.ScriptFragment,"img");var _24=new RegExp(Prototype.ScriptFragment,"im");return (this.match(_23)||[]).map(function(_25){return (_25.match(_24)||["",""])[1];});},evalScripts:function(){return this.extractScripts().map(function(_26){return eval(_26);});},escapeHTML:function(){var div=document.createElement("div");var _28=document.createTextNode(this);div.appendChild(_28);return div.innerHTML;},unescapeHTML:function(){var div=document.createElement("div");div.innerHTML=this.stripTags();return div.childNodes[0]?div.childNodes[0].nodeValue:"";},toQueryParams:function(){var _2a=this.match(/^\??(.*)$/)[1].split("&");return _2a.inject({},function(_2b,_2c){var _2d=_2c.split("=");var _2e=_2d[1]?decodeURIComponent(_2d[1]):undefined;_2b[decodeURIComponent(_2d[0])]=_2e;return _2b;});},toArray:function(){return this.split("");},camelize:function(){var _2f=this.split("-");if(_2f.length==1){return _2f[0];}var _30=this.indexOf("-")==0?_2f[0].charAt(0).toUpperCase()+_2f[0].substring(1):_2f[0];for(var i=1,len=_2f.length;i<len;i++){var s=_2f[i];_30+=s.charAt(0).toUpperCase()+s.substring(1);}return _30;},inspect:function(_33){var _34=this.replace(/\\/g,"\\\\");if(_33){return "\""+_34.replace(/"/g,"\\\"")+"\"";}else{return "'"+_34.replace(/'/g,"\\'")+"'";}}});String.prototype.gsub.prepareReplacement=function(_35){if(typeof _35=="function"){return _35;}var _36=new Template(_35);return function(_37){return _36.evaluate(_37);};};String.prototype.parseQuery=String.prototype.toQueryParams;var Template=Class.create();Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;Template.prototype={initialize:function(_38,_39){this.template=_38.toString();this.pattern=_39||Template.Pattern;},evaluate:function(_3a){return this.template.gsub(this.pattern,function(_3b){var _3c=_3b[1];if(_3c=="\\"){return _3b[2];}return _3c+(_3a[_3b[3]]||"").toString();});}};var $break=new Object();var $continue=new Object();var Enumerable={each:function(_3d){var _3e=0;try{this._each(function(_3f){try{_3d(_3f,_3e++);}catch(e){if(e!=$continue){throw e;}}});}catch(e){if(e!=$break){throw e;}}},all:function(_40){var _41=true;this.each(function(_42,_43){_41=_41&&!!(_40||Prototype.K)(_42,_43);if(!_41){throw $break;}});return _41;},any:function(_44){var _45=false;this.each(function(_46,_47){if(_45=!!(_44||Prototype.K)(_46,_47)){throw $break;}});return _45;},collect:function(_48){var _49=[];this.each(function(_4a,_4b){_49.push(_48(_4a,_4b));});return _49;},detect:function(_4c){var _4d;this.each(function(_4e,_4f){if(_4c(_4e,_4f)){_4d=_4e;throw $break;}});return _4d;},findAll:function(_50){var _51=[];this.each(function(_52,_53){if(_50(_52,_53)){_51.push(_52);}});return _51;},grep:function(_54,_55){var _56=[];this.each(function(_57,_58){var _59=_57.toString();if(_59.match(_54)){_56.push((_55||Prototype.K)(_57,_58));}});return _56;},include:function(_5a){var _5b=false;this.each(function(_5c){if(_5c==_5a){_5b=true;throw $break;}});return _5b;},inject:function(_5d,_5e){this.each(function(_5f,_60){_5d=_5e(_5d,_5f,_60);});return _5d;},invoke:function(_61){var _62=$A(arguments).slice(1);return this.collect(function(_63){return _63[_61].apply(_63,_62);});},max:function(_64){var _65;this.each(function(_66,_67){_66=(_64||Prototype.K)(_66,_67);if(_65==undefined||_66>=_65){_65=_66;}});return _65;},min:function(_68){var _69;this.each(function(_6a,_6b){_6a=(_68||Prototype.K)(_6a,_6b);if(_69==undefined||_6a<_69){_69=_6a;}});return _69;},partition:function(_6c){var _6d=[],falses=[];this.each(function(_6e,_6f){((_6c||Prototype.K)(_6e,_6f)?_6d:falses).push(_6e);});return [_6d,falses];},pluck:function(_70){var _71=[];this.each(function(_72,_73){_71.push(_72[_70]);});return _71;},reject:function(_74){var _75=[];this.each(function(_76,_77){if(!_74(_76,_77)){_75.push(_76);}});return _75;},sortBy:function(_78){return this.collect(function(_79,_7a){return {value:_79,criteria:_78(_79,_7a)};}).sort(function(_7b,_7c){var a=_7b.criteria,b=_7c.criteria;return a<b?-1:a>b?1:0;}).pluck("value");},toArray:function(){return this.collect(Prototype.K);},zip:function(){var _7e=Prototype.K,args=$A(arguments);if(typeof args.last()=="function"){_7e=args.pop();}var _7f=[this].concat(args).map($A);return this.map(function(_80,_81){return _7e(_7f.pluck(_81));});},inspect:function(){return "#<Enumerable:"+this.toArray().inspect()+">";}};Object.extend(Enumerable,{map:Enumerable.collect,find:Enumerable.detect,select:Enumerable.findAll,member:Enumerable.include,entries:Enumerable.toArray});var $A=Array.from=function(_82){if(!_82){return [];}if(_82.toArray){return _82.toArray();}else{var _83=[];for(var i=0;i<_82.length;i++){_83.push(_82[i]);}return _83;}};Object.extend(Array.prototype,Enumerable);if(!Array.prototype._reverse){Array.prototype._reverse=Array.prototype.reverse;}Object.extend(Array.prototype,{_each:function(_85){for(var i=0;i<this.length;i++){_85(this[i]);}},clear:function(){this.length=0;return this;},first:function(){return this[0];},last:function(){return this[this.length-1];},compact:function(){return this.select(function(_87){return _87!=undefined||_87!=null;});},flatten:function(){return this.inject([],function(_88,_89){return _88.concat(_89&&_89.constructor==Array?_89.flatten():[_89]);});},without:function(){var _8a=$A(arguments);return this.select(function(_8b){return !_8a.include(_8b);});},indexOf:function(_8c){for(var i=0;i<this.length;i++){if(this[i]==_8c){return i;}}return -1;},reverse:function(_8e){return (_8e!==false?this:this.toArray())._reverse();},reduce:function(){return this.length>1?this:this[0];},uniq:function(){return this.inject([],function(_8f,_90){return _8f.include(_90)?_8f:_8f.concat([_90]);});},inspect:function(){return "["+this.map(Object.inspect).join(", ")+"]";}});var Hash={_each:function(_91){for(var key in this){var _93=this[key];if(typeof _93=="function"){continue;}var _94=[key,_93];_94.key=key;_94.value=_93;_91(_94);}},keys:function(){return this.pluck("key");},values:function(){return this.pluck("value");},merge:function(_95){return $H(_95).inject($H(this),function(_96,_97){_96[_97.key]=_97.value;return _96;});},toQueryString:function(){return this.map(function(_98){return _98.map(encodeURIComponent).join("=");}).join("&");},inspect:function(){return "#<Hash:{"+this.map(function(_99){return _99.map(Object.inspect).join(": ");}).join(", ")+"}>";}};function $H(_9a){var _9b=Object.extend({},_9a||{});Object.extend(_9b,Enumerable);Object.extend(_9b,Hash);return _9b;}ObjectRange=Class.create();Object.extend(ObjectRange.prototype,Enumerable);Object.extend(ObjectRange.prototype,{initialize:function(_9c,end,_9e){this.start=_9c;this.end=end;this.exclusive=_9e;},_each:function(_9f){var _a0=this.start;while(this.include(_a0)){_9f(_a0);_a0=_a0.succ();}},include:function(_a1){if(_a1<this.start){return false;}if(this.exclusive){return _a1<this.end;}return _a1<=this.end;}});var $R=function(_a2,end,_a4){return new ObjectRange(_a2,end,_a4);};var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");})||false;},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(_a5){this.responders._each(_a5);},register:function(_a6){if(!this.include(_a6)){this.responders.push(_a6);}},unregister:function(_a7){this.responders=this.responders.without(_a7);},dispatch:function(_a8,_a9,_aa,_ab){this.each(function(_ac){if(_ac[_a8]&&typeof _ac[_a8]=="function"){try{_ac[_a8].apply(_ac,[_a9,_aa,_ab]);}catch(e){}}});}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++;},onComplete:function(){Ajax.activeRequestCount--;}});Ajax.Base=function(){};Ajax.Base.prototype={setOptions:function(_ad){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",parameters:""};Object.extend(this.options,_ad||{});},responseIsSuccess:function(){return this.transport.status==undefined||this.transport.status==0||(this.transport.status>=200&&this.transport.status<300);},responseIsFailure:function(){return !this.responseIsSuccess();}};Ajax.Request=Class.create();Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];Ajax.Request.prototype=Object.extend(new Ajax.Base(),{initialize:function(url,_af){this.transport=Ajax.getTransport();this.setOptions(_af);this.request(url);},request:function(url){var _b1=this.options.parameters||"";if(_b1.length>0){_b1+="&_=";}if(this.options.method!="get"&&this.options.method!="post"){_b1+=(_b1.length>0?"&":"")+"_method="+this.options.method;this.options.method="post";}try{this.url=url;if(this.options.method=="get"&&_b1.length>0){this.url+=(this.url.match(/\?/)?"&":"?")+_b1;}Ajax.Responders.dispatch("onCreate",this,this.transport);this.transport.open(this.options.method,this.url,this.options.asynchronous);if(this.options.asynchronous){setTimeout(function(){this.respondToReadyState(1);}.bind(this),10);}this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();var _b2=this.options.postBody?this.options.postBody:_b1;this.transport.send(this.options.method=="post"?_b2:null);if(!this.options.asynchronous&&this.transport.overrideMimeType){this.onStateChange();}}catch(e){this.dispatchException(e);}},setRequestHeaders:function(){var _b3=["X-Requested-With","XMLHttpRequest","X-Prototype-Version",Prototype.Version,"Accept","text/javascript, text/html, application/xml, text/xml, */*"];if(this.options.method=="post"){_b3.push("Content-type",this.options.contentType);if(this.transport.overrideMimeType){_b3.push("Connection","close");}}if(this.options.requestHeaders){_b3.push.apply(_b3,this.options.requestHeaders);}for(var i=0;i<_b3.length;i+=2){this.transport.setRequestHeader(_b3[i],_b3[i+1]);}},onStateChange:function(){var _b5=this.transport.readyState;if(_b5!=1){this.respondToReadyState(this.transport.readyState);}},header:function(_b6){try{return this.transport.getResponseHeader(_b6);}catch(e){}},evalJSON:function(){try{return eval("("+this.header("X-JSON")+")");}catch(e){}},evalResponse:function(){try{return eval(this.transport.responseText);}catch(e){this.dispatchException(e);}},respondToReadyState:function(_b7){var _b8=Ajax.Request.Events[_b7];var _b9=this.transport,json=this.evalJSON();if(_b8=="Complete"){try{(this.options["on"+this.transport.status]||this.options["on"+(this.responseIsSuccess()?"Success":"Failure")]||Prototype.emptyFunction)(_b9,json);}catch(e){this.dispatchException(e);}if((this.header("Content-type")||"").match(/^text\/javascript/i)){this.evalResponse();}}try{(this.options["on"+_b8]||Prototype.emptyFunction)(_b9,json);Ajax.Responders.dispatch("on"+_b8,this,_b9,json);}catch(e){this.dispatchException(e);}if(_b8=="Complete"){this.transport.onreadystatechange=Prototype.emptyFunction;}},dispatchException:function(_ba){(this.options.onException||Prototype.emptyFunction)(this,_ba);Ajax.Responders.dispatch("onException",this,_ba);}});Ajax.Updater=Class.create();Object.extend(Object.extend(Ajax.Updater.prototype,Ajax.Request.prototype),{initialize:function(_bb,url,_bd){this.containers={success:_bb.success?$(_bb.success):$(_bb),failure:_bb.failure?$(_bb.failure):(_bb.success?null:$(_bb))};this.transport=Ajax.getTransport();this.setOptions(_bd);var _be=this.options.onComplete||Prototype.emptyFunction;this.options.onComplete=(function(_bf,_c0){this.updateContent();_be(_bf,_c0);}).bind(this);this.request(url);},updateContent:function(){var _c1=this.responseIsSuccess()?this.containers.success:this.containers.failure;var _c2=this.transport.responseText;if(!this.options.evalScripts){_c2=_c2.stripScripts();}if(_c1){if(this.options.insertion){new this.options.insertion(_c1,_c2);}else{Element.update(_c1,_c2);}}if(this.responseIsSuccess()){if(this.onComplete){setTimeout(this.onComplete.bind(this),10);}}}});Ajax.PeriodicalUpdater=Class.create();Ajax.PeriodicalUpdater.prototype=Object.extend(new Ajax.Base(),{initialize:function(_c3,url,_c5){this.setOptions(_c5);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=_c3;this.url=url;this.start();},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent();},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments);},updateComplete:function(_c6){if(this.options.decay){this.decay=(_c6.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=_c6.responseText;}this.timer=setTimeout(this.onTimerEvent.bind(this),this.decay*this.frequency*1000);},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options);}});function $(){var _c7=[],element;for(var i=0;i<arguments.length;i++){element=arguments[i];if(typeof element=="string"){element=document.getElementById(element);}_c7.push(Element.extend(element));}return _c7.reduce();}document.getElementsByClassName=function(_c9,_ca){var _cb=($(_ca)||document.body).getElementsByTagName("*");return $A(_cb).inject([],function(_cc,_cd){if(_cd.className.match(new RegExp("(^|\\s)"+_c9+"(\\s|$)"))){_cc.push(Element.extend(_cd));}return _cc;});};if(!window.Element){var Element=new Object();}Element.extend=function(_ce){if(!_ce){return;}if(_nativeExtensions){return _ce;}if(!_ce._extended&&_ce.tagName&&_ce!=window){var _cf=Object.clone(Element.Methods),cache=Element.extend.cache;if(_ce.tagName=="FORM"){Object.extend(_cf,Form.Methods);}if(["INPUT","TEXTAREA","SELECT"].include(_ce.tagName)){Object.extend(_cf,Form.Element.Methods);}for(var _d0 in _cf){var _d1=_cf[_d0];if(typeof _d1=="function"){_ce[_d0]=cache.findOrStore(_d1);}}}_ce._extended=true;return _ce;};Element.extend.cache={findOrStore:function(_d2){return this[_d2]=this[_d2]||function(){return _d2.apply(null,[this].concat($A(arguments)));};}};Element.Methods={visible:function(_d3){return $(_d3).style.display!="none";},toggle:function(_d4){_d4=$(_d4);Element[Element.visible(_d4)?"hide":"show"](_d4);return _d4;},hide:function(_d5){$(_d5).style.display="none";return _d5;},show:function(_d6){$(_d6).style.display="";return _d6;},remove:function(_d7){_d7=$(_d7);_d7.parentNode.removeChild(_d7);return _d7;},update:function(_d8,_d9){$(_d8).innerHTML=_d9.stripScripts();setTimeout(function(){_d9.evalScripts();},10);return _d8;},replace:function(_da,_db){_da=$(_da);if(_da.outerHTML){_da.outerHTML=_db.stripScripts();}else{var _dc=_da.ownerDocument.createRange();_dc.selectNodeContents(_da);_da.parentNode.replaceChild(_dc.createContextualFragment(_db.stripScripts()),_da);}setTimeout(function(){_db.evalScripts();},10);return _da;},inspect:function(_dd){_dd=$(_dd);var _de="<"+_dd.tagName.toLowerCase();$H({"id":"id","className":"class"}).each(function(_df){var _e0=_df.first(),attribute=_df.last();var _e1=(_dd[_e0]||"").toString();if(_e1){_de+=" "+attribute+"="+_e1.inspect(true);}});return _de+">";},recursivelyCollect:function(_e2,_e3){_e2=$(_e2);var _e4=[];while(_e2=_e2[_e3]){if(_e2.nodeType==1){_e4.push(Element.extend(_e2));}}return _e4;},ancestors:function(_e5){return $(_e5).recursivelyCollect("parentNode");},descendants:function(_e6){_e6=$(_e6);return $A(_e6.getElementsByTagName("*"));},previousSiblings:function(_e7){return $(_e7).recursivelyCollect("previousSibling");},nextSiblings:function(_e8){return $(_e8).recursivelyCollect("nextSibling");},siblings:function(_e9){_e9=$(_e9);return _e9.previousSiblings().reverse().concat(_e9.nextSiblings());},match:function(_ea,_eb){_ea=$(_ea);if(typeof _eb=="string"){_eb=new Selector(_eb);}return _eb.match(_ea);},up:function(_ec,_ed,_ee){return Selector.findElement($(_ec).ancestors(),_ed,_ee);},down:function(_ef,_f0,_f1){return Selector.findElement($(_ef).descendants(),_f0,_f1);},previous:function(_f2,_f3,_f4){return Selector.findElement($(_f2).previousSiblings(),_f3,_f4);},next:function(_f5,_f6,_f7){return Selector.findElement($(_f5).nextSiblings(),_f6,_f7);},getElementsBySelector:function(){var _f8=$A(arguments),element=$(_f8.shift());return Selector.findChildElements(element,_f8);},getElementsByClassName:function(_f9,_fa){_f9=$(_f9);return document.getElementsByClassName(_fa,_f9);},getHeight:function(_fb){_fb=$(_fb);return _fb.offsetHeight;},classNames:function(_fc){return new Element.ClassNames(_fc);},hasClassName:function(_fd,_fe){if(!(_fd=$(_fd))){return;}return Element.classNames(_fd).include(_fe);},addClassName:function(_ff,_100){if(!(_ff=$(_ff))){return;}Element.classNames(_ff).add(_100);return _ff;},removeClassName:function(_101,_102){if(!(_101=$(_101))){return;}Element.classNames(_101).remove(_102);return _101;},observe:function(){Event.observe.apply(Event,arguments);return $A(arguments).first();},stopObserving:function(){Event.stopObserving.apply(Event,arguments);return $A(arguments).first();},cleanWhitespace:function(_103){_103=$(_103);for(var i=0;i<_103.childNodes.length;i++){var node=_103.childNodes[i];if(node.nodeType==3&&!/\S/.test(node.nodeValue)){Element.remove(node);}}return _103;},empty:function(_106){return $(_106).innerHTML.match(/^\s*$/);},childOf:function(_107,_108){_107=$(_107),_108=$(_108);while(_107=_107.parentNode){if(_107==_108){return true;}}return false;},scrollTo:function(_109){_109=$(_109);var x=_109.x?_109.x:_109.offsetLeft,y=_109.y?_109.y:_109.offsetTop;window.scrollTo(x,y);return _109;},getStyle:function(_10b,_10c){_10b=$(_10b);var _10d=_10b.style[_10c.camelize()];if(!_10d){if(document.defaultView&&document.defaultView.getComputedStyle){var css=document.defaultView.getComputedStyle(_10b,null);_10d=css?css.getPropertyValue(_10c):null;}else{if(_10b.currentStyle){_10d=_10b.currentStyle[_10c.camelize()];}}}if(window.opera&&["left","top","right","bottom"].include(_10c)){if(Element.getStyle(_10b,"position")=="static"){_10d="auto";}}return _10d=="auto"?null:_10d;},setStyle:function(_10f,_110){_10f=$(_10f);for(var name in _110){_10f.style[name.camelize()]=_110[name];}return _10f;},getDimensions:function(_112){_112=$(_112);if(Element.getStyle(_112,"display")!="none"){return {width:_112.offsetWidth,height:_112.offsetHeight};}var els=_112.style;var _114=els.visibility;var _115=els.position;els.visibility="hidden";els.position="absolute";els.display="";var _116=_112.clientWidth;var _117=_112.clientHeight;els.display="none";els.position=_115;els.visibility=_114;return {width:_116,height:_117};},makePositioned:function(_118){_118=$(_118);var pos=Element.getStyle(_118,"position");if(pos=="static"||!pos){_118._madePositioned=true;_118.style.position="relative";if(window.opera){_118.style.top=0;_118.style.left=0;}}return _118;},undoPositioned:function(_11a){_11a=$(_11a);if(_11a._madePositioned){_11a._madePositioned=undefined;_11a.style.position=_11a.style.top=_11a.style.left=_11a.style.bottom=_11a.style.right="";}return _11a;},makeClipping:function(_11b){_11b=$(_11b);if(_11b._overflow){return;}_11b._overflow=_11b.style.overflow||"auto";if((Element.getStyle(_11b,"overflow")||"visible")!="hidden"){_11b.style.overflow="hidden";}return _11b;},undoClipping:function(_11c){_11c=$(_11c);if(!_11c._overflow){return;}_11c.style.overflow=_11c._overflow=="auto"?"":_11c._overflow;delete _11c._overflow;return _11c;}};if(document.all){Element.Methods.update=function(_11d,html){_11d=$(_11d);var _11f=_11d.tagName.toUpperCase();if(["THEAD","TBODY","TR","TD"].indexOf(_11f)>-1){var div=document.createElement("div");switch(_11f){case "THEAD":case "TBODY":div.innerHTML="<table><tbody>"+html.stripScripts()+"</tbody></table>";depth=2;break;case "TR":div.innerHTML="<table><tbody><tr>"+html.stripScripts()+"</tr></tbody></table>";depth=3;break;case "TD":div.innerHTML="<table><tbody><tr><td>"+html.stripScripts()+"</td></tr></tbody></table>";depth=4;}$A(_11d.childNodes).each(function(node){_11d.removeChild(node);});depth.times(function(){div=div.firstChild;});$A(div.childNodes).each(function(node){_11d.appendChild(node);});}else{_11d.innerHTML=html.stripScripts();}setTimeout(function(){html.evalScripts();},10);return _11d;};}Object.extend(Element,Element.Methods);var _nativeExtensions=false;if(!window.HTMLElement&&/Konqueror|Safari|KHTML/.test(navigator.userAgent)){["","Form","Input","TextArea","Select"].each(function(tag){var _124=window["HTML"+tag+"Element"]={};_124.prototype=document.createElement(tag?tag.toLowerCase():"div").__proto__;});}Element.addMethods=function(_125){Object.extend(Element.Methods,_125||{});function copy(_126,_127){var _128=Element.extend.cache;for(var _129 in _126){var _12a=_126[_129];_127[_129]=_128.findOrStore(_12a);}}if(typeof HTMLElement!="undefined"){copy(Element.Methods,HTMLElement.prototype);copy(Form.Methods,HTMLFormElement.prototype);[HTMLInputElement,HTMLTextAreaElement,HTMLSelectElement].each(function(_12b){copy(Form.Element.Methods,_12b.prototype);});_nativeExtensions=true;}};var Toggle=new Object();Toggle.display=Element.toggle;Abstract.Insertion=function(_12c){this.adjacency=_12c;};Abstract.Insertion.prototype={initialize:function(_12d,_12e){this.element=$(_12d);this.content=_12e.stripScripts();if(this.adjacency&&this.element.insertAdjacentHTML){try{this.element.insertAdjacentHTML(this.adjacency,this.content);}catch(e){var _12f=this.element.tagName.toLowerCase();if(_12f=="tbody"||_12f=="tr"){this.insertContent(this.contentFromAnonymousTable());}else{throw e;}}}else{this.range=this.element.ownerDocument.createRange();if(this.initializeRange){this.initializeRange();}this.insertContent([this.range.createContextualFragment(this.content)]);}setTimeout(function(){_12e.evalScripts();},10);},contentFromAnonymousTable:function(){var div=document.createElement("div");div.innerHTML="<table><tbody>"+this.content+"</tbody></table>";return $A(div.childNodes[0].childNodes[0].childNodes);}};var Insertion=new Object();Insertion.Before=Class.create();Insertion.Before.prototype=Object.extend(new Abstract.Insertion("beforeBegin"),{initializeRange:function(){this.range.setStartBefore(this.element);},insertContent:function(_131){_131.each((function(_132){this.element.parentNode.insertBefore(_132,this.element);}).bind(this));}});Insertion.Top=Class.create();Insertion.Top.prototype=Object.extend(new Abstract.Insertion("afterBegin"),{initializeRange:function(){this.range.selectNodeContents(this.element);this.range.collapse(true);},insertContent:function(_133){_133.reverse(false).each((function(_134){this.element.insertBefore(_134,this.element.firstChild);}).bind(this));}});Insertion.Bottom=Class.create();Insertion.Bottom.prototype=Object.extend(new Abstract.Insertion("beforeEnd"),{initializeRange:function(){this.range.selectNodeContents(this.element);this.range.collapse(this.element);},insertContent:function(_135){_135.each((function(_136){this.element.appendChild(_136);}).bind(this));}});Insertion.After=Class.create();Insertion.After.prototype=Object.extend(new Abstract.Insertion("afterEnd"),{initializeRange:function(){this.range.setStartAfter(this.element);},insertContent:function(_137){_137.each((function(_138){this.element.parentNode.insertBefore(_138,this.element.nextSibling);}).bind(this));}});Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(_139){this.element=$(_139);},_each:function(_13a){this.element.className.split(/\s+/).select(function(name){return name.length>0;})._each(_13a);},set:function(_13c){this.element.className=_13c;},add:function(_13d){if(this.include(_13d)){return;}this.set(this.toArray().concat(_13d).join(" "));},remove:function(_13e){if(!this.include(_13e)){return;}this.set(this.select(function(_13f){return _13f!=_13e;}).join(" "));},toString:function(){return this.toArray().join(" ");}};Object.extend(Element.ClassNames.prototype,Enumerable);var Selector=Class.create();Selector.prototype={initialize:function(_140){this.params={classNames:[]};this.expression=_140.toString().strip();this.parseExpression();this.compileMatcher();},parseExpression:function(){function abort(_141){throw "Parse error in selector: "+_141;}if(this.expression==""){abort("empty expression");}var _142=this.params,expr=this.expression,match,modifier,clause,rest;while(match=expr.match(/^(.*)\[([a-z0-9_:-]+?)(?:([~\|!]?=)(?:"([^"]*)"|([^\]\s]*)))?\]$/i)){_142.attributes=_142.attributes||[];_142.attributes.push({name:match[2],operator:match[3],value:match[4]||match[5]||""});expr=match[1];}if(expr=="*"){return this.params.wildcard=true;}while(match=expr.match(/^([^a-z0-9_-])?([a-z0-9_-]+)(.*)/i)){modifier=match[1],clause=match[2],rest=match[3];switch(modifier){case "#":_142.id=clause;break;case ".":_142.classNames.push(clause);break;case "":case undefined:_142.tagName=clause.toUpperCase();break;default:abort(expr.inspect());}expr=rest;}if(expr.length>0){abort(expr.inspect());}},buildMatchExpression:function(){var _143=this.params,conditions=[],clause;if(_143.wildcard){conditions.push("true");}if(clause=_143.id){conditions.push("element.id == "+clause.inspect());}if(clause=_143.tagName){conditions.push("element.tagName.toUpperCase() == "+clause.inspect());}if((clause=_143.classNames).length>0){for(var i=0;i<clause.length;i++){conditions.push("Element.hasClassName(element, "+clause[i].inspect()+")");}}if(clause=_143.attributes){clause.each(function(_145){var _146="element.getAttribute("+_145.name.inspect()+")";var _147=function(_148){return _146+" && "+_146+".split("+_148.inspect()+")";};switch(_145.operator){case "=":conditions.push(_146+" == "+_145.value.inspect());break;case "~=":conditions.push(_147(" ")+".include("+_145.value.inspect()+")");break;case "|=":conditions.push(_147("-")+".first().toUpperCase() == "+_145.value.toUpperCase().inspect());break;case "!=":conditions.push(_146+" != "+_145.value.inspect());break;case "":case undefined:conditions.push(_146+" != null");break;default:throw "Unknown operator "+_145.operator+" in selector";}});}return conditions.join(" && ");},compileMatcher:function(){this.match=new Function("element","if (!element.tagName) return false;       return "+this.buildMatchExpression());},findElements:function(_149){var _14a;if(_14a=$(this.params.id)){if(this.match(_14a)){if(!_149||Element.childOf(_14a,_149)){return [_14a];}}}_149=(_149||document).getElementsByTagName(this.params.tagName||"*");var _14b=[];for(var i=0;i<_149.length;i++){if(this.match(_14a=_149[i])){_14b.push(Element.extend(_14a));}}return _14b;},toString:function(){return this.expression;}};Object.extend(Selector,{matchElements:function(_14d,_14e){var _14f=new Selector(_14e);return _14d.select(_14f.match.bind(_14f));},findElement:function(_150,_151,_152){if(typeof _151=="number"){_152=_151,_151=false;}return Selector.matchElements(_150,_151||"*")[_152||0];},findChildElements:function(_153,_154){return _154.map(function(_155){return _155.strip().split(/\s+/).inject([null],function(_156,expr){var _158=new Selector(expr);return _156.inject([],function(_159,_15a){return _159.concat(_158.findElements(_15a||_153));});});}).flatten();}});function $$(){return Selector.findChildElements(document,$A(arguments));}var Form={reset:function(form){$(form).reset();return form;}};Form.Methods={serialize:function(form){var _15d=Form.getElements($(form));var _15e=new Array();for(var i=0;i<_15d.length;i++){var _160=Form.Element.serialize(_15d[i]);if(_160){_15e.push(_160);}}return _15e.join("&");},getElements:function(form){form=$(form);var _162=new Array();for(var _163 in Form.Element.Serializers){var _164=form.getElementsByTagName(_163);for(var j=0;j<_164.length;j++){_162.push(_164[j]);}}return _162;},getInputs:function(form,_167,name){form=$(form);var _169=form.getElementsByTagName("input");if(!_167&&!name){return _169;}var _16a=new Array();for(var i=0;i<_169.length;i++){var _16c=_169[i];if((_167&&_16c.type!=_167)||(name&&_16c.name!=name)){continue;}_16a.push(_16c);}return _16a;},disable:function(form){form=$(form);var _16e=Form.getElements(form);for(var i=0;i<_16e.length;i++){var _170=_16e[i];_170.blur();_170.disabled="true";}return form;},enable:function(form){form=$(form);var _172=Form.getElements(form);for(var i=0;i<_172.length;i++){var _174=_172[i];_174.disabled="";}return form;},findFirstElement:function(form){return Form.getElements(form).find(function(_176){return _176.type!="hidden"&&!_176.disabled&&["input","select","textarea"].include(_176.tagName.toLowerCase());});},focusFirstElement:function(form){form=$(form);Field.activate(Form.findFirstElement(form));return form;}};Object.extend(Form,Form.Methods);Form.Element={focus:function(_178){$(_178).focus();return _178;},select:function(_179){$(_179).select();return _179;}};Form.Element.Methods={serialize:function(_17a){_17a=$(_17a);var _17b=_17a.tagName.toLowerCase();var _17c=Form.Element.Serializers[_17b](_17a);if(_17c){var key=encodeURIComponent(_17c[0]);if(key.length==0){return;}if(_17c[1].constructor!=Array){_17c[1]=[_17c[1]];}return _17c[1].map(function(_17e){return key+"="+encodeURIComponent(_17e);}).join("&");}},getValue:function(_17f){_17f=$(_17f);var _180=_17f.tagName.toLowerCase();var _181=Form.Element.Serializers[_180](_17f);if(_181){return _181[1];}},clear:function(_182){$(_182).value="";return _182;},present:function(_183){return $(_183).value!="";},activate:function(_184){_184=$(_184);_184.focus();if(_184.select){_184.select();}return _184;},disable:function(_185){_185=$(_185);_185.disabled="";return _185;},enable:function(_186){_186=$(_186);_186.blur();_186.disabled="true";return _186;}};Object.extend(Form.Element,Form.Element.Methods);var Field=Form.Element;Form.Element.Serializers={input:function(_187){switch(_187.type.toLowerCase()){case "checkbox":case "radio":return Form.Element.Serializers.inputSelector(_187);default:return Form.Element.Serializers.textarea(_187);}return false;},inputSelector:function(_188){if(_188.checked){return [_188.name,_188.value];}},textarea:function(_189){return [_189.name,_189.value];},select:function(_18a){return Form.Element.Serializers[_18a.type=="select-one"?"selectOne":"selectMany"](_18a);},selectOne:function(_18b){var _18c="",opt,index=_18b.selectedIndex;if(index>=0){opt=_18b.options[index];_18c=opt.value||opt.text;}return [_18b.name,_18c];},selectMany:function(_18d){var _18e=[];for(var i=0;i<_18d.length;i++){var opt=_18d.options[i];if(opt.selected){_18e.push(opt.value||opt.text);}}return [_18d.name,_18e];}};var $F=Form.Element.getValue;Abstract.TimedObserver=function(){};Abstract.TimedObserver.prototype={initialize:function(_191,_192,_193){this.frequency=_192;this.element=$(_191);this.callback=_193;this.lastValue=this.getValue();this.registerCallback();},registerCallback:function(){setInterval(this.onTimerEvent.bind(this),this.frequency*1000);},onTimerEvent:function(){var _194=this.getValue();if(this.lastValue!=_194){this.callback(this.element,_194);this.lastValue=_194;}}};Form.Element.Observer=Class.create();Form.Element.Observer.prototype=Object.extend(new Abstract.TimedObserver(),{getValue:function(){return Form.Element.getValue(this.element);}});Form.Observer=Class.create();Form.Observer.prototype=Object.extend(new Abstract.TimedObserver(),{getValue:function(){return Form.serialize(this.element);}});Abstract.EventObserver=function(){};Abstract.EventObserver.prototype={initialize:function(_195,_196){this.element=$(_195);this.callback=_196;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=="form"){this.registerFormCallbacks();}else{this.registerCallback(this.element);}},onElementEvent:function(){var _197=this.getValue();if(this.lastValue!=_197){this.callback(this.element,_197);this.lastValue=_197;}},registerFormCallbacks:function(){var _198=Form.getElements(this.element);for(var i=0;i<_198.length;i++){this.registerCallback(_198[i]);}},registerCallback:function(_19a){if(_19a.type){switch(_19a.type.toLowerCase()){case "checkbox":case "radio":Event.observe(_19a,"click",this.onElementEvent.bind(this));break;default:Event.observe(_19a,"change",this.onElementEvent.bind(this));break;}}}};Form.Element.EventObserver=Class.create();Form.Element.EventObserver.prototype=Object.extend(new Abstract.EventObserver(),{getValue:function(){return Form.Element.getValue(this.element);}});Form.EventObserver=Class.create();Form.EventObserver.prototype=Object.extend(new Abstract.EventObserver(),{getValue:function(){return Form.serialize(this.element);}});if(!window.Event){var Event=new Object();}Object.extend(Event,{KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,element:function(_19b){return _19b.target||_19b.srcElement;},isLeftClick:function(_19c){return (((_19c.which)&&(_19c.which==1))||((_19c.button)&&(_19c.button==1)));},pointerX:function(_19d){return _19d.pageX||(_19d.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft));},pointerY:function(_19e){return _19e.pageY||(_19e.clientY+(document.documentElement.scrollTop||document.body.scrollTop));},stop:function(_19f){if(_19f.preventDefault){_19f.preventDefault();_19f.stopPropagation();}else{_19f.returnValue=false;_19f.cancelBubble=true;}},findElement:function(_1a0,_1a1){var _1a2=Event.element(_1a0);while(_1a2.parentNode&&(!_1a2.tagName||(_1a2.tagName.toUpperCase()!=_1a1.toUpperCase()))){_1a2=_1a2.parentNode;}return _1a2;},observers:false,_observeAndCache:function(_1a3,name,_1a5,_1a6){if(!this.observers){this.observers=[];}if(_1a3.addEventListener){this.observers.push([_1a3,name,_1a5,_1a6]);_1a3.addEventListener(name,_1a5,_1a6);}else{if(_1a3.attachEvent){this.observers.push([_1a3,name,_1a5,_1a6]);_1a3.attachEvent("on"+name,_1a5);}}},unloadCache:function(){if(!Event.observers){return;}for(var i=0;i<Event.observers.length;i++){Event.stopObserving.apply(this,Event.observers[i]);Event.observers[i][0]=null;}Event.observers=false;},observe:function(_1a8,name,_1aa,_1ab){_1a8=$(_1a8);_1ab=_1ab||false;if(name=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||_1a8.attachEvent)){name="keydown";}Event._observeAndCache(_1a8,name,_1aa,_1ab);},stopObserving:function(_1ac,name,_1ae,_1af){_1ac=$(_1ac);_1af=_1af||false;if(name=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||_1ac.detachEvent)){name="keydown";}if(_1ac.removeEventListener){_1ac.removeEventListener(name,_1ae,_1af);}else{if(_1ac.detachEvent){try{_1ac.detachEvent("on"+name,_1ae);}catch(e){}}}}});if(navigator.appVersion.match(/\bMSIE\b/)){Event.observe(window,"unload",Event.unloadCache,false);}var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;},realOffset:function(_1b0){var _1b1=0,valueL=0;do{_1b1+=_1b0.scrollTop||0;valueL+=_1b0.scrollLeft||0;_1b0=_1b0.parentNode;}while(_1b0);return [valueL,_1b1];},cumulativeOffset:function(_1b2){var _1b3=0,valueL=0;do{_1b3+=_1b2.offsetTop||0;valueL+=_1b2.offsetLeft||0;_1b2=_1b2.offsetParent;}while(_1b2);return [valueL,_1b3];},positionedOffset:function(_1b4){var _1b5=0,valueL=0;do{_1b5+=_1b4.offsetTop||0;valueL+=_1b4.offsetLeft||0;_1b4=_1b4.offsetParent;if(_1b4){p=Element.getStyle(_1b4,"position");if(p=="relative"||p=="absolute"){break;}}}while(_1b4);return [valueL,_1b5];},offsetParent:function(_1b6){if(_1b6.offsetParent){return _1b6.offsetParent;}if(_1b6==document.body){return _1b6;}while((_1b6=_1b6.parentNode)&&_1b6!=document.body){if(Element.getStyle(_1b6,"position")!="static"){return _1b6;}}return document.body;},setup_cache:function(){this.cache_setup=0;},within:function(_1b7,x,y){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(_1b7,x,y);}this.xcomp=x;this.ycomp=y;if(!this.cache_setup){setTimeout(this.setup_cache.bind(this),200);this.cache_setup=1;this.stored_offsets={};}this.offset=this.stored_offsets[_1b7.id];if(!this.offset){this.offset=this.cumulativeOffset(_1b7);this.stored_offsets[_1b7.id]=this.offset;}return (y>=this.offset[1]&&y<this.offset[1]+_1b7.offsetHeight&&x>=this.offset[0]&&x<this.offset[0]+_1b7.offsetWidth);},withinIncludingScrolloffsets:function(_1ba,x,y){var _1bd=this.realOffset(_1ba);this.xcomp=x+_1bd[0]-this.deltaX;this.ycomp=y+_1bd[1]-this.deltaY;this.offset=this.cumulativeOffset(_1ba);return (this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+_1ba.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+_1ba.offsetWidth);},overlap:function(mode,_1bf){if(!mode){return 0;}if(mode=="vertical"){return ((this.offset[1]+_1bf.offsetHeight)-this.ycomp)/_1bf.offsetHeight;}if(mode=="horizontal"){return ((this.offset[0]+_1bf.offsetWidth)-this.xcomp)/_1bf.offsetWidth;}},page:function(_1c0){var _1c1=0,valueL=0;var _1c2=_1c0;do{_1c1+=_1c2.offsetTop||0;valueL+=_1c2.offsetLeft||0;if(_1c2.offsetParent==document.body){if(Element.getStyle(_1c2,"position")=="absolute"){break;}}}while(_1c2=_1c2.offsetParent);_1c2=_1c0;do{if(!window.opera||_1c2.tagName=="BODY"){_1c1-=_1c2.scrollTop||0;valueL-=_1c2.scrollLeft||0;}}while(_1c2=_1c2.parentNode);return [valueL,_1c1];},clone:function(_1c3,_1c4){var _1c5=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});_1c3=$(_1c3);var p=Position.page(_1c3);_1c4=$(_1c4);var _1c7=[0,0];var _1c8=null;if(Element.getStyle(_1c4,"position")=="absolute"){_1c8=Position.offsetParent(_1c4);_1c7=Position.page(_1c8);}if(_1c8==document.body){_1c7[0]-=document.body.offsetLeft;_1c7[1]-=document.body.offsetTop;}if(_1c5.setLeft){_1c4.style.left=(p[0]-_1c7[0]+_1c5.offsetLeft)+"px";}if(_1c5.setTop){_1c4.style.top=(p[1]-_1c7[1]+_1c5.offsetTop)+"px";}if(_1c5.setWidth){_1c4.style.width=_1c3.offsetWidth+"px";}if(_1c5.setHeight){_1c4.style.height=_1c3.offsetHeight+"px";}},absolutize:function(_1c9){_1c9=$(_1c9);if(_1c9.style.position=="absolute"){return;}Position.prepare();var _1ca=Position.positionedOffset(_1c9);var top=_1ca[1];var left=_1ca[0];var _1cd=_1c9.clientWidth;var _1ce=_1c9.clientHeight;_1c9._originalLeft=left-parseFloat(_1c9.style.left||0);_1c9._originalTop=top-parseFloat(_1c9.style.top||0);_1c9._originalWidth=_1c9.style.width;_1c9._originalHeight=_1c9.style.height;_1c9.style.position="absolute";_1c9.style.top=top+"px";_1c9.style.left=left+"px";_1c9.style.width=_1cd+"px";_1c9.style.height=_1ce+"px";},relativize:function(_1cf){_1cf=$(_1cf);if(_1cf.style.position=="relative"){return;}Position.prepare();_1cf.style.position="relative";var top=parseFloat(_1cf.style.top||0)-(_1cf._originalTop||0);var left=parseFloat(_1cf.style.left||0)-(_1cf._originalLeft||0);_1cf.style.top=top+"px";_1cf.style.left=left+"px";_1cf.style.height=_1cf._originalHeight;_1cf.style.width=_1cf._originalWidth;}};if(/Konqueror|Safari|KHTML/.test(navigator.userAgent)){Position.cumulativeOffset=function(_1d2){var _1d3=0,valueL=0;do{_1d3+=_1d2.offsetTop||0;valueL+=_1d2.offsetLeft||0;if(_1d2.offsetParent==document.body){if(Element.getStyle(_1d2,"position")=="absolute"){break;}}_1d2=_1d2.offsetParent;}while(_1d2);return [valueL,_1d3];};}Element.addMethods();function getElementsBySelector(_1d4,_1d5){var _1d6=_1d5.split(" ");var i;var _1d8=[_1d4];var _1d9=false;for(i=0;i<_1d6.length;++i){var _1da=_1d6[i];var _1db;_1db=_1da.split("#");if(_1db.length>1){var j;var _1dd=_1db[0];var sel=_1db[1];var els=[];for(j=0;j<_1d8.length;++j){els[els.length]=$A(_1d8[j].getElementsByTagName(_1dd||"*")).filter(function(el){return el.id==sel;});}_1d8=els.flatten();_1d9=true;continue;}_1db=_1da.split(".");if(_1db.length>1){var j;var _1e2=_1db[0];var sel=_1db[1];var els=[];for(j=0;j<_1d8.length;++j){els[els.length]=$A(_1d8[j].getElementsByTagName(_1e2||"*")).filter(function(el){return hasClass(el,sel);});}_1d8=els.flatten();_1d9=true;continue;}}return _1d9?_1d8:[];}var Behavior={rules:[],apply:function(){var i;for(i=0;i<Behavior.rules.length;++i){var _1e7=Behavior.rules[i];var rule;for(rule in _1e7){if(rule instanceof Function){continue;}var _1e9=$$(rule);var _1ea=getElementsBySelector(document,rule);_1ea.each(function(_1eb){_1e7[rule](_1eb);});}}},applySelectedRule:function(_1ec){var i;for(i=0;i<Behavior.rules.length;++i){var _1ee=Behavior.rules[i];var rule=_1ee[_1ec];if(!rule||!(rule instanceof Function)){continue;}var _1f0=getElementsBySelector(document,_1ec);_1f0.each(function(_1f1){rule(_1f1);});}},register:function(_1f2){Behavior.rules.push(_1f2);},init:function(){Event.observe(window,"load",Behavior.apply);}};Behavior.init();var Rico={Version:"1.1.2",prototypeVersion:parseFloat(Prototype.Version.split(".")[0]+"."+Prototype.Version.split(".")[1])};if((typeof Prototype=="undefined")||Rico.prototypeVersion<1.3){throw ("Rico requires the Prototype JavaScript framework >= 1.3");}Rico.ArrayExtensions=new Array();if(Object.prototype.extend){Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Object.prototype.extend;}else{Object.prototype.extend=function(_1f3){return Object.extend.apply(this,[this,_1f3]);};Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Object.prototype.extend;}if(Array.prototype.push){Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.push;}if(!Array.prototype.remove){Array.prototype.remove=function(dx){if(isNaN(dx)||dx>this.length){return false;}for(var i=0,n=0;i<this.length;i++){if(i!=dx){this[n++]=this[i];}}this.length-=1;};Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.remove;}if(!Array.prototype.removeItem){Array.prototype.removeItem=function(item){for(var i=0;i<this.length;i++){if(this[i]==item){this.remove(i);break;}}};Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.removeItem;}if(!Array.prototype.indices){Array.prototype.indices=function(){var _1f8=new Array();for(index in this){var _1f9=false;for(var i=0;i<Rico.ArrayExtensions.length;i++){if(this[index]==Rico.ArrayExtensions[i]){_1f9=true;break;}}if(!_1f9){_1f8[_1f8.length]=index;}}return _1f8;};Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.indices;}if(window.DOMParser&&window.XMLSerializer&&window.Node&&Node.prototype&&Node.prototype.__defineGetter__){if(!Document.prototype.loadXML){Document.prototype.loadXML=function(s){var doc2=(new DOMParser()).parseFromString(s,"text/xml");while(this.hasChildNodes()){this.removeChild(this.lastChild);}for(var i=0;i<doc2.childNodes.length;i++){this.appendChild(this.importNode(doc2.childNodes[i],true));}};}Document.prototype.__defineGetter__("xml",function(){return (new XMLSerializer()).serializeToString(this);});}document.getElementsByTagAndClassName=function(_1fe,_1ff){if(_1fe==null){_1fe="*";}var _200=document.getElementsByTagName(_1fe)||document.all;var _201=new Array();if(_1ff==null){return _200;}for(var i=0;i<_200.length;i++){var _203=_200[i];var _204=_203.className.split(" ");for(var j=0;j<_204.length;j++){if(_204[j]==_1ff){_201.push(_203);break;}}}return _201;};Rico.DragAndDrop=Class.create();Rico.DragAndDrop.prototype={initialize:function(){this.dropZones=new Array();this.draggables=new Array();this.currentDragObjects=new Array();this.dragElement=null;this.lastSelectedDraggable=null;this.currentDragObjectVisible=false;this.interestedInMotionEvents=false;this._mouseDown=this._mouseDownHandler.bindAsEventListener(this);this._mouseMove=this._mouseMoveHandler.bindAsEventListener(this);this._mouseUp=this._mouseUpHandler.bindAsEventListener(this);},registerDropZone:function(_206){this.dropZones[this.dropZones.length]=_206;},deregisterDropZone:function(_207){var _208=new Array();var j=0;for(var i=0;i<this.dropZones.length;i++){if(this.dropZones[i]!=_207){_208[j++]=this.dropZones[i];}}this.dropZones=_208;},clearDropZones:function(){this.dropZones=new Array();},registerDraggable:function(_20b){this.draggables[this.draggables.length]=_20b;this._addMouseDownHandler(_20b);},clearSelection:function(){for(var i=0;i<this.currentDragObjects.length;i++){this.currentDragObjects[i].deselect();}this.currentDragObjects=new Array();this.lastSelectedDraggable=null;},hasSelection:function(){return this.currentDragObjects.length>0;},setStartDragFromElement:function(e,_20e){this.origPos=RicoUtil.toDocumentPosition(_20e);this.startx=e.screenX-this.origPos.x;this.starty=e.screenY-this.origPos.y;this.interestedInMotionEvents=this.hasSelection();this._terminateEvent(e);},updateSelection:function(_20f,_210){if(!_210){this.clearSelection();}if(_20f.isSelected()){this.currentDragObjects.removeItem(_20f);_20f.deselect();if(_20f==this.lastSelectedDraggable){this.lastSelectedDraggable=null;}}else{this.currentDragObjects[this.currentDragObjects.length]=_20f;_20f.select();this.lastSelectedDraggable=_20f;}},_mouseDownHandler:function(e){if(arguments.length==0){e=event;}var _212=e.which!=undefined;if((_212&&e.which!=1)||(!_212&&e.button!=1)){return;}var _213=e.target?e.target:e.srcElement;var _214=_213.draggable;var _215=_213;while(_214==null&&_215.parentNode){_215=_215.parentNode;_214=_215.draggable;}if(_214==null){return;}this.updateSelection(_214,e.ctrlKey);if(this.hasSelection()){for(var i=0;i<this.dropZones.length;i++){this.dropZones[i].clearPositionCache();}}this.setStartDragFromElement(e,_214.getMouseDownHTMLElement());},_mouseMoveHandler:function(e){var _218=e.which!=undefined;if(!this.interestedInMotionEvents){return;}if(!this.hasSelection()){return;}if(!this.currentDragObjectVisible){this._startDrag(e);}if(!this.activatedDropZones){this._activateRegisteredDropZones();}this._updateDraggableLocation(e);this._updateDropZonesHover(e);this._terminateEvent(e);},_makeDraggableObjectVisible:function(e){if(!this.hasSelection()){return;}var _21a;if(this.currentDragObjects.length>1){_21a=this.currentDragObjects[0].getMultiObjectDragGUI(this.currentDragObjects);}else{_21a=this.currentDragObjects[0].getSingleObjectDragGUI();}if(RicoUtil.getElementsComputedStyle(_21a,"position")!="absolute"){_21a.style.position="absolute";}if(_21a.parentNode==null||_21a.parentNode.nodeType==11){document.body.appendChild(_21a);}this.dragElement=_21a;this._updateDraggableLocation(e);this.currentDragObjectVisible=true;},_leftOffset:function(e){return e.offsetX?document.body.scrollLeft:0;},_topOffset:function(e){return e.offsetY?document.body.scrollTop:0;},_updateDraggableLocation:function(e){var _21e=this.dragElement.style;if(navigator.userAgent.toLowerCase().indexOf("safari")>=0){_21e.left=(e.screenX-this.startx)+"px";_21e.top=(e.screenY-this.starty)+"px";}else{_21e.left=(e.screenX+this._leftOffset(e)-this.startx)+"px";_21e.top=(e.screenY+this._topOffset(e)-this.starty)+"px";}},_updateDropZonesHover:function(e){var n=this.dropZones.length;for(var i=0;i<n;i++){if(this.dropZones[i].canAccept(this.currentDragObjects)){if(this._mousePointInDropZone(e,this.dropZones[i])){this.dropZones[i].showHover(this.currentDragObjects,e);}else{this.dropZones[i].hideHover(this.currentDragObjects);}}}},_startDrag:function(e){for(var i=0;i<this.currentDragObjects.length;i++){this.currentDragObjects[i].startDrag();}this._makeDraggableObjectVisible(e);},_mouseUpHandler:function(e){if(!this.hasSelection()){return;}var _225=e.which!=undefined;if((_225&&e.which!=1)||(!_225&&e.button!=1)){return;}this.interestedInMotionEvents=false;if(this.dragElement==null){this._terminateEvent(e);return;}if(this._placeDraggableInDropZone(e)){this._completeDropOperation(e);}else{this._terminateEvent(e);new Rico.Effect.Position(this.dragElement,this.origPos.x,this.origPos.y,200,20,{complete:this._doCancelDragProcessing.bind(this)});}Event.stopObserving(document.body,"mousemove",this._mouseMove);Event.stopObserving(document.body,"mouseup",this._mouseUp);},_retTrue:function(){return true;},_completeDropOperation:function(e){if(this.dragElement!=this.currentDragObjects[0].getMouseDownHTMLElement()){if(this.dragElement.parentNode!=null){this.dragElement.parentNode.removeChild(this.dragElement);}}this._deactivateRegisteredDropZones();this._endDrag();this.clearSelection();this.dragElement=null;this.currentDragObjectVisible=false;this._terminateEvent(e);},_doCancelDragProcessing:function(){this._cancelDrag();if(this.dragElement!=this.currentDragObjects[0].getMouseDownHTMLElement()&&this.dragElement){if(this.dragElement.parentNode!=null){this.dragElement.parentNode.removeChild(this.dragElement);}}this._deactivateRegisteredDropZones();this.dragElement=null;this.currentDragObjectVisible=false;},_placeDraggableInDropZone:function(e){var _228=false;var n=this.dropZones.length;for(var i=0;i<n;i++){if(this.dropZones[i].canAccept(this.currentDragObjects)){if(this._mousePointInDropZone(e,this.dropZones[i])){this.dropZones[i].hideHover(this.currentDragObjects);this.dropZones[i].accept(this.currentDragObjects);_228=true;break;}}}return _228;},_cancelDrag:function(){for(var i=0;i<this.currentDragObjects.length;i++){this.currentDragObjects[i].cancelDrag();}},_endDrag:function(){for(var i=0;i<this.currentDragObjects.length;i++){this.currentDragObjects[i].endDrag();}},_mousePointInDropZone:function(e,_22e){var _22f=_22e.getAbsoluteRect();return e.clientY>_22f.top+this._topOffset(e)&&e.clientY<_22f.bottom+this._topOffset(e)&&e.clientX>_22f.left+this._leftOffset(e)&&e.clientX<_22f.right+this._leftOffset(e);},_addMouseDownHandler:function(_230){htmlElement=_230.getMouseDownHTMLElement();if(htmlElement!=null){htmlElement.draggable=_230;Event.observe(htmlElement,"mousedown",this._onmousedown.bindAsEventListener(this));Event.observe(htmlElement,"mousedown",this._mouseDown);}},_activateRegisteredDropZones:function(){var n=this.dropZones.length;for(var i=0;i<n;i++){var _233=this.dropZones[i];if(_233.canAccept(this.currentDragObjects)){_233.activate(this.currentDragObjects);}}this.activatedDropZones=true;},_deactivateRegisteredDropZones:function(){var n=this.dropZones.length;for(var i=0;i<n;i++){this.dropZones[i].deactivate();}this.activatedDropZones=false;},_onmousedown:function(){Event.observe(document.body,"mousemove",this._mouseMove);Event.observe(document.body,"mouseup",this._mouseUp);},_terminateEvent:function(e){if(e.stopPropagation!=undefined){e.stopPropagation();}else{if(e.cancelBubble!=undefined){e.cancelBubble=true;}}if(e.preventDefault!=undefined){e.preventDefault();}else{e.returnValue=false;}},initializeEventHandlers:function(){if(typeof document.implementation!="undefined"&&document.implementation.hasFeature("HTML","1.0")&&document.implementation.hasFeature("Events","2.0")&&document.implementation.hasFeature("CSS","2.0")){document.addEventListener("mouseup",this._mouseUpHandler.bindAsEventListener(this),false);document.addEventListener("mousemove",this._mouseMoveHandler.bindAsEventListener(this),false);}else{document.attachEvent("onmouseup",this._mouseUpHandler.bindAsEventListener(this));document.attachEvent("onmousemove",this._mouseMoveHandler.bindAsEventListener(this));}}};var dndMgr=new Rico.DragAndDrop();dndMgr.initializeEventHandlers();Rico.Draggable=Class.create();Rico.Draggable.prototype={initialize:function(type,_238){this.type=type;this.htmlElement=$(_238);this.selected=false;},getMouseDownHTMLElement:function(){return this.htmlElement;},select:function(){this.selected=true;if(this.showingSelected){return;}this.showingSelected=true;},deselect:function(){this.selected=false;if(!this.showingSelected){return;}var _239=this.getMouseDownHTMLElement();this.showingSelected=false;},isSelected:function(){return this.selected;},startDrag:function(){},cancelDrag:function(){},endDrag:function(){},getSingleObjectDragGUI:function(){return this.htmlElement;},getMultiObjectDragGUI:function(_23a){return this.htmlElement;},getDroppedGUI:function(){return this.htmlElement;},toString:function(){return this.type+":"+this.htmlElement+":";}};Rico.Dropzone=Class.create();Rico.Dropzone.prototype={initialize:function(_23b){this.htmlElement=$(_23b);this.absoluteRect=null;},getHTMLElement:function(){return this.htmlElement;},clearPositionCache:function(){this.absoluteRect=null;},getAbsoluteRect:function(){if(this.absoluteRect==null){var _23c=this.getHTMLElement();var pos=RicoUtil.toViewportPosition(_23c);this.absoluteRect={top:pos.y,left:pos.x,bottom:pos.y+_23c.offsetHeight,right:pos.x+_23c.offsetWidth};}return this.absoluteRect;},activate:function(){var _23e=this.getHTMLElement();if(_23e==null||this.showingActive){return;}this.showingActive=true;},deactivate:function(){var _23f=this.getHTMLElement();if(_23f==null||!this.showingActive){return;}this.showingActive=false;},showHover:function(){var _240=this.getHTMLElement();if(_240==null||this.showingHover){return;}this.saveBorderWidth=_240.style.borderWidth;this.saveBorderStyle=_240.style.borderStyle;this.showingHover=true;_240.style.borderWidth="1px";_240.style.borderStyle="solid";},hideHover:function(){var _241=this.getHTMLElement();if(_241==null||!this.showingHover){return;}_241.style.borderWidth=this.saveBorderWidth;_241.style.borderStyle=this.saveBorderStyle;this.showingHover=false;},canAccept:function(_242){return true;},accept:function(_243){var _244=this.getHTMLElement();if(_244==null){return;}n=_243.length;for(var i=0;i<n;i++){var _246=_243[i].getDroppedGUI();if(RicoUtil.getElementsComputedStyle(_246,"position")=="absolute"){_246.style.position="static";_246.style.top="";_246.style.top="";}_244.appendChild(_246);}}};Rico.Effect={};Rico.Effect.SizeAndPosition=Class.create();Rico.Effect.SizeAndPosition.prototype={initialize:function(_247,x,y,w,h,_24c,_24d,_24e){this.element=$(_247);this.x=x;this.y=y;this.w=w;this.h=h;this.duration=_24c;this.steps=_24d;this.options=arguments[7]||{};this.sizeAndPosition();},sizeAndPosition:function(){if(this.isFinished()){if(this.options.complete){this.options.complete(this);}return;}if(this.timer){clearTimeout(this.timer);}var _24f=Math.round(this.duration/this.steps);var _250=this.element.offsetLeft;var _251=this.element.offsetTop;var _252=this.element.offsetWidth;var _253=this.element.offsetHeight;this.x=(this.x)?this.x:_250;this.y=(this.y)?this.y:_251;this.w=(this.w)?this.w:_252;this.h=(this.h)?this.h:_253;var difX=this.steps>0?(this.x-_250)/this.steps:0;var difY=this.steps>0?(this.y-_251)/this.steps:0;var difW=this.steps>0?(this.w-_252)/this.steps:0;var difH=this.steps>0?(this.h-_253)/this.steps:0;this.moveBy(difX,difY);this.resizeBy(difW,difH);this.duration-=_24f;this.steps--;this.timer=setTimeout(this.sizeAndPosition.bind(this),_24f);},isFinished:function(){return this.steps<=0;},moveBy:function(difX,difY){var _25a=this.element.offsetLeft;var _25b=this.element.offsetTop;var _25c=parseInt(difX);var _25d=parseInt(difY);var _25e=this.element.style;if(_25c!=0){_25e.left=(_25a+_25c)+"px";}if(_25d!=0){_25e.top=(_25b+_25d)+"px";}},resizeBy:function(difW,difH){var _261=this.element.offsetWidth;var _262=this.element.offsetHeight;var _263=parseInt(difW);var _264=parseInt(difH);var _265=this.element.style;if(_263!=0){_265.width=(_261+_263)+"px";}if(_264!=0){_265.height=(_262+_264)+"px";}}};Rico.Effect.Size=Class.create();Rico.Effect.Size.prototype={initialize:function(_266,w,h,_269,_26a,_26b){new Rico.Effect.SizeAndPosition(_266,null,null,w,h,_269,_26a,_26b);}};Rico.Effect.Position=Class.create();Rico.Effect.Position.prototype={initialize:function(_26c,x,y,_26f,_270,_271){new Rico.Effect.SizeAndPosition(_26c,x,y,null,null,_26f,_270,_271);}};var RicoUtil={getElementsComputedStyle:function(_272,_273,_274){if(arguments.length==2){_274=_273;}var el=$(_272);if(el.currentStyle){return el.currentStyle[_273];}else{cs=document.defaultView.getComputedStyle(el,null);if(cs){return cs.getPropertyValue(_274);}else{return null;}}},createXmlDocument:function(){if(document.implementation&&document.implementation.createDocument){var doc=document.implementation.createDocument("","",null);if(doc.readyState==null){doc.readyState=1;doc.addEventListener("load",function(){doc.readyState=4;if(typeof doc.onreadystatechange=="function"){doc.onreadystatechange();}},false);}return doc;}if(window.ActiveXObject){return Try.these(function(){return new ActiveXObject("MSXML2.DomDocument");},function(){return new ActiveXObject("Microsoft.DomDocument");},function(){return new ActiveXObject("MSXML.DomDocument");},function(){return new ActiveXObject("MSXML3.DomDocument");})||false;}return null;},toViewportPosition:function(_277){return this._toAbsolute(_277,true);},toDocumentPosition:function(_278){return this._toAbsolute(_278,false);},_toAbsolute:function(_279,_27a){if(navigator.userAgent.toLowerCase().indexOf("msie")==-1){return this._toAbsoluteMozilla(_279,_27a);}var x=0;var y=0;var _27d=_279;while(_27d){var _27e=0;var _27f=0;if(_27d!=_279){var _280=parseInt(this.getElementsComputedStyle(_27d,"borderLeftWidth"));var _281=parseInt(this.getElementsComputedStyle(_27d,"borderTopWidth"));_280=isNaN(_280)?0:_280;_281=isNaN(_281)?0:_281;}x+=_27d.offsetLeft-_27d.scrollLeft+_280;y+=_27d.offsetTop-_27d.scrollTop+_281;_27d=_27d.offsetParent;}if(_27a){x-=this.docScrollLeft();y-=this.docScrollTop();}return {x:x,y:y};},_toAbsoluteMozilla:function(_282,_283){var x=0;var y=0;var _286=_282;while(_286){x+=_286.offsetLeft;y+=_286.offsetTop;_286=_286.offsetParent;}_286=_282;while(_286&&_286!=document.body&&_286!=document.documentElement){if(_286.scrollLeft){x-=_286.scrollLeft;}if(_286.scrollTop){y-=_286.scrollTop;}_286=_286.parentNode;}if(_283){x-=this.docScrollLeft();y-=this.docScrollTop();}return {x:x,y:y};},docScrollLeft:function(){if(window.pageXOffset){return window.pageXOffset;}else{if(document.documentElement&&document.documentElement.scrollLeft){return document.documentElement.scrollLeft;}else{if(document.body){return document.body.scrollLeft;}else{return 0;}}}},docScrollTop:function(){if(window.pageYOffset){return window.pageYOffset;}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop;}else{if(document.body){return document.body.scrollTop;}else{return 0;}}}}};String.prototype.parseColor=function(){var _287="#";if(this.slice(0,4)=="rgb("){var cols=this.slice(4,this.length-1).split(",");var i=0;do{_287+=parseInt(cols[i]).toColorPart();}while(++i<3);}else{if(this.slice(0,1)=="#"){if(this.length==4){for(var i=1;i<4;i++){_287+=(this.charAt(i)+this.charAt(i)).toLowerCase();}}if(this.length==7){_287=this.toLowerCase();}}}return (_287.length==7?_287:(arguments[0]||this));};Element.collectTextNodes=function(_28b){return $A($(_28b).childNodes).collect(function(node){return (node.nodeType==3?node.nodeValue:(node.hasChildNodes()?Element.collectTextNodes(node):""));}).flatten().join("");};Element.collectTextNodesIgnoreClass=function(_28d,_28e){return $A($(_28d).childNodes).collect(function(node){return (node.nodeType==3?node.nodeValue:((node.hasChildNodes()&&!Element.hasClassName(node,_28e))?Element.collectTextNodesIgnoreClass(node,_28e):""));}).flatten().join("");};Element.setContentZoom=function(_290,_291){_290=$(_290);Element.setStyle(_290,{fontSize:(_291/100)+"em"});if(navigator.appVersion.indexOf("AppleWebKit")>0){window.scrollBy(0,0);}};Element.getOpacity=function(_292){var _293;if(_293=Element.getStyle(_292,"opacity")){return parseFloat(_293);}if(_293=(Element.getStyle(_292,"filter")||"").match(/alpha\(opacity=(.*)\)/)){if(_293[1]){return parseFloat(_293[1])/100;}}return 1;};Element.setOpacity=function(_294,_295){_294=$(_294);if(_295==1){Element.setStyle(_294,{opacity:(/Gecko/.test(navigator.userAgent)&&!/Konqueror|Safari|KHTML/.test(navigator.userAgent))?0.999999:1});if(/MSIE/.test(navigator.userAgent)&&!window.opera){Element.setStyle(_294,{filter:Element.getStyle(_294,"filter").replace(/alpha\([^\)]*\)/gi,"")});}}else{if(_295<0.00001){_295=0;}Element.setStyle(_294,{opacity:_295});if(/MSIE/.test(navigator.userAgent)&&!window.opera){Element.setStyle(_294,{filter:Element.getStyle(_294,"filter").replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+_295*100+")"});}}};Element.getInlineOpacity=function(_296){return $(_296).style.opacity||"";};Element.childrenWithClassName=function(_297,_298,_299){var _29a=new RegExp("(^|\\s)"+_298+"(\\s|$)");var _29b=$A($(_297).getElementsByTagName("*"))[_299?"detect":"select"](function(c){return (c.className&&c.className.match(_29a));});if(!_29b){_29b=[];}return _29b;};Element.forceRerendering=function(_29d){try{_29d=$(_29d);var n=document.createTextNode(" ");_29d.appendChild(n);_29d.removeChild(n);}catch(e){}};Array.prototype.call=function(){var args=arguments;this.each(function(f){f.apply(this,args);});};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},tagifyText:function(_2a1){if(typeof Builder=="undefined"){throw ("Effect.tagifyText requires including script.aculo.us' builder.js library");}var _2a2="position:relative";if(/MSIE/.test(navigator.userAgent)&&!window.opera){_2a2+=";zoom:1";}_2a1=$(_2a1);$A(_2a1.childNodes).each(function(_2a3){if(_2a3.nodeType==3){_2a3.nodeValue.toArray().each(function(_2a4){_2a1.insertBefore(Builder.node("span",{style:_2a2},_2a4==" "?String.fromCharCode(160):_2a4),_2a3);});Element.remove(_2a3);}});},multiple:function(_2a5,_2a6){var _2a7;if(((typeof _2a5=="object")||(typeof _2a5=="function"))&&(_2a5.length)){_2a7=_2a5;}else{_2a7=$(_2a5).childNodes;}var _2a8=Object.extend({speed:0.1,delay:0},arguments[2]||{});var _2a9=_2a8.delay;$A(_2a7).each(function(_2aa,_2ab){new _2a6(_2aa,Object.extend(_2a8,{delay:_2ab*_2a8.speed+_2a9}));});},PAIRS:{"slide":["SlideDown","SlideUp"],"blind":["BlindDown","BlindUp"],"appear":["Appear","Fade"]},toggle:function(_2ac,_2ad){_2ac=$(_2ac);_2ad=(_2ad||"appear").toLowerCase();var _2ae=Object.extend({queue:{position:"end",scope:(_2ac.id||"global"),limit:1}},arguments[2]||{});Effect[_2ac.visible()?Effect.PAIRS[_2ad][1]:Effect.PAIRS[_2ad][0]](_2ac,_2ae);}};var Effect2=Effect;Effect.Transitions={};Effect.Transitions.linear=Prototype.K;Effect.Transitions.sinoidal=function(pos){return (-Math.cos(pos*Math.PI)/2)+0.5;};Effect.Transitions.reverse=function(pos){return 1-pos;};Effect.Transitions.flicker=function(pos){return ((-Math.cos(pos*Math.PI)/4)+0.75)+Math.random()/4;};Effect.Transitions.wobble=function(pos){return (-Math.cos(pos*Math.PI*(9*pos))/2)+0.5;};Effect.Transitions.pulse=function(pos){return (Math.floor(pos*10)%2==0?(pos*10-Math.floor(pos*10)):1-(pos*10-Math.floor(pos*10)));};Effect.Transitions.none=function(pos){return 0;};Effect.Transitions.full=function(pos){return 1;};Effect.ScopedQueue=Class.create();Object.extend(Object.extend(Effect.ScopedQueue.prototype,Enumerable),{initialize:function(){this.effects=[];this.interval=null;},_each:function(_2b6){this.effects._each(_2b6);},add:function(_2b7){var _2b8=new Date().getTime();var _2b9=(typeof _2b7.options.queue=="string")?_2b7.options.queue:_2b7.options.queue.position;switch(_2b9){case "front":this.effects.findAll(function(e){return e.state=="idle";}).each(function(e){e.startOn+=_2b7.finishOn;e.finishOn+=_2b7.finishOn;});break;case "end":_2b8=this.effects.pluck("finishOn").max()||_2b8;break;}_2b7.startOn+=_2b8;_2b7.finishOn+=_2b8;if(!_2b7.options.queue.limit||(this.effects.length<_2b7.options.queue.limit)){this.effects.push(_2b7);}if(!this.interval){this.interval=setInterval(this.loop.bind(this),40);}},remove:function(_2bc){this.effects=this.effects.reject(function(e){return e==_2bc;});if(this.effects.length==0){clearInterval(this.interval);this.interval=null;}},loop:function(){var _2be=new Date().getTime();this.effects.invoke("loop",_2be);}});Effect.Queues={instances:$H(),get:function(_2bf){if(typeof _2bf!="string"){return _2bf;}if(!this.instances[_2bf]){this.instances[_2bf]=new Effect.ScopedQueue();}return this.instances[_2bf];}};Effect.Queue=Effect.Queues.get("global");Effect.DefaultOptions={transition:Effect.Transitions.sinoidal,duration:1,fps:25,sync:false,from:0,to:1,delay:0,queue:"parallel"};Effect.Base=function(){};Effect.Base.prototype={position:null,start:function(_2c0){this.options=Object.extend(Object.extend({},Effect.DefaultOptions),_2c0||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.event("beforeStart");if(!this.options.sync){Effect.Queues.get(typeof this.options.queue=="string"?"global":this.options.queue.scope).add(this);}},loop:function(_2c1){if(_2c1>=this.startOn){if(_2c1>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");if(this.finish){this.finish();}this.event("afterFinish");return;}var pos=(_2c1-this.startOn)/(this.finishOn-this.startOn);var _2c3=Math.round(pos*this.options.fps*this.options.duration);if(_2c3>this.currentFrame){this.render(pos);this.currentFrame=_2c3;}}},render:function(pos){if(this.state=="idle"){this.state="running";this.event("beforeSetup");if(this.setup){this.setup();}this.event("afterSetup");}if(this.state=="running"){if(this.options.transition){pos=this.options.transition(pos);}pos*=(this.options.to-this.options.from);pos+=this.options.from;this.position=pos;this.event("beforeUpdate");if(this.update){this.update(pos);}this.event("afterUpdate");}},cancel:function(){if(!this.options.sync){Effect.Queues.get(typeof this.options.queue=="string"?"global":this.options.queue.scope).remove(this);}this.state="finished";},event:function(_2c5){if(this.options[_2c5+"Internal"]){this.options[_2c5+"Internal"](this);}if(this.options[_2c5]){this.options[_2c5](this);}},inspect:function(){return "#<Effect:"+$H(this).inspect()+",options:"+$H(this.options).inspect()+">";}};Effect.Parallel=Class.create();Object.extend(Object.extend(Effect.Parallel.prototype,Effect.Base.prototype),{initialize:function(_2c6){this.effects=_2c6||[];this.start(arguments[1]);},update:function(_2c7){this.effects.invoke("render",_2c7);},finish:function(_2c8){this.effects.each(function(_2c9){_2c9.render(1);_2c9.cancel();_2c9.event("beforeFinish");if(_2c9.finish){_2c9.finish(_2c8);}_2c9.event("afterFinish");});}});Effect.Opacity=Class.create();Object.extend(Object.extend(Effect.Opacity.prototype,Effect.Base.prototype),{initialize:function(_2ca){this.element=$(_2ca);if(!this.element){throw (Effect._elementDoesNotExistError);}if(/MSIE/.test(navigator.userAgent)&&!window.opera&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1});}var _2cb=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(_2cb);},update:function(_2cc){this.element.setOpacity(_2cc);}});Effect.Move=Class.create();Object.extend(Object.extend(Effect.Move.prototype,Effect.Base.prototype),{initialize:function(_2cd){this.element=$(_2cd);if(!this.element){throw (Effect._elementDoesNotExistError);}var _2ce=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(_2ce);},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop;}},update:function(_2cf){this.element.setStyle({left:Math.round(this.options.x*_2cf+this.originalLeft)+"px",top:Math.round(this.options.y*_2cf+this.originalTop)+"px"});}});Effect.MoveBy=function(_2d0,_2d1,_2d2){return new Effect.Move(_2d0,Object.extend({x:_2d2,y:_2d1},arguments[3]||{}));};Effect.Scale=Class.create();Object.extend(Object.extend(Effect.Scale.prototype,Effect.Base.prototype),{initialize:function(_2d3,_2d4){this.element=$(_2d3);if(!this.element){throw (Effect._elementDoesNotExistError);}var _2d5=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:_2d4},arguments[2]||{});this.start(_2d5);},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle("position");this.originalStyle={};["top","left","width","height","fontSize"].each(function(k){this.originalStyle[k]=this.element.style[k];}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var _2d7=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(_2d8){if(_2d7.indexOf(_2d8)>0){this.fontSize=parseFloat(_2d7);this.fontSizeType=_2d8;}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=="box"){this.dims=[this.element.offsetHeight,this.element.offsetWidth];}if(/^content/.test(this.options.scaleMode)){this.dims=[this.element.scrollHeight,this.element.scrollWidth];}if(!this.dims){this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth];}},update:function(_2d9){var _2da=(this.options.scaleFrom/100)+(this.factor*_2d9);if(this.options.scaleContent&&this.fontSize){this.element.setStyle({fontSize:this.fontSize*_2da+this.fontSizeType});}this.setDimensions(this.dims[0]*_2da,this.dims[1]*_2da);},finish:function(_2db){if(this.restoreAfterFinish){this.element.setStyle(this.originalStyle);}},setDimensions:function(_2dc,_2dd){var d={};if(this.options.scaleX){d.width=Math.round(_2dd)+"px";}if(this.options.scaleY){d.height=Math.round(_2dc)+"px";}if(this.options.scaleFromCenter){var topd=(_2dc-this.dims[0])/2;var _2e0=(_2dd-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY){d.top=this.originalTop-topd+"px";}if(this.options.scaleX){d.left=this.originalLeft-_2e0+"px";}}else{if(this.options.scaleY){d.top=-topd+"px";}if(this.options.scaleX){d.left=-_2e0+"px";}}}this.element.setStyle(d);}});Effect.Highlight=Class.create();Object.extend(Object.extend(Effect.Highlight.prototype,Effect.Base.prototype),{initialize:function(_2e1){this.element=$(_2e1);if(!this.element){throw (Effect._elementDoesNotExistError);}var _2e2=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(_2e2);},setup:function(){if(this.element.getStyle("display")=="none"){this.cancel();return;}this.oldStyle={backgroundImage:this.element.getStyle("background-image")};this.element.setStyle({backgroundImage:"none"});if(!this.options.endcolor){this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff");}if(!this.options.restorecolor){this.options.restorecolor=this.element.getStyle("background-color");}this._base=$R(0,2).map(function(i){return parseInt(this.options.startcolor.slice(i*2+1,i*2+3),16);}.bind(this));this._delta=$R(0,2).map(function(i){return parseInt(this.options.endcolor.slice(i*2+1,i*2+3),16)-this._base[i];}.bind(this));},update:function(_2e5){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(m,v,i){return m+(Math.round(this._base[i]+(this._delta[i]*_2e5)).toColorPart());}.bind(this))});},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}));}});Effect.ScrollTo=Class.create();Object.extend(Object.extend(Effect.ScrollTo.prototype,Effect.Base.prototype),{initialize:function(_2e9){this.element=$(_2e9);this.start(arguments[1]||{});},setup:function(){Position.prepare();var _2ea=Position.cumulativeOffset(this.element);if(this.options.offset){_2ea[1]+=this.options.offset;}var max=window.innerHeight?window.height-window.innerHeight:document.body.scrollHeight-(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight);this.scrollStart=Position.deltaY;this.delta=(_2ea[1]>max?max:_2ea[1])-this.scrollStart;},update:function(_2ec){Position.prepare();window.scrollTo(Position.deltaX,this.scrollStart+(_2ec*this.delta));}});Effect.Fade=function(_2ed){_2ed=$(_2ed);var _2ee=_2ed.getInlineOpacity();var _2ef=Object.extend({from:_2ed.getOpacity()||1,to:0,afterFinishInternal:function(_2f0){if(_2f0.options.to!=0){return;}_2f0.element.hide();_2f0.element.setStyle({opacity:_2ee});}},arguments[1]||{});return new Effect.Opacity(_2ed,_2ef);};Effect.Appear=function(_2f1){_2f1=$(_2f1);var _2f2=Object.extend({from:(_2f1.getStyle("display")=="none"?0:_2f1.getOpacity()||0),to:1,afterFinishInternal:function(_2f3){_2f3.element.forceRerendering();},beforeSetup:function(_2f4){_2f4.element.setOpacity(_2f4.options.from);_2f4.element.show();}},arguments[1]||{});return new Effect.Opacity(_2f1,_2f2);};Effect.Puff=function(_2f5){_2f5=$(_2f5);var _2f6={opacity:_2f5.getInlineOpacity(),position:_2f5.getStyle("position"),top:_2f5.style.top,left:_2f5.style.left,width:_2f5.style.width,height:_2f5.style.height};return new Effect.Parallel([new Effect.Scale(_2f5,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(_2f5,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(_2f7){Position.absolutize(_2f7.effects[0].element);},afterFinishInternal:function(_2f8){_2f8.effects[0].element.hide();_2f8.effects[0].element.setStyle(_2f6);}},arguments[1]||{}));};Effect.BlindUp=function(_2f9){_2f9=$(_2f9);_2f9.makeClipping();return new Effect.Scale(_2f9,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(_2fa){_2fa.element.hide();_2fa.element.undoClipping();}},arguments[1]||{}));};Effect.BlindDown=function(_2fb){_2fb=$(_2fb);var _2fc=_2fb.getDimensions();return new Effect.Scale(_2fb,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:_2fc.height,originalWidth:_2fc.width},restoreAfterFinish:true,afterSetup:function(_2fd){_2fd.element.makeClipping();_2fd.element.setStyle({height:"0px"});_2fd.element.show();},afterFinishInternal:function(_2fe){_2fe.element.undoClipping();}},arguments[1]||{}));};Effect.SwitchOff=function(_2ff){_2ff=$(_2ff);var _300=_2ff.getInlineOpacity();return new Effect.Appear(_2ff,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(_301){new Effect.Scale(_301.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(_302){_302.element.makePositioned();_302.element.makeClipping();},afterFinishInternal:function(_303){_303.element.hide();_303.element.undoClipping();_303.element.undoPositioned();_303.element.setStyle({opacity:_300});}});}},arguments[1]||{}));};Effect.DropOut=function(_304){_304=$(_304);var _305={top:_304.getStyle("top"),left:_304.getStyle("left"),opacity:_304.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(_304,{x:0,y:100,sync:true}),new Effect.Opacity(_304,{sync:true,to:0})],Object.extend({duration:0.5,beforeSetup:function(_306){_306.effects[0].element.makePositioned();},afterFinishInternal:function(_307){_307.effects[0].element.hide();_307.effects[0].element.undoPositioned();_307.effects[0].element.setStyle(_305);}},arguments[1]||{}));};Effect.Shake=function(_308){_308=$(_308);var _309={top:_308.getStyle("top"),left:_308.getStyle("left")};return new Effect.Move(_308,{x:20,y:0,duration:0.05,afterFinishInternal:function(_30a){new Effect.Move(_30a.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(_30b){new Effect.Move(_30b.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(_30c){new Effect.Move(_30c.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(_30d){new Effect.Move(_30d.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(_30e){new Effect.Move(_30e.element,{x:-20,y:0,duration:0.05,afterFinishInternal:function(_30f){_30f.element.undoPositioned();_30f.element.setStyle(_309);}});}});}});}});}});}});};Effect.SlideDown=function(_310){_310=$(_310);_310.cleanWhitespace();var _311=$(_310.firstChild).getStyle("bottom");var _312=_310.getDimensions();return new Effect.Scale(_310,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:_312.height,originalWidth:_312.width},restoreAfterFinish:true,afterSetup:function(_313){_313.element.makePositioned();_313.element.firstChild.makePositioned();if(window.opera){_313.element.setStyle({top:""});}_313.element.makeClipping();_313.element.setStyle({height:"0px"});_313.element.show();},afterUpdateInternal:function(_314){_314.element.firstChild.setStyle({bottom:(_314.dims[0]-_314.element.clientHeight)+"px"});},afterFinishInternal:function(_315){_315.element.undoClipping();if(/MSIE/.test(navigator.userAgent)&&!window.opera){_315.element.undoPositioned();_315.element.firstChild.undoPositioned();}else{_315.element.firstChild.undoPositioned();_315.element.undoPositioned();}_315.element.firstChild.setStyle({bottom:_311});}},arguments[1]||{}));};Effect.SlideUp=function(_316){_316=$(_316);_316.cleanWhitespace();var _317=$(_316.firstChild).getStyle("bottom");return new Effect.Scale(_316,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,restoreAfterFinish:true,beforeStartInternal:function(_318){_318.element.makePositioned();_318.element.firstChild.makePositioned();if(window.opera){_318.element.setStyle({top:""});}_318.element.makeClipping();_318.element.show();},afterUpdateInternal:function(_319){_319.element.firstChild.setStyle({bottom:(_319.dims[0]-_319.element.clientHeight)+"px"});},afterFinishInternal:function(_31a){_31a.element.hide();_31a.element.undoClipping();_31a.element.firstChild.undoPositioned();_31a.element.undoPositioned();_31a.element.setStyle({bottom:_317});}},arguments[1]||{}));};Effect.Squish=function(_31b){return new Effect.Scale(_31b,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(_31c){_31c.element.makeClipping(_31c.element);},afterFinishInternal:function(_31d){_31d.element.hide(_31d.element);_31d.element.undoClipping(_31d.element);}});};Effect.Grow=function(_31e){_31e=$(_31e);var _31f=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var _320={top:_31e.style.top,left:_31e.style.left,height:_31e.style.height,width:_31e.style.width,opacity:_31e.getInlineOpacity()};var dims=_31e.getDimensions();var _322,initialMoveY;var _323,moveY;switch(_31f.direction){case "top-left":_322=initialMoveY=_323=moveY=0;break;case "top-right":_322=dims.width;initialMoveY=moveY=0;_323=-dims.width;break;case "bottom-left":_322=_323=0;initialMoveY=dims.height;moveY=-dims.height;break;case "bottom-right":_322=dims.width;initialMoveY=dims.height;_323=-dims.width;moveY=-dims.height;break;case "center":_322=dims.width/2;initialMoveY=dims.height/2;_323=-dims.width/2;moveY=-dims.height/2;break;}return new Effect.Move(_31e,{x:_322,y:initialMoveY,duration:0.01,beforeSetup:function(_324){_324.element.hide();_324.element.makeClipping();_324.element.makePositioned();},afterFinishInternal:function(_325){new Effect.Parallel([new Effect.Opacity(_325.element,{sync:true,to:1,from:0,transition:_31f.opacityTransition}),new Effect.Move(_325.element,{x:_323,y:moveY,sync:true,transition:_31f.moveTransition}),new Effect.Scale(_325.element,100,{scaleMode:{originalHeight:dims.height,originalWidth:dims.width},sync:true,scaleFrom:window.opera?1:0,transition:_31f.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(_326){_326.effects[0].element.setStyle({height:"0px"});_326.effects[0].element.show();},afterFinishInternal:function(_327){_327.effects[0].element.undoClipping();_327.effects[0].element.undoPositioned();_327.effects[0].element.setStyle(_320);}},_31f));}});};Effect.Shrink=function(_328){_328=$(_328);var _329=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var _32a={top:_328.style.top,left:_328.style.left,height:_328.style.height,width:_328.style.width,opacity:_328.getInlineOpacity()};var dims=_328.getDimensions();var _32c,moveY;switch(_329.direction){case "top-left":_32c=moveY=0;break;case "top-right":_32c=dims.width;moveY=0;break;case "bottom-left":_32c=0;moveY=dims.height;break;case "bottom-right":_32c=dims.width;moveY=dims.height;break;case "center":_32c=dims.width/2;moveY=dims.height/2;break;}return new Effect.Parallel([new Effect.Opacity(_328,{sync:true,to:0,from:1,transition:_329.opacityTransition}),new Effect.Scale(_328,window.opera?1:0,{sync:true,transition:_329.scaleTransition,restoreAfterFinish:true}),new Effect.Move(_328,{x:_32c,y:moveY,sync:true,transition:_329.moveTransition})],Object.extend({beforeStartInternal:function(_32d){_32d.effects[0].element.makePositioned();_32d.effects[0].element.makeClipping();},afterFinishInternal:function(_32e){_32e.effects[0].element.hide();_32e.effects[0].element.undoClipping();_32e.effects[0].element.undoPositioned();_32e.effects[0].element.setStyle(_32a);}},_329));};Effect.Pulsate=function(_32f){_32f=$(_32f);var _330=arguments[1]||{};var _331=_32f.getInlineOpacity();var _332=_330.transition||Effect.Transitions.sinoidal;var _333=function(pos){return _332(1-Effect.Transitions.pulse(pos));};_333.bind(_332);return new Effect.Opacity(_32f,Object.extend(Object.extend({duration:3,from:0,afterFinishInternal:function(_335){_335.element.setStyle({opacity:_331});}},_330),{transition:_333}));};Effect.Fold=function(_336){_336=$(_336);var _337={top:_336.style.top,left:_336.style.left,width:_336.style.width,height:_336.style.height};Element.makeClipping(_336);return new Effect.Scale(_336,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(_338){new Effect.Scale(_336,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(_339){_339.element.hide();_339.element.undoClipping();_339.element.setStyle(_337);}});}},arguments[1]||{}));};["setOpacity","getOpacity","getInlineOpacity","forceRerendering","setContentZoom","collectTextNodes","collectTextNodesIgnoreClass","childrenWithClassName"].each(function(f){Element.Methods[f]=Element[f];});Element.Methods.visualEffect=function(_33b,_33c,_33d){s=_33c.gsub(/_/,"-").camelize();effect_class=s.charAt(0).toUpperCase()+s.substring(1);new Effect[effect_class](_33b,_33d);return $(_33b);};Element.addMethods();if(typeof console=="undefined"){console={log:function(msg){}};}function safeify(func,name){return function(){try{return func.apply(this,arguments);}catch(e){console.log("Error in "+(name||func)+" at "+e.lineNumber+": "+e);return null;}};}function find(_341,item){if(len_of(_341)){var i;for(i=0;i<_341.length;i++){if(_341[i]==item){return i;}}}return -1;}function insertBeforeInList(_344,_345,_346){if(len_of(_344)){var i;for(i=_344.length-1;i>-1;i--){_344[i+1]=_344[i];if(_344[i]==_346){_344[i]=_345;return i;}}}_344[0]=_345;return -1;}function insertAfterInList(_348,_349,_34a){if(len_of(_348)){var i;for(i=_348.length-1;i>-1;i--){_348[i+1]=_348[i];if(_348[i]==_34a){_348[i+1]=_349;return i;}}}_348[0]=_349;return -1;}function addClass(_34c,_34d){if(!hasClass(_34c,_34d)){_34c.className+=_34c.className?" "+_34d:_34d;}}function removeClass(_34e,_34f){var re=new RegExp("\\b"+_34f+"\\b");_34e.className=_34e.className.replace(re,"").trim().replace("  "," ");}function hasClass(_351,_352){return new RegExp("\\b"+_352+"\\b").test(_351.className);}function toggleClass(_353,_354){if(hasClass(_353,_354)){removeClass(_353,_354);}else{addClass(_353,_354);}}function len_of(_355){return (_355&&_355.length?_355.length:0);}function evalHTML(_356){if(typeof (_356)!="string"){return null;}_356=_356.strip();if(_356.length==0){return null;}var _357=document.createElement("DIV");_357.innerHTML="<TABLE><TBODY>"+_356+"</TBODY></TABLE>";var body=_357.firstChild.firstChild;var html=document.createDocumentFragment();var _35a;for(i=0;i<body.childNodes.length;i++){_35a=body.childNodes[i];html.appendChild(_35a);}return html;}function addLoadEvent(func){var _35c=window.onload;if(typeof window.onload!="function"){window.onload=func;}else{window.onload=function(){if(_35c){_35c();}func();};}}function toggle(obj){if(obj.style.display=="none"){obj.style.display=obj.getAttribute("desired_display");}else{obj.setAttribute("desired_display",obj.style.display);obj.style.display="none";}}function insertAfter(_35e,_35f){if(_35f.nextSibling){_35f.parentNode.insertBefore(_35e,_35f.nextSibling);}else{_35f.parentNode.appendChild(_35e);}}function debugThing(){}var AddTaskDraggable=Class.create();AddTaskDraggable.prototype=(new Rico.Draggable()).extend({initialize:function(_360,name){this.type="AddTask";this.refElement=$(_360);this.htmlElement=this.refElement;this.name=name;}});var ColumnDraggable=Class.create();ColumnDraggable.prototype=(new Rico.Draggable()).extend({initialize:function(name){this.type="Column";this.htmlElement=$(name+"-heading");this.name=name;this.parent=$("column-heading");},startDrag:function(){var _363=this.htmlElement;var _364=false;$A(this.parent.getElementsByClassName("draggable-column-heading")).each(function(col,i){if(col==_363){col.tmpIndex=null;_364=true;}else{col.tmpIndex=_364?i-1:i;}});$A($("tasks").getElementsByClassName(this.name+"-column")).each(function(col){addClass(col,"currently-dragged-column");});},__finishDrag:function(){$A($("tasks").getElementsByClassName(this.name+"-column")).each(function(col){removeClass(col,"currently-dragged-column");});},endDrag:function(){this.__finishDrag();},cancelDrag:function(){this.__finishDrag();},getSingleObjectDragGUI:function(){var el=this.htmlElement;var div=document.createElement("div");div.className="customDraggable";div.style.width=this.htmlElement.offsetWidth;var text=el.innerHTML;new Insertion.Top(div,text);return div;}});var TaskItemDraggable=Class.create();TaskItemDraggable.prototype=(new Rico.Draggable()).extend({initialize:function(_36c,_36d,_36e,name){this.type="Custom";this.refElement=$(_36d);this.htmlElement=$(_36c);this.owner=$(_36e);this.name=name;},startDrag:function(){addClass(this.refElement,"drag");this.owner.dropzones.each(function(_370){dndMgr.deregisterDropZone(_370);});var _371=function(list){$A(list).each(function(node){addClass($("draggable_"+node.getAttribute("task_id")),"undroppable");_371(node.childTasks);node.dropzones.each(function(_374){dndMgr.deregisterDropZone(_374);});});};_371(this.owner.childTasks);},cancelDrag:function(){removeClass(this.refElement,"drag");this.endDrag();},endDrag:function(){this.owner.dropzones.each(function(_375){dndMgr.registerDropZone(_375);});var reg=function(list){$A(list).each(function(node){removeClass($("draggable_"+node.getAttribute("task_id")),"undroppable");reg(node.childTasks);node.dropzones.each(function(_379){dndMgr.registerDropZone(_379);});});};reg(this.owner.childTasks);},getSingleObjectDragGUI:function(){var el=this.htmlElement;var div=document.createElement("div");div.className="customDraggable";div.style.width=this.htmlElement.offsetWidth;var text=el.innerHTML;new Insertion.Top(div,text);return div;}});var ColumnDropzone=Class.create();ColumnDropzone.prototype=(new Rico.Dropzone()).extend({lastColIndex:-1,initialize:function(name){this.colName=name;this.htmlElement=$(name+"-heading");this.absoluteRect=null;this.acceptedObjects=[];this.halfWidth=this.htmlElement.offsetWidth/2;},canAccept:function(_37e){var l=_37e[0];if(l.type!="Column"){return false;}if(l.name==this.colName){return false;}return true;},activate:function(_380){return;},showHover:function(_381,e){var _383=this.__mouseInMyLeftHalf(e);var _384=this.htmlElement.tmpIndex;if(_383){_384-=0.5;}else{_384+=0.5;}if(_384==ColumnDropzone.lastColIndex){return;}if(_383){moveSecondBeforeFirst(this.colName,_381[0].name);}else{moveSecondAfterFirst(this.colName,_381[0].name);}ColumnDropzone.lastColIndex=_384;},hideHover:function(_385){return;},__mouseInMyLeftHalf:function(e){return e.clientX<(this.getAbsoluteRect().left+this.halfWidth+(e.offsetX?document.body.scrollLeft:0));},accept:function(_387){ColumnDropzone.lastColLeft=ColumnDropzone.lastColRight=null;var _388=[];$A($("column-heading").getElementsByTagName("TH")).each(function(col){var name=col.id.replace("-heading","");if(name=="status"){return;}_388[_388.length]=name;});_388=_388.join(",");setPermalink("columnOrder",_388);}});var TaskItemDropzone=Class.create();TaskItemDropzone.prototype=(new Rico.Dropzone()).extend({initialize:function(_38b,_38c,_38d,_38e,_38f,_390){this.htmlElement=$(_38b);this.refElement=$(_38c);this.owner=$(_38d);this.absoluteRect=null;this.acceptedObjects=[];this.task_id=_38e;this.indicator=$(_390);this.drop_reparent=_38f;},showHover:function(){removeClass(this.indicator,"hidden");},activate:function(){return;},hideHover:function(){addClass(this.indicator,"hidden");},canAccept:function(_391){var l=_391.length;var i;for(i=0;i<l;i++){if(_391[i].type=="Column"){return false;}}return true;},accept:function(_394){var l=_394.length;var i;for(i=0;i<l;i++){doDrop(_394[i].refElement,this.refElement,this);}}});function createColumnDragDrop(_397){dndMgr.registerDraggable(new ColumnDraggable(_397));dndMgr.registerDropZone(new ColumnDropzone(_397));}function createDragDrop(){if(!initialized&&hasReorderableTasks()){initialized=true;dndMgr.registerDropZone(new TaskItemDropzone("sibling_dropzone_0","sibling_dropzone_0",0,0,false,"sibling_dropzone_indicator_0"));$A($("tasks").getElementsByClassName("task-item")).each(function(node){enableDragDrop(node);});if($("deadline-heading")){createColumnDragDrop("deadline");}if($("updated-heading")){createColumnDragDrop("updated");}if($("priority-heading")){createColumnDragDrop("priority");}if($("owner-heading")){createColumnDragDrop("owner");}}}function enableDragDrop(node){var id=node.getAttribute("task_id");dndMgr.registerDraggable(node.draggable=new TaskItemDraggable("draggable_"+id,"draggable_"+id,node.id,"draggable-name"));node.dropzones=[];dndMgr.registerDropZone(node.dropzones[0]=new TaskItemDropzone("child_dropzone_"+id,"child_dropzone_"+id,node.id,id,true,"child_dropzone_indicator_"+id));dndMgr.registerDropZone(node.dropzones[1]=new TaskItemDropzone("sibling_dropzone_"+id,"sibling_dropzone_"+id,node.id,id,false,"sibling_dropzone_indicator_"+id));}var myrules={".draggable":function(_39b){_39b.onclick=function(e){e=e||event;if(hasClass(_39b,"drag")){removeClass(_39b,"drag");return false;}else{if(e.target&&e.target.doclick){return e.target.doclick(e);}else{if(e.srcElement&&e.srcElement.doclick){return e.srcElement.doclick(e);}}}};},"img.treewidget":function(_39d){_39d.doclick=function(){toggleCollapse(_39d.id.replace("handle_",""));return false;};},"a.task_item":function(_39e){_39e.doclick=function(){return true;};},"a#show_description":function(_39f){_39f.onclick=function(){$("hideable_add_description").hide();$("hideable_title_label").show();$("description_field").show();$("text").focus();return false;};},".post-link":function(_3a0){var form=Builder.node("form",{action:_3a0.getAttribute("href"),method:"POST"});form.style.display="inline";_3a0.parentNode.insertBefore(form,_3a0);_3a0.onclick=function(){var msg=_3a0.getAttribute("confirm_msg");if((msg&&confirm(msg))||!msg){form.submit();}return false;};},"th.draggable-column-heading":function(_3a3){_3a3.onclick=function(){if(!this.columnName){this.columnName=this.id.replace("-heading","");}sortBy(this.columnName);return false;};},".unfolded":function(_3a4){_3a4.onclick=unfold;},"a.uses_permalink":function(_3a5){var _3a6=$("permalink");if(_3a6){_3a5.href=_3a5.getAttribute("base_href")+"?"+_3a6.getAttribute("permalink");}}};Behavior.register(myrules);function showFilterColumn(_3a7){$(_3a7+"-filter-label").hide();$(_3a7+"_filter").show();$(_3a7+"_filter").focus();}function hasTasks(){return $("tasks");}function hasReorderableTasks(){var _3a8=hasTasks();return _3a8&&_3a8.getAttribute("hasReorderableTasks")=="True"&&_3a8.getElementsByTagName("TH").length;}function setTaskParents(){var _3a9=hasTasks();if(_3a9){$A(_3a9.getElementsByClassName("task-item")).each(function(task){var _3ab;var _3ac;if(!task.childTasks){task.childTasks=[];}if((_3ab=task.getAttribute("parentID"))&&(_3ac=$("task_"+_3ab))){if(len_of(_3ac.childTasks)){_3ac.childTasks[_3ac.childTasks.length]=task;}else{_3ac.childTasks=[task];}}});}}function setupEmptyList(){in_task_show=$("subtasks")?1:0;if($("tasks")&&!($("tasks").getElementsByClassName("task-item").length)&&!in_task_show){showTaskCreate();}}function filterDeadline(task){var _3ae=$("deadline_filter").value;if(_3ae=="All"){return false;}var _3af=task.getAttribute("deadline");if(_3ae=="None"){if(_3af!="None"){return true;}else{return false;}}if(_3af=="None"){return true;}var _3b0=_3ae.split(",");if(_3b0.length==1){var _3b1=new Date();_3b1.setHours(0,0,0,0);_3b1.setDate(_3b1.getDate()+parseInt(_3b0[0]));var db=new DateBocks();_3af=db.parseDateString(_3af);_3af.setHours(0,0,0,0);return !_3b1.equalsTo(_3af);}var min;var max;min=parseInt(_3b0[0]);max=parseInt(_3b0[1]);var _3b5=new Date();_3b5.setHours(0,0,0,0);var _3b6=new Date();_3b6.setHours(0,0,0,0);_3b5.setDate(_3b5.getDate()-min);_3b6.setDate(_3b6.getDate()+max+1);var db=new DateBocks();var _3b8=db.parseDateString(_3af);if(_3b8>_3b6){return true;}if(min<max&&(_3b8<=_3b5)){return true;}return false;}function filterUpdated(task){var _3ba=$("updated_filter").value;if(_3ba=="All"){return false;}if(_3ba=="None"){if(task.getAttribute("updated")){return true;}else{return false;}}var _3bb=_3ba.split(",");var min;var max;if(_3bb.length==1){min=-1*parseInt(_3bb[0]);max=parseInt(_3bb[0]);}else{min=-1*parseInt(_3bb[0]);max=-1*parseInt(_3bb[1]);}var _3be=new Date();var _3bf=new Date();_3be.setDate(_3be.getDate()-min);_3bf.setDate(_3bf.getDate()+max+1);var _3c0=task.getAttribute("updated");if(_3c0){var db=new DateBocks();var _3c2=db.parseDateString(_3c0);if(!(_3c2<_3bf)){return true;}if(min>=max&&!(_3c2>=_3be)){return true;}return false;}else{return true;}}function filterField(_3c3,task){if(_3c3=="deadline"){return filterDeadline(task);}if(_3c3=="updated"){return filterUpdated(task);}var _3c5=$(_3c3+"_filter").value.replace(" ","%20");if(_3c5=="All"){return false;}if(_3c3=="status"&&_3c5=="All%20Uncompleted"){return (task.getAttribute(_3c3)=="done");}return (task.getAttribute(_3c3)!=_3c5);}function filterNodeByAllFields(node){var _3c7=false;var _3c8=$("task_"+node.getAttribute("parentID"));node.depth_adjustment=0;if(_3c8){node.depth_adjustment=_3c8.depth_adjustment||0;}$A(["status","deadline","priority","owner","updated"]).each(function(_3c9){var _3ca=false;var _3cb=$(_3c9+"_filter");if(!_3cb){return;}var _3cc=_3cb.value;setPermalink(_3c9,_3cc);if(_3cc=="All"){_3ca=true;}if(!_3ca&&!_3c7){if(filterField(_3c9,node)){var _3cd=$("second_line_"+node.getAttribute("task_id"));if(_3cd){_3cd.hide();}--node.depth_adjustment;_3c7=true;}}reindentTask(node.getAttribute("task_id"),node.depth_adjustment);});return _3c7;}function filterListByAllFields(){$A($("tasks").getElementsByClassName("task-item")).each(function(node){if(filterNodeByAllFields(node)){node.hide();$("second_line_"+node.getAttribute("task_id")).hide();}else{node.show();$("second_line_"+node.getAttribute("task_id")).show();}});}filterLookups=new Object;filterLookups.deadline=new Object;filterLookups.deadline["Past due"]="-1";filterLookups.deadline["Due today"]="0";filterLookups.deadline["Due tomorrow"]="1";filterLookups.deadline["Due in the next week"]="0,7";filterLookups.deadline["No deadline"]="None";filterLookups.priority=new Object;filterLookups.priority["No priority"]="None";filterLookups.owner=new Object;filterLookups.owner["No owner"]="None";filterLookups.updated=new Object;filterLookups.updated["Today"]="0";filterLookups.updated["Yesterday"]="-1";filterLookups.updated["In the past week"]="-7,0";function sortAndFilter(){if(!hasReorderableTasks()||!$("permalink")){return;}var _3cf=$("permalink").getAttribute("permalink");_3cf=_3cf.split("&");var i;var _3d1=false;var _3d2=false;var _3d3=false;for(i=0;i<_3cf.length;++i){var key=_3cf[i].split("=");var val=key[1];key=key[0];if(key=="sortBy"){_3d2=val;}else{if(key=="sortOrder"){if(val=="up"||val=="down"){_3d3=val;}}else{var _3d6=$(key+"_filter");if(_3d6){_3d6.value=val;if(_3d6.value!=val){val=filterLookups[key][val];_3d6.value=val;}if(_3d6.value==val){_3d1=true;}}}}}if(_3d2){sortBy(_3d2,_3d3);}if(_3d1){filterListByAllFields();}}function viewChangeableField(_3d7,_3d8){selected_form=$(_3d8+"-form_"+_3d7);selected_label=$(_3d8+"-label_"+_3d7);selected_label.hide();selected_form.show();$(_3d8+"_"+_3d7).focus();}function hideChangeableField(_3d9,_3da){selected_form=null;selected_label=null;$(_3da+"-form_"+_3d9).hide();$(_3da+"-label_"+_3d9).show();}function restoreAddTask(){$("add_task_anchor").appendChild($("movable_add_task"));showTaskCreate();$("add_task_form_parentID").setAttribute("value",0);$("add_task_form_siblingID").setAttribute("value",0);return false;}function doneAddingTask(req){$("error").innerHTML="";var _3dc=parseInt($("add_task_form_parentID").getAttribute("value"));var _3dd=parseInt($("add_task_form_siblingID").getAttribute("value"));var _3de=evalHTML(req.responseText);var _3df=_3de.firstChild;var _3e0=$("no_tasks_placeholder");if(_3e0){_3e0.parentNode.removeChild(_3e0);}var _3e1=$("tasks");if(_3dd!=0){var _3e2=$("task_"+_3dd);insertAfter(_3de,_3e2);}else{if(_3dc!=0&&!hasClass(_3e1,"all_tasks")){var _3e3=$("task_"+_3dc);insertAfter(_3de,_3e3);updateTaskItem(_3dc);if($("movable_add_task")){$("movable_add_task").parentNode.appendChild($("movable_add_task"));}}else{target=_3e1;for(i=0;i<_3e1.childNodes.length;++i){child=_3e1.childNodes[i];if(child.tagName=="TBODY"){target=child;break;}}tt=target;nf=_3de;target.appendChild(_3de);}}_3df.childTasks=[];enableDragDrop(_3df);Behavior.apply();$A($("add_task_form").getElements()).each(function(node){if(node.type=="checkbox"){node.checked=false;}else{if(node.type=="submit"||node.type=="hidden"){return;}else{node.value="";}}});$("title").focus();if($("post_add_task")){eval($("post_add_task").getAttribute("func"))();}return;}doneAddingTask=safeify(doneAddingTask,"doneAddingTask");function failedAddingTask(req){$("error").innerHTML=req.responseText;console.log("failed to add task");}function changeField(_3e6,_3e7){if(changeEventsDisabled){return;}var _3e8=$(_3e7+"_"+_3e6);_3e8.disabled=true;var _3e9=$("authenticator").value;var _3ea=$("global-values").getAttribute("change_url");var url=_3ea+_3e6+"?field="+_3e7+"&authenticator="+_3e9;var _3ec=(_3e8.type=="checkbox")?_3e8.checked:_3e8.value;_3ec=encodeURIComponent(_3ec);var _3ed=$("task_"+_3e6);var _3ee=_3ed.getAttribute("is_preview");var _3ef=_3ed.getAttribute("is_flat");var _3f0=_3ed.getAttribute("editable_title");var _3f1=$("global-values");_3f1=(_3f1?_3f1.getAttribute("depth"):0);var _3f2;if($("permalink")){_3f2=$("permalink").getAttribute("permalink");if(_3f2){_3f2=_3f2.match(/columnOrder=[\w,]+/);if(_3f2){_3f2=_3f2[0];}}}var req=new Ajax.Request(url,{asynchronous:true,evalScripts:true,method:"post",parameters:_3e7+"="+_3ec+"&is_preview="+_3ee+"&is_flat="+_3ef+"&editable_title="+_3f0+"&depth="+_3f1+(_3f2?"&columnOrder="+_3f2:""),onSuccess:doneChangingField.bind([_3e6,_3e7]),onFailure:failedChangingField.bind([_3e6,_3e7])});}var selected_form;var selected_label;function recalculateUncompletedChildren(_3f4){var _3f5=0;var _3f6=function(task){if(task.getAttribute("status")!="done"){++_3f5;}task.childTasks.each(function(_3f8){_3f6(_3f8);});};_3f4.childTasks.each(function(_3f9){_3f6(_3f9);});var _3fa=_3f4.getElementsByClassName("num_subtasks")[0];_3fa.innerHTML=_3f5;if(_3f5==0){_3fa.parentNode.hide();}else{_3fa.parentNode.show();}var _3fb=_3f4.getElementsByClassName("the-word-task")[0];if(_3f5==1){_3fb.innerHTML="task";}else{_3fb.innerHTML="tasks";}}function updateTaskItem(_3fc){var _3fd=$("title_"+_3fc);var _3fe=$("task_"+_3fc);var _3ff=$("handle_"+_3fc);var _400;if(_3fe.getAttribute("status")=="done"){_400="completed-task";}else{var db=new DateBocks();var date=_3fe.getAttribute("deadline");_400="uncompleted-task";if(date&&date!="None"){var now=new Date();if(date&&db.parseDateString(date)<now){_400="overdue-task";}}}var root;if(_3fe.childNodes[1].nodeType==1){root=(parseInt(_3fe.childNodes[1].getAttribute("depth"))===0)?"root-task":"sub-task";}else{root="root-task";}_3fd.setAttribute("class",_400+" "+root);if(len_of(_3fe.childTasks)){expandTask(_3fc);}else{flattenTask(_3fc);}recalculateUncompletedChildren(_3fe);uncompletedTasks=0;$A(document.getElementsByClassName("task-item")).each(function(task){if(task.getAttribute("status")!="done"){++uncompletedTasks;}});}function revertField(_406,_407){var _408=$(_407+"_"+_406);var orig=_408.getAttribute("originalvalue");var _40a=$(_407+"-label_"+_406);_408.value=orig;_40a.innerHTML=orig;hideChangeableField(_406,_407);}function doneChangingField(req){if(req.status==200){succeededChangingField.bind(this)(req);}else{failedChangingField.bind(this)(req);}}function updateParentTask(_40c){recalculateUncompletedChildren(_40c);var _40d=_40c.getAttribute("parentID");if(_40d){var _40e=$("task_"+_40d);if(_40e){updateParentTask(_40e);}}}function succeededChangingField(req){var _410=this[0];var _411=this[1];var _412=$(_411+"_"+_410);_412.disabled=false;var _413=evalHTML(req.responseText);var _414=$("task_"+_410);var _415=$("task_"+_414.getAttribute("parentID"));_414.parentNode.replaceChild(_413,_414);_413=$("task_"+_410);_413.childTasks=_414.childTasks;var _416;if(_415&&len_of(_415.childTasks)){for(_416=0;_416<_415.childTasks.length;_416++){if(_415.childTasks[_416]==_414){break;}}}if(_415&&_415.getAttribute("is_flat")!="True"){if(len_of(_415.childTasks)){if(_416>=_415.childTasks.length){_415.childTasks[length]=_413;}else{insertBeforeInList(_415.childTasks,_413,_415.childTasks[_416]);}}else{_415.childTasks[0]=_413;}_415.childTasks.removeItem(_414);}if($("post_edit_task")){func=eval($("post_edit_task").getAttribute("func"));func(_410,_411);}enableDragDrop(_413);if(_415){updateParentTask(_415);}}function failedChangingField(req){var _418=this[0];var _419=this[1];var _41a=$(_419+"_"+_418);var _41b=$(_419+"-label_"+_418);revertField(_418,_419);_41a.disabled=false;_41b.style.color="red";}function reindentTask(_41c,_41d){var task=$("task_"+_41c);var _41f=task.getElementsByTagName("SPAN")[0];var _420=$$("#task_"+_41c+" .handle")[0];var _421=parseInt(_41f.getAttribute("depth"))+_41d;_420.style.marginLeft=15*_421+"px";}function doneMovingTask(req){var _423=eval(req.responseText);var _424=$$("#breaking-row")[0].parentNode;var _425=_424;_423.each(function(_426){var task=$("task_"+_426.id);if(_426.has_children){expandTask(_426.id);}else{flattenTask(_426.id);}var _428=_426.depth;var _429=task.getElementsByTagName("SPAN")[0];_429.setAttribute("depth",_428);var _42a=$$("#task_"+_426.id+" .handle")[0];_42a.style.marginLeft=15*_428+"px";var _42b=$("second_line_"+_426.id);insertAfter(task,_425);insertAfter(_42b,task);_425=_42b;});}function showTaskCreate(){removeClass($("create"),"hidden");$("show_create").hide();$("title").focus();return false;}var mode="view";function doneDestroyingTask(req){var _42d=this;$("task_"+_42d).remove();$("second_line_"+_42d).remove();}function failedDestroyingTask(req){var _42f=this;$("task_"+_42f).show();$("second_line_"+_42f).show();}function destroyTask(_430,_431){var _432=_430.getAttribute("task_id");$("task_"+_432).hide();$("second_line_"+_432).hide();var req=new Ajax.Request("/task/destroy/"+_432,{asynchronous:true,evalScripts:true,method:"post",onSuccess:doneDestroyingTask.bind(_432),onFailure:failedDestroyingTask.bind(_432)});}function doDrop(_434,_435,_436){var id;if(_435==_434){return;}if(!_434.id.match("draggable")){if(_435.id.match(/^title_/)){id=parseInt(_435.id.replace(/^title_/,""));$("add_task_form_parentID").setAttribute("value",id);$("add_task_form_siblingID").setAttribute("value",0);var _438=$("task_"+id);var tr=document.createElement("TR");tr.className="taskrow";var td=document.createElement("TD");td.appendChild(_434);tr.appendChild(td);insertAfter(tr,_438);}else{id=parseInt(_435.id.replace(/^handle_/,""));$("add_task_form_parentID").setAttribute("value",0);$("add_task_form_siblingID").setAttribute("value",id);var _43b=$("task_"+id);var _43c=_43b.parentNode;var tr=document.createElement("TR");tr.className="taskrow";tr.appendChild(_434);insertAfter(_434,_43b);}return;}var _43e=_434.id.replace("draggable_","");var _43f=$("task_"+_43e).getAttribute("parentID");id=parseInt(_436.task_id);var _440=$("global-values").getAttribute("move_url");if(_436.drop_reparent){var _441=$("task_"+id);new Ajax.Request(_440+_43e,{asynchronous:true,evalScripts:true,method:"post",parameters:"new_parent="+id,onSuccess:doneMovingTask,onFailure:debugThing});}else{var _442=$("task_"+id);new Ajax.Request(_440+_43e,{asynchronous:true,evalScripts:true,method:"post",parameters:"new_sibling="+id,onSuccess:doneMovingTask,onFailure:debugThing});}}function removeRow(ul,row){ul.removeChild(row);var id=row.getAttribute("task_id");row.second_line=$("second_line_"+id);ul.removeChild(row.second_line);}function sortListBy(ul,_447,_448,_449){if(!_449){_449="0";}items=$A(ul.getElementsByClassName("task-item")).filter(function(i){return i.getAttribute("parentID")==_449;});var _44b=(_447=="priority");var _44c={"High":1,"Medium":2,"Low":3,"None":4};for(i=0;i<items.length;i++){var item=items[i];var _44e=item.getAttribute(_447);var _44f=item.getAttribute("sort_index");if(_44b){key=_44c[_44e];}else{if(_44e){key=_44e;}else{if(_448==1){key=undefined;}else{key=0;}}}items[i]=[key,_44f,item];}items=items.sort();if(_448<0){items=items.reverse();}ul=ul.getElementsByTagName("TBODY")[0];for(i=0;i<items.length;i++){var item=items[i][2];items[i]=item;removeRow(ul,item);$A(item.childTasks).each(function(i){removeRow(ul,i);});}items.each(function(x){ul.appendChild(x);ul.appendChild(x.second_line);$A(x.childTasks).each(function(i){ul.appendChild(i);ul.appendChild(i.second_line);});if(len_of(x.childTasks)){sortListBy($("tasks"),_447,_448,x.getAttribute("task_id"));}});}function setCollapse(_454,val){var node=$("task_"+_454);var _457=$("handle_"+_454);var _458=val?"minus.png":"plus.png";if(val){if(!filterNodeByAllFields(node)){node.show();$("second_line_"+_454).show();}}else{node.hide();$("second_line_"+_454).hide();}if(!val||_457.src.match("plus.png")){$A(node.childTasks).each(function(n){setCollapse(n.getAttribute("task_id"),val);});}}function toggleCollapse(_45a){var _45b=$("handle_"+_45a);if(_45b.src.match("minus.png")){_45b.src=_45b.src.replace("minus.png","plus.png");$A($("task_"+_45a).childTasks).each(function(node){setCollapse(node.getAttribute("task_id"),1);});}else{if(_45b.src.match("plus.png")){_45b.src=_45b.src.replace("plus.png","minus.png");$A($("task_"+_45a).childTasks).each(function(node){setCollapse(node.getAttribute("task_id"),0);});}}}function expandTask(_45e){var _45f=$("handle_"+_45e);if(_45f.src.match("blank.png")){_45f.src=_45f.src.replace("blank.png","plus.png");}else{if(_45f.src.match("minus.png")){toggleCollapse(_45e);}}}function flattenTask(_460){var _461=$("handle_"+_460);_461.src=_461.src.replace(/(plus|minus).png$/,"blank.png");}function sortBy(_462,_463){$A(document.getElementsByClassName("sort-arrows")).each(function(e){e.hide();});$A(document.getElementsByClassName("column-heading")).each(function(e){if(hasClass(e,_462+"-column")){if(!_463){_463=e.getAttribute("sortOrder")=="up"?"down":"up";}e.setAttribute("sortOrder",_463);addClass(e,"selected-column");_463=e.getAttribute("sortOrder");}else{e.setAttribute("sortOrder","");removeClass(e,"selected-column");}});$(_462+"-arrows").show();var _466=(_463=="up")?"down":"up";addClass($(_462+"-"+_466+"-arrow"),"grayed-out");removeClass($(_462+"-"+_463+"-arrow"),"grayed-out");setPermalink("sortBy",_462);setPermalink("sortOrder",_463);sortListBy($("tasks"),_462,_463=="up"?1:-1);}var initialized=false;function unfold(){var _467=$("edit_"+this.id);_467.style["display"]="block";$(this).hide();}function setPermalink(_468,_469){var _46a=$("permalink");if(!_46a){return;}var _46b=_46a.getAttribute("permalink");function wrapitup(){_46a.setAttribute("permalink",_46b);_46a.href=_46a.getAttribute("base")+"?"+_46a.getAttribute("permalink");Behavior.applySelectedRule("a.uses_permalink");}var _46c=_46b.split("&");var i;for(i=0;i<_46c.length;++i){var key=_46c[i].split("=");var val=key[1];var key=key[0];if(key==_468){if(_469=="All"){_46b=_46b.replace(key+"="+val+"&","");}else{_46b=_46b.replace(key+"="+val,_468+"="+_469);}wrapitup();return;}}if(_469=="All"){return;}_46b+=(_468+"="+_469+"&");wrapitup();}function onBodyClick(_471){trigger=Event.element(_471);node=trigger;while(node.parentNode){if(node==selected_form){return;}node=node.parentNode;}if(selected_form){selected_form.hide();selected_form=null;selected_label.show();selected_label=null;}}function moveSecondNextToFirst(a,b,_474){var x=a+"-column";var y=b+"-column";$A($("tasks").getElementsByTagName("TR")).each(function(row){var one=row.getElementsByClassName(x)[0];var two=row.getElementsByClassName(y)[0];if(one&&two){if(_474){row.insertBefore(two,one);}else{insertAfter(two,one);}}});}function moveSecondBeforeFirst(a,b){moveSecondNextToFirst(a,b,true);}function moveSecondAfterFirst(a,b){moveSecondNextToFirst(a,b,false);}Event.observe(document,"mousedown",onBodyClick);addLoadEvent(createDragDrop);addLoadEvent(setupEmptyList);addLoadEvent(setTaskParents);addLoadEvent(sortAndFilter);function utc(d){return Date.UTC(d.getFullYear(),d.getMonth(),d.getDate());}function date_diff(_47f,_480){var _481=utc(_47f);var _482=utc(_480);return (_481-_482)/86400000;}function dayOfWeek(day){return "SunMonTueWedThuFriSatSun".substr(day*3,3);}function monthName(_484){var _485=["January","February","March","April","May","June","July","August","September","October","November","December"];return _485[_484];}function pretty_date_engine(now,date){var diff=date_diff(date,now);if(diff==-1){return "Yesterday";}if(diff==0){return "Today";}if(diff==1){return "Tomorrow";}if(diff<7&&diff>0){return dayOfWeek(date.getDay());}if(diff<90&&date.getYear()==now.getYear()){return monthName(date.getMonth())+" "+date.getDate();}return monthName(date.getMonth())+" "+date.getDate()+", "+date.getFullYear();}function pretty_date_from_text(text,now){if(text=="No deadline"){return text;}console.log(text);parts=text.split("/");return pretty_date(new Date(parseInt(parts[2],10),parseInt(parts[0],10)-1,parseInt(parts[1],10)),now);}function pretty_date(date,now){if(!now){now=new Date();}return pretty_date_engine(now,date);}function test_pretty_date(){var now=new Date(2006,0,1);var _48e=[["Today",new Date(2006,0,1)],["Tomorrow",new Date(2006,0,2)],["Yesterday",new Date(2005,11,31)],["December 30, 2005",new Date(2005,11,30)],["Tue",new Date(2006,0,3)],["Sat",new Date(2006,0,7)],["January 8",new Date(2006,0,8)],["December 8, 2006",new Date(2006,11,8)],["January 8, 2007",new Date(2007,0,8)]];var i;for(i=0;i<_48e.length;i++){var date=_48e[i][1];var pd=pretty_date_engine(now,date);if(pd!=_48e[i][0]){alert("failure mapping "+date+" to "+_48e[i][0]+", got "+pd);}}now=new Date(2006,0,1);_48e=[["Today","01/01/2006"],["Tomorrow","01/02/2006"],["Yesterday","12/31/2005"],["December 30, 2005","12/30/2005"],["Tue","01/03/2006"],["Sat","01/07/2006"],["January 8","01/08/2006"],["December 8, 2006","12/08/2006"],["January 8, 2007","01/08/2007"]];var i;for(i=0;i<_48e.length;i++){var date=_48e[i][1];var pd=pretty_date_from_text(date,now);if(pd!=_48e[i][0]){alert("failure mapping "+date+" to "+_48e[i][0]+", got "+pd);}}}var Builder={NODEMAP:{AREA:"map",CAPTION:"table",COL:"table",COLGROUP:"table",LEGEND:"fieldset",OPTGROUP:"select",OPTION:"select",PARAM:"object",TBODY:"table",TD:"table",TFOOT:"table",TH:"table",THEAD:"table",TR:"table"},node:function(_495){_495=_495.toUpperCase();var _496=this.NODEMAP[_495]||"div";var _497=document.createElement(_496);try{_497.innerHTML="<"+_495+"></"+_495+">";}catch(e){}var _498=_497.firstChild||null;if(_498&&(_498.tagName!=_495)){_498=_498.getElementsByTagName(_495)[0];}if(!_498){_498=document.createElement(_495);}if(!_498){return;}if(arguments[1]){if(this._isStringOrNumber(arguments[1])||(arguments[1] instanceof Array)){this._children(_498,arguments[1]);}else{var _499=this._attributes(arguments[1]);if(_499.length){try{_497.innerHTML="<"+_495+" "+_499+"></"+_495+">";}catch(e){}_498=_497.firstChild||null;if(!_498){_498=document.createElement(_495);for(attr in arguments[1]){_498[attr=="class"?"className":attr]=arguments[1][attr];}}if(_498.tagName!=_495){_498=_497.getElementsByTagName(_495)[0];}}}}if(arguments[2]){this._children(_498,arguments[2]);}return _498;},_text:function(text){return document.createTextNode(text);},_attributes:function(_49b){var _49c=[];for(attribute in _49b){_49c.push((attribute=="className"?"class":attribute)+"=\""+_49b[attribute].toString().escapeHTML()+"\"");}return _49c.join(" ");},_children:function(_49d,_49e){if(typeof _49e=="object"){_49e.flatten().each(function(e){if(typeof e=="object"){_49d.appendChild(e);}else{if(Builder._isStringOrNumber(e)){_49d.appendChild(Builder._text(e));}}});}else{if(Builder._isStringOrNumber(_49e)){_49d.appendChild(Builder._text(_49e));}}},_isStringOrNumber:function(_4a0){return (typeof _4a0=="string"||typeof _4a0=="number");}};if(typeof Effect=="undefined"){throw ("controls.js requires including script.aculo.us' effects.js library");}var changeEventsDisabled=false;function reEnableChangeEvents(){changeEventsDisabled=false;}var Autocompleter={};Autocompleter.Base=function(){};Autocompleter.Base.prototype={baseInitialize:function(_4a1,_4a2,_4a3){this.element=$(_4a1);this.update=$(_4a2);this.hasFocus=false;this.changed=false;this.active=false;this.index=0;this.entryCount=0;if(this.setOptions){this.setOptions(_4a3);}else{this.options=_4a3||{};}this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.onShow=this.options.onShow||function(_4a4,_4a5){if(!_4a5.style.position||_4a5.style.position=="absolute"){_4a5.style.position="absolute";Position.clone(_4a4,_4a5,{setHeight:false,offsetTop:_4a4.offsetHeight});}Effect.Appear(_4a5,{duration:0.15});};this.options.onHide=this.options.onHide||function(_4a6,_4a7){new Effect.Fade(_4a7,{duration:0.15});};if(typeof (this.options.tokens)=="string"){this.options.tokens=new Array(this.options.tokens);}this.observer=null;this.element.setAttribute("autocomplete","off");Element.hide(this.update);Event.observe(this.element,"blur",this.onBlur.bindAsEventListener(this));Event.observe(this.element,"keypress",this.onKeyPress.bindAsEventListener(this));},show:function(){if(Element.getStyle(this.update,"display")=="none"){this.options.onShow(this.element,this.update);}if(!this.iefix&&(navigator.appVersion.indexOf("MSIE")>0)&&(navigator.userAgent.indexOf("Opera")<0)&&(Element.getStyle(this.update,"position")=="absolute")){new Insertion.After(this.update,"<iframe id=\""+this.update.id+"_iefix\" "+"style=\"display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);\" "+"src=\"javascript:false;\" frameborder=\"0\" scrolling=\"no\"></iframe>");this.iefix=$(this.update.id+"_iefix");}if(this.iefix){setTimeout(this.fixIEOverlapping.bind(this),50);}},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:(!this.update.style.height)});this.iefix.style.zIndex=1;this.update.style.zIndex=2;Element.show(this.iefix);},hide:function(){this.stopIndicator();if(Element.getStyle(this.update,"display")!="none"){this.options.onHide(this.element,this.update);}if(this.iefix){Element.hide(this.iefix);}},startIndicator:function(){if(this.options.indicator){Element.show(this.options.indicator);}},stopIndicator:function(){if(this.options.indicator){Element.hide(this.options.indicator);}},onKeyPress:function(_4a8){if(this.active){switch(_4a8.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();Event.stop(_4a8);case Event.KEY_ESC:this.hide();this.active=false;Event.stop(_4a8);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();if(navigator.appVersion.indexOf("AppleWebKit")>0){Event.stop(_4a8);}return;case Event.KEY_DOWN:this.markNext();this.render();if(navigator.appVersion.indexOf("AppleWebKit")>0){Event.stop(_4a8);}return;}}else{if(_4a8.keyCode==Event.KEY_TAB||_4a8.keyCode==Event.KEY_RETURN||(navigator.appVersion.indexOf("AppleWebKit")>0&&_4a8.keyCode==0)){return;}}this.changed=true;this.hasFocus=true;if(this.observer){clearTimeout(this.observer);}this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000);},activate:function(){this.changed=false;this.hasFocus=true;this.getUpdatedChoices();},onHover:function(_4a9){var _4aa=Event.findElement(_4a9,"LI");if(this.index!=_4aa.autocompleteIndex){this.index=_4aa.autocompleteIndex;this.render();}Event.stop(_4a9);},onClick:function(_4ab){changeEventsDisabled=false;var _4ac=Event.findElement(_4ab,"LI");this.index=_4ac.autocompleteIndex;this.selectEntry();this.hide();},onBlur:function(_4ad){changeEventsDisabled=true;setTimeout(reEnableChangeEvents,250);setTimeout(this.hide.bind(this),250);this.hasFocus=false;this.active=false;},render:function(){if(this.entryCount>0){for(var i=0;i<this.entryCount;i++){this.index==i?Element.addClassName(this.getEntry(i),"selected"):Element.removeClassName(this.getEntry(i),"selected");}if(this.hasFocus){this.show();this.active=true;}}else{this.active=false;this.hide();}},markPrevious:function(){if(this.index>0){this.index--;}else{this.index=this.entryCount-1;}this.getEntry(this.index).scrollIntoView(true);},markNext:function(){if(this.index<this.entryCount-1){this.index++;}else{this.index=0;}this.getEntry(this.index).scrollIntoView(false);},getEntry:function(_4af){return this.update.firstChild.childNodes[_4af];},getCurrentEntry:function(){return this.getEntry(this.index);},selectEntry:function(){this.active=false;this.updateElement(this.getCurrentEntry());},updateElement:function(_4b0){if(this.options.updateElement){this.options.updateElement(_4b0);return;}var _4b1="";if(this.options.select){var _4b2=document.getElementsByClassName(this.options.select,_4b0)||[];if(_4b2.length>0){_4b1=Element.collectTextNodes(_4b2[0],this.options.select);}}else{_4b1=Element.collectTextNodesIgnoreClass(_4b0,"informal");}var _4b3=this.findLastToken();if(_4b3!=-1){var _4b4=this.element.value.substr(0,_4b3+1);var _4b5=this.element.value.substr(_4b3+1).match(/^\s+/);if(_4b5){_4b4+=_4b5[0];}this.element.value=_4b4+_4b1;}else{this.element.value=_4b1;}this.element.focus();if(this.options.afterUpdateElement){this.options.afterUpdateElement(this.element,_4b0);}},updateChoices:function(_4b6){if(!this.changed&&this.hasFocus){this.update.innerHTML=_4b6;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.firstChild);if(this.update.firstChild&&this.update.firstChild.childNodes){this.entryCount=this.update.firstChild.childNodes.length;for(var i=0;i<this.entryCount;i++){var _4b8=this.getEntry(i);_4b8.autocompleteIndex=i;this.addObservers(_4b8);}}else{this.entryCount=0;}this.stopIndicator();this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide();}else{this.render();}}},addObservers:function(_4b9){Event.observe(_4b9,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(_4b9,"click",this.onClick.bindAsEventListener(this));},onObserverEvent:function(){this.changed=false;if(this.getToken().length>=this.options.minChars){this.startIndicator();this.getUpdatedChoices();}else{this.active=false;this.hide();}},getToken:function(){var _4ba=this.findLastToken();if(_4ba!=-1){var ret=this.element.value.substr(_4ba+1).replace(/^\s+/,"").replace(/\s+$/,"");}else{var ret=this.element.value;}return /\n/.test(ret)?"":ret;},findLastToken:function(){var _4bd=-1;for(var i=0;i<this.options.tokens.length;i++){var _4bf=this.element.value.lastIndexOf(this.options.tokens[i]);if(_4bf>_4bd){_4bd=_4bf;}}return _4bd;}};Ajax.Autocompleter=Class.create();Object.extend(Object.extend(Ajax.Autocompleter.prototype,Autocompleter.Base.prototype),{initialize:function(_4c0,_4c1,url,_4c3){this.baseInitialize(_4c0,_4c1,_4c3);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=url;},getUpdatedChoices:function(){entry=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,entry):entry;if(this.options.defaultParams){this.options.parameters+="&"+this.options.defaultParams;}new Ajax.Request(this.url,this.options);},onComplete:function(_4c4){this.updateChoices(_4c4.responseText);}});Autocompleter.Local=Class.create();Autocompleter.Local.prototype=Object.extend(new Autocompleter.Base(),{initialize:function(_4c5,_4c6,_4c7,_4c8){this.baseInitialize(_4c5,_4c6,_4c8);this.options.array=_4c7;},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this));},setOptions:function(_4c9){this.options=Object.extend({choices:10,partialSearch:true,partialChars:2,ignoreCase:true,fullSearch:false,selector:function(_4ca){var ret=[];var _4cc=[];var _4cd=_4ca.getToken();var _4ce=0;for(var i=0;i<_4ca.options.array.length&&ret.length<_4ca.options.choices;i++){var elem=_4ca.options.array[i];var _4d1=_4ca.options.ignoreCase?elem.toLowerCase().indexOf(_4cd.toLowerCase()):elem.indexOf(_4cd);while(_4d1!=-1){if(_4d1==0&&elem.length!=_4cd.length){ret.push("<li><strong>"+elem.substr(0,_4cd.length)+"</strong>"+elem.substr(_4cd.length)+"</li>");break;}else{if(_4cd.length>=_4ca.options.partialChars&&_4ca.options.partialSearch&&_4d1!=-1){if(_4ca.options.fullSearch||/\s/.test(elem.substr(_4d1-1,1))){_4cc.push("<li>"+elem.substr(0,_4d1)+"<strong>"+elem.substr(_4d1,_4cd.length)+"</strong>"+elem.substr(_4d1+_4cd.length)+"</li>");break;}}}_4d1=_4ca.options.ignoreCase?elem.toLowerCase().indexOf(_4cd.toLowerCase(),_4d1+1):elem.indexOf(_4cd,_4d1+1);}}if(_4cc.length){ret=ret.concat(_4cc.slice(0,_4ca.options.choices-ret.length));}return "<ul>"+ret.join("")+"</ul>";}},_4c9||{});}});Field.scrollFreeActivate=function(_4d2){setTimeout(function(){Field.activate(_4d2);},1);};Ajax.InPlaceEditor=Class.create();Ajax.InPlaceEditor.defaultHighlightColor="#FFFF99";Ajax.InPlaceEditor.prototype={initialize:function(_4d3,url,_4d5){this.url=url;this.element=$(_4d3);this.options=Object.extend({okButton:true,okText:"ok",cancelLink:true,cancelText:"cancel",savingText:"Saving...",clickToEditText:"Click to edit",okText:"ok",rows:1,onComplete:function(_4d6,_4d7){new Effect.Highlight(_4d7,{startcolor:this.options.highlightcolor});},onFailure:function(_4d8){alert("Error communicating with the server: "+_4d8.responseText.stripTags());},callback:function(form){return Form.serialize(form);},handleLineBreaks:true,loadingText:"Loading...",savingClassName:"inplaceeditor-saving",loadingClassName:"inplaceeditor-loading",formClassName:"inplaceeditor-form",highlightcolor:Ajax.InPlaceEditor.defaultHighlightColor,highlightendcolor:"#FFFFFF",externalControl:null,submitOnBlur:false,ajaxOptions:{},evalScripts:false},_4d5||{});if(!this.options.formId&&this.element.id){this.options.formId=this.element.id+"-inplaceeditor";if($(this.options.formId)){this.options.formId=null;}}if(this.options.externalControl){this.options.externalControl=$(this.options.externalControl);}this.originalBackground=Element.getStyle(this.element,"background-color");if(!this.originalBackground){this.originalBackground="transparent";}this.element.title=this.options.clickToEditText;this.onclickListener=this.enterEditMode.bindAsEventListener(this);this.mouseoverListener=this.enterHover.bindAsEventListener(this);this.mouseoutListener=this.leaveHover.bindAsEventListener(this);Event.observe(this.element,"click",this.onclickListener);Event.observe(this.element,"mouseover",this.mouseoverListener);Event.observe(this.element,"mouseout",this.mouseoutListener);if(this.options.externalControl){Event.observe(this.options.externalControl,"click",this.onclickListener);Event.observe(this.options.externalControl,"mouseover",this.mouseoverListener);Event.observe(this.options.externalControl,"mouseout",this.mouseoutListener);}},enterEditMode:function(evt){if(this.saving){return;}if(this.editing){return;}this.editing=true;this.onEnterEditMode();if(this.options.externalControl){Element.hide(this.options.externalControl);}Element.hide(this.element);this.createForm();this.element.parentNode.insertBefore(this.form,this.element);if(!this.options.loadTextURL){Field.scrollFreeActivate(this.editField);}if(evt){Event.stop(evt);}return false;},createForm:function(){this.form=document.createElement("form");this.form.id=this.options.formId;Element.addClassName(this.form,this.options.formClassName);this.form.onsubmit=this.onSubmit.bind(this);this.createEditField();if(this.options.textarea){var br=document.createElement("br");this.form.appendChild(br);}if(this.options.okButton){okButton=document.createElement("input");okButton.type="submit";okButton.value=this.options.okText;okButton.className="editor_ok_button";this.form.appendChild(okButton);}if(this.options.cancelLink){cancelLink=document.createElement("a");cancelLink.href="#";cancelLink.appendChild(document.createTextNode(this.options.cancelText));cancelLink.onclick=this.onclickCancel.bind(this);cancelLink.className="editor_cancel";this.form.appendChild(cancelLink);}},hasHTMLLineBreaks:function(_4dc){if(!this.options.handleLineBreaks){return false;}return _4dc.match(/<br/i)||_4dc.match(/<p>/i);},convertHTMLLineBreaks:function(_4dd){return _4dd.replace(/<br>/gi,"\n").replace(/<br\/>/gi,"\n").replace(/<\/p>/gi,"\n").replace(/<p>/gi,"");},createEditField:function(){var text;if(this.options.loadTextURL){text=this.options.loadingText;}else{text=this.getText();}var obj=this;if(this.options.rows==1&&!this.hasHTMLLineBreaks(text)){this.options.textarea=false;var _4e0=document.createElement("input");_4e0.obj=this;_4e0.type="text";_4e0.name="value";_4e0.value=text;_4e0.style.backgroundColor=this.options.highlightcolor;_4e0.className="editor_field";var size=this.options.size||this.options.cols||0;if(size!=0){_4e0.size=size;}if(this.options.submitOnBlur){_4e0.onblur=this.onSubmit.bind(this);}this.editField=_4e0;}else{this.options.textarea=true;var _4e2=document.createElement("textarea");_4e2.obj=this;_4e2.name="value";_4e2.value=this.convertHTMLLineBreaks(text);_4e2.rows=this.options.rows;_4e2.cols=this.options.cols||40;_4e2.className="editor_field";if(this.options.submitOnBlur){_4e2.onblur=this.onSubmit.bind(this);}this.editField=_4e2;}if(this.options.loadTextURL){this.loadExternalText();}this.form.appendChild(this.editField);},getText:function(){return this.element.innerHTML;},loadExternalText:function(){Element.addClassName(this.form,this.options.loadingClassName);this.editField.disabled=true;new Ajax.Request(this.options.loadTextURL,Object.extend({asynchronous:true,onComplete:this.onLoadedExternalText.bind(this)},this.options.ajaxOptions));},onLoadedExternalText:function(_4e3){Element.removeClassName(this.form,this.options.loadingClassName);this.editField.disabled=false;this.editField.value=_4e3.responseText.stripTags();Field.scrollFreeActivate(this.editField);},onclickCancel:function(){this.onComplete();this.leaveEditMode();return false;},onFailure:function(_4e4){this.options.onFailure(_4e4);if(this.oldInnerHTML){this.element.innerHTML=this.oldInnerHTML;this.oldInnerHTML=null;}return false;},onSubmit:function(){var form=this.form;var _4e6=this.editField.value;this.onLoading();if(this.options.evalScripts){new Ajax.Request(this.url,Object.extend({parameters:this.options.callback(form,_4e6),onComplete:this.onComplete.bind(this),onFailure:this.onFailure.bind(this),asynchronous:true,evalScripts:true},this.options.ajaxOptions));}else{new Ajax.Updater({success:this.element,failure:null},this.url,Object.extend({parameters:this.options.callback(form,_4e6),onComplete:this.onComplete.bind(this),onFailure:this.onFailure.bind(this)},this.options.ajaxOptions));}if(arguments.length>1){Event.stop(arguments[0]);}return false;},onLoading:function(){this.saving=true;this.removeForm();this.leaveHover();this.showSaving();},showSaving:function(){this.oldInnerHTML=this.element.innerHTML;this.element.innerHTML=this.options.savingText;Element.addClassName(this.element,this.options.savingClassName);this.element.style.backgroundColor=this.originalBackground;Element.show(this.element);},removeForm:function(){if(this.form){if(this.form.parentNode){Element.remove(this.form);}this.form=null;}},enterHover:function(){if(this.saving){return;}this.element.style.backgroundColor=this.options.highlightcolor;if(this.effect){this.effect.cancel();}Element.addClassName(this.element,this.options.hoverClassName);},leaveHover:function(){if(this.options.backgroundColor){this.element.style.backgroundColor=this.oldBackground;}Element.removeClassName(this.element,this.options.hoverClassName);if(this.saving){return;}this.effect=new Effect.Highlight(this.element,{startcolor:this.options.highlightcolor,endcolor:this.options.highlightendcolor,restorecolor:this.originalBackground});},leaveEditMode:function(){Element.removeClassName(this.element,this.options.savingClassName);this.removeForm();this.leaveHover();this.element.style.backgroundColor=this.originalBackground;Element.show(this.element);if(this.options.externalControl){Element.show(this.options.externalControl);}this.editing=false;this.saving=false;this.oldInnerHTML=null;this.onLeaveEditMode();},onComplete:function(_4e7){this.leaveEditMode();this.options.onComplete.bind(this)(_4e7,this.element);},onEnterEditMode:function(){},onLeaveEditMode:function(){},dispose:function(){if(this.oldInnerHTML){this.element.innerHTML=this.oldInnerHTML;}this.leaveEditMode();Event.stopObserving(this.element,"click",this.onclickListener);Event.stopObserving(this.element,"mouseover",this.mouseoverListener);Event.stopObserving(this.element,"mouseout",this.mouseoutListener);if(this.options.externalControl){Event.stopObserving(this.options.externalControl,"click",this.onclickListener);Event.stopObserving(this.options.externalControl,"mouseover",this.mouseoverListener);Event.stopObserving(this.options.externalControl,"mouseout",this.mouseoutListener);}}};Ajax.InPlaceCollectionEditor=Class.create();Object.extend(Ajax.InPlaceCollectionEditor.prototype,Ajax.InPlaceEditor.prototype);Object.extend(Ajax.InPlaceCollectionEditor.prototype,{createEditField:function(){if(!this.cached_selectTag){var _4e8=document.createElement("select");var _4e9=this.options.collection||[];var _4ea;_4e9.each(function(e,i){_4ea=document.createElement("option");_4ea.value=(e instanceof Array)?e[0]:e;if((typeof this.options.value=="undefined")&&((e instanceof Array)?this.element.innerHTML==e[1]:e==_4ea.value)){_4ea.selected=true;}if(this.options.value==_4ea.value){_4ea.selected=true;}_4ea.appendChild(document.createTextNode((e instanceof Array)?e[1]:e));_4e8.appendChild(_4ea);}.bind(this));this.cached_selectTag=_4e8;}this.editField=this.cached_selectTag;if(this.options.loadTextURL){this.loadExternalText();}this.form.appendChild(this.editField);this.options.callback=function(form,_4ee){return "value="+encodeURIComponent(_4ee);};}});Form.Element.DelayedObserver=Class.create();Form.Element.DelayedObserver.prototype={initialize:function(_4ef,_4f0,_4f1){this.delay=_4f0||0.5;this.element=$(_4ef);this.callback=_4f1;this.timer=null;this.lastValue=$F(this.element);Event.observe(this.element,"keyup",this.delayedListener.bindAsEventListener(this));},delayedListener:function(_4f2){if(this.lastValue==$F(this.element)){return;}if(this.timer){clearTimeout(this.timer);}this.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1000);this.lastValue=$F(this.element);},onTimerEvent:function(){this.timer=null;this.callback(this.element,$F(this.element));}};function updateItem(list){list=$(list);var _4f4=list.getElementsByTagName("li");$(list.getAttribute("field")).value=$A(_4f4).map(getItemName).join(",");}function deleteItem(_4f5){var list=$(_4f5).parentNode;$(_4f5).remove();updateItem(list);}function getItemName(_4f7){return _4f7.getElementsByTagName("span")[0].childNodes[0].nodeValue;}function addItem(list,item){item=item.replace(/[^A-Za-z0-9 ]/g,"");if(item.length<1){return;}var _4fa=$(list);var _4fb=_4fa.getElementsByTagName("li");for(var i=0;i<_4fb.length;++i){if(getItemName(_4fb[i])==item){return;}}var _4fd=+list+"_"+"item_"+_4fb.length;var li=Builder.node("li",{className:"removable_list_item"},[Builder.node("span",item)]);var _4ff=_4fa.firstChild;while(_4ff.nextSibling){_4ff=_4ff.nextSibling;}_4fa.insertBefore(li,_4ff);li.appendChild(Builder.node("span",{className:"command delete_button"},"[ - ]"));Behavior.applySelectedRule("li.removable_list_item .delete_button");updateItem(list);}var myrules={"li.removable_list_item .delete_button":function(_500){_500.onclick=function(){deleteItem(_500.parentNode);};}};Behavior.register(myrules);Array.prototype.indexOf=function(item){for(var i=0;i<this.length;i++){if(this[i]==item){return i;}}return -1;};Array.prototype.filter=function(test){var _504=[];for(var i=0;i<this.length;i++){if(test(this[i])){_504[_504.length]=this[i];}}return _504;};String.prototype.right=function(_506){if(_506>=this.length){return this;}else{return this.substr(this.length-_506,_506);}};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"");};var Class={create:function(){return function(){this.initialize.apply(this,arguments);};}};Object.extend=function(_507,_508){for(var _509 in _508){_507[_509]=_508[_509];}return _507;};var DateBocks=Class.create();DateBocks.VERSION="3.0.0";DateBocks.prototype={dateType:"iso",messageSpanSuffix:"Msg",messageSpanErrorClass:"error",messageSpanSuccessClass:"",dateBocksElementId:"",autoRollOver:true,calendarAlign:"Br",calendarIfFormat:null,calendarFormatString:null,"monthNames":["January","February","March","April","May","June","July","August","September","October","November","December"],"weekdayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dateParsePatterns:[{re:/^tod|now/i,handler:function(db,bits){return new Date();}},{re:/^tom/i,handler:function(db,bits){var d=new Date();d.setDate(d.getDate()+1);return d;}},{re:/^yes/i,handler:function(db,bits){var d=new Date();d.setDate(d.getDate()-1);return d;}},{re:/^(\d{1,2})(st|nd|rd|th)?$/i,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear();var dd=parseInt(bits[1],10);var mm=d.getMonth();if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/^(\d{1,2})(?:st|nd|rd|th)? (?:of\s)?(\w+)$/i,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear();var dd=parseInt(bits[1],10);var mm=db.parseMonth(bits[2]);if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/^(\d{1,2})(?:st|nd|rd|th)? (?:of )?(\w+),? (\d{4})$/i,handler:function(db,bits){var d=new Date();d.setDate(parseInt(bits[1],10));d.setMonth(db.parseMonth(bits[2]));d.setYear(bits[3]);return d;}},{re:/^(\w+) (\d{1,2})(?:st|nd|rd|th)?$/i,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear();var dd=parseInt(bits[2],10);var mm=db.parseMonth(bits[1]);if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/^(\w+) (\d{1,2})(?:st|nd|rd|th)?,? (\d{4})$/i,handler:function(db,bits){var yyyy=parseInt(bits[3],10);var dd=parseInt(bits[2],10);var mm=db.parseMonth(bits[1]);if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/((next|last)\s(week|month|year))/i,handler:function(db,bits){var _52e=new Date();var dd=_52e.getDate();var mm=_52e.getMonth();var yyyy=_52e.getFullYear();switch(bits[3]){case "week":var _532=(bits[2]=="next")?(dd+7):(dd-7);_52e.setDate(_532);break;case "month":var _533=(bits[2]=="next")?(mm+1):(mm-1);_52e.setMonth(_533);break;case "year":var _534=(bits[2]=="next")?(yyyy+1):(yyyy-1);_52e.setYear(_534);break;}return _52e;}},{re:/^(next|this)?\s?(\w+)$/i,handler:function(db,bits){var d=new Date();var day=d.getDay();var _539=db.parseWeekday(bits[2]);var _53a=_539-day;if(_539<=day){_53a+=7;}d.setDate(d.getDate()+_53a);return d;}},{re:/^last (\w+)$/i,handler:function(db,bits){var d=new Date();var wd=d.getDay();var nwd=db.parseWeekday(bits[1]);var _540=(-1*(wd+7-nwd))%7;if(0==_540){_540=-7;}d.setDate(d.getDate()+_540);return d;}},{re:/(\d{1,2})\/(\d{1,2})\/(\d{4})/,handler:function(db,bits){if(db.dateType=="dd/mm/yyyy"){var yyyy=parseInt(bits[3],10);var dd=parseInt(bits[1],10);var mm=parseInt(bits[2],10)-1;}else{var yyyy=parseInt(bits[3],10);var dd=parseInt(bits[2],10);var mm=parseInt(bits[1],10)-1;}if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})\/(\d{1,2})\/(\d{1,2})/,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear()-(d.getFullYear()%100)+parseInt(bits[3],10);var dd=parseInt(bits[2],10);var mm=parseInt(bits[1],10)-1;if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})\/(\d{1,2})/,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear();var dd=parseInt(bits[2],10);var mm=parseInt(bits[1],10)-1;if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})-(\d{1,2})-(\d{4})/,handler:function(db,bits){if(db.dateType=="dd-mm-yyyy"){var yyyy=parseInt(bits[3],10);var dd=parseInt(bits[1],10);var mm=parseInt(bits[2],10)-1;}else{var yyyy=parseInt(bits[3],10);var dd=parseInt(bits[2],10);var mm=parseInt(bits[1],10)-1;}if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})\.(\d{1,2})\.(\d{4})/,handler:function(db,bits){var dd=parseInt(bits[1],10);var mm=parseInt(bits[2],10)-1;var yyyy=parseInt(bits[3],10);if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{4})-(\d{1,2})-(\d{1,2})/,handler:function(db,bits){var yyyy=parseInt(bits[1],10);var dd=parseInt(bits[3],10);var mm=parseInt(bits[2],10)-1;if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})-(\d{1,2})-(\d{1,2})/,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear()-(d.getFullYear()%100)+parseInt(bits[1],10);var dd=parseInt(bits[3],10);var mm=parseInt(bits[2],10)-1;if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}},{re:/(\d{1,2})-(\d{1,2})/,handler:function(db,bits){var d=new Date();var yyyy=d.getFullYear();var dd=parseInt(bits[2],10);var mm=parseInt(bits[1],10)-1;if(db.dateInRange(yyyy,mm,dd)){return db.getDateObj(yyyy,mm,dd);}}}],initialize:function(_573){Object.extend(this,_573);switch(this.dateType){case "mm/dd/yyyy":case "us":this.calendarIfFormat="%m/%d/%Y";this.calendarFormatString="mm/dd/yyyy";break;case "mm.dd.yyyy":case "de":this.calendarIfFormat="%m.%d.%Y";this.calendarFormatString="mm.dd.yyyy";break;case "dd/mm/yyyy":this.calendarIfFormat="%d/%m/%Y";this.calendarFormatString="dd/mm/yyyy";break;case "dd-mm-yyyy":this.calendarIfFormat="%d-%m-%Y";this.calendarFormatString="dd-mm-yyyy";break;case "yyyy-mm-dd":case "iso":case "default":default:this.calendarIfFormat="%Y-%m-%d";this.calendarFormatString="yyyy-mm-dd";break;}},parseMonth:function(_574){var _575=this.monthNames.filter(function(item){return new RegExp("^"+_574,"i").test(item);});if(_575.length==0){throw new Error("Invalid month string");}if(_575.length<1){throw new Error("Ambiguous month");}return this.monthNames.indexOf(_575[0]);},parseWeekday:function(_577){var _578=this.weekdayNames.filter(function(item){return new RegExp("^"+_577,"i").test(item);});if(_578.length==0){throw new Error("Invalid day string");}if(_578.length<1){throw new Error("Ambiguous weekday");}return this.weekdayNames.indexOf(_578[0]);},dateInRange:function(yyyy,mm,dd){if(mm<0||mm>11){throw new Error("Invalid month value.  Valid months values are 1 to 12");}if(!this.autoRollOver){var d=(11==mm)?new Date(yyyy+1,0,0):new Date(yyyy,mm+1,0);if(dd<1||dd>d.getDate()){throw new Error("Invalid date value.  Valid date values for "+this.monthNames[mm]+" are 1 to "+d.getDate().toString());}}return true;},getDateObj:function(yyyy,mm,dd){var obj=new Date();obj.setDate(1);obj.setYear(yyyy);obj.setMonth(mm);obj.setDate(dd);return obj;},parseDateString:function(s){var _583=this.dateParsePatterns;for(var i=0;i<_583.length;i++){var re=_583[i].re;var _586=_583[i].handler;var bits=re.exec(s);if(bits){return _586(this,bits);}}throw new Error("Invalid date string");},zeroPad:function(_588){if(_588<10){return "0"+_588;}else{return _588;}},magicDate:function(){var _589=document.getElementById(this.dateBocksElementId);var _58a=document.getElementById(_589.id+this.messageSpanSuffix);try{var num=_589.id.replace("deadline_","");if(!_589.value){console.log("OO");if(num!=_589.id){return changeField(num,"deadline");}}var d=this.parseDateString(_589.value);var day=this.zeroPad(d.getDate());var _58e=this.zeroPad(d.getMonth()+1);var year=d.getFullYear();switch(this.dateType){case "dd/mm/yyyy":_589.value=day+"/"+_58e+"/"+year;break;case "dd-mm-yyyy":_589.value=day+"-"+_58e+"-"+year;break;case "mm/dd/yyyy":case "us":_589.value=_58e+"/"+day+"/"+year;break;case "mm.dd.yyyy":case "de":_589.value=_58e+"."+day+"."+year;break;case "default":case "iso":case "yyyy-mm-dd":default:_589.value=year+"-"+_58e+"-"+day;break;}_589.className="";if(_58a){_58a.innerHTML=d.toDateString();_58a.className=this.messageSpanSuccessClass;}if(num!=_589.id){changeField(num,"deadline");}}catch(e){if(_58a){var _590=e.message;if(_590.indexOf("is null or not an object")>-1){_590="Invalid date string";}_58a.innerHTML=_590;_58a.className=this.messageSpanErrorClass;}}},trim:function(_591){return _591.replace(/^\s+|\s+$/,"");},keyObserver:function(_592,_593){var _594=_592.keyCode?_592.keyCode:((_592.which)?_592.which:_592.charCode);if(_594==13||_594==10){switch(_593){case "parse":this.magicDate();break;case "return":case "false":default:return false;break;}}},setDefaultFormatMessage:function(){document.getElementById(this.dateBocksElementId+"Msg").innerHTML=this.calendarFormatString;}};Calendar=function(_595,_596,_597,_598){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=_597||null;this.onClose=_598||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof _595=="number"?_595:Calendar._FD;this.showsOtherMonths=false;this.dateStr=_596;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3;}var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len);}Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3;}ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len);}Calendar._SMN=ar;}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(el){var SL=0,ST=0;var _59e=/^div$/i.test(el.tagName);if(_59e&&el.scrollLeft){SL=el.scrollLeft;}if(_59e&&el.scrollTop){ST=el.scrollTop;}var r={x:el.offsetLeft-SL,y:el.offsetTop-ST};if(el.offsetParent){var tmp=this.getAbsolutePos(el.offsetParent);r.x+=tmp.x;r.y+=tmp.y;}return r;};Calendar.isRelated=function(el,evt){var _5a3=evt.relatedTarget;if(!_5a3){var type=evt.type;if(type=="mouseover"){_5a3=evt.fromElement;}else{if(type=="mouseout"){_5a3=evt.toElement;}}}while(_5a3){if(_5a3==el){return true;}_5a3=_5a3.parentNode;}return false;};Calendar.removeClass=function(el,_5a6){if(!(el&&el.className)){return;}var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=_5a6){ar[ar.length]=cls[i];}}el.className=ar.join(" ");};Calendar.addClass=function(el,_5ab){Calendar.removeClass(el,_5ab);el.className+=" "+_5ab;};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName)){f=f.parentNode;}return f;};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1){f=f.parentNode;}return f;};Calendar.stopEvent=function(ev){ev||(ev=window.event);if(Calendar.is_ie){ev.cancelBubble=true;ev.returnValue=false;}else{ev.preventDefault();ev.stopPropagation();}return false;};Calendar.addEvent=function(el,_5b2,func){if(el.attachEvent){el.attachEvent("on"+_5b2,func);}else{if(el.addEventListener){el.addEventListener(_5b2,func,true);}else{el["on"+_5b2]=func;}}};Calendar.removeEvent=function(el,_5b5,func){if(el.detachEvent){el.detachEvent("on"+_5b5,func);}else{if(el.removeEventListener){el.removeEventListener(_5b5,func,true);}else{el["on"+_5b5]=null;}}};Calendar.createElement=function(type,_5b8){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",type);}else{el=document.createElement(type);}if(typeof _5b8!="undefined"){_5b8.appendChild(el);}return el;};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true);}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el;}else{if(typeof el.parentNode.month!="undefined"){return el.parentNode;}}return null;};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el;}else{if(typeof el.parentNode.year!="undefined"){return el.parentNode;}}return null;};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false;}var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active");}var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px";}else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined"){mcw=50;}s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px";}s.top=(cd.offsetTop+cd.offsetHeight)+"px";};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false;}var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active");}cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var show=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";show=true;}else{yr.style.display="none";}yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep;}if(show){var s=yc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px";}else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined"){ycw=50;}s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px";}s.top=(cd.offsetTop+cd.offsetHeight)+"px";}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false;}if(cal.timeout){clearTimeout(cal.timeout);}var el=cal.activeDiv;if(!el){return false;}var _5d2=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(_5d2==el||_5d2.parentNode==el){Calendar.cellClick(el,ev);}var mon=Calendar.findMonth(_5d2);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler();}}else{var year=Calendar.findYear(_5d2);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler();}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev);}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return;}var el=cal.activeDiv;var _5d9=Calendar.getTargetElement(ev);if(_5d9==el||_5d9.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite");}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2))){Calendar.removeClass(el,"active");}Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite");}ev||(ev=window.event);if(el.navtype==50&&_5d9!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var _5de=true;if(x>pos.x+w){dx=x-pos.x-w;_5de=false;}else{dx=pos.x-x;}if(dx<0){dx=0;}var _5df=el._range;var _5e0=el._current;var _5e1=Math.floor(dx/10)%_5df.length;for(var i=_5df.length;--i>=0;){if(_5df[i]==_5e0){break;}}while(_5e1-->0){if(_5de){if(--i<0){i=_5df.length-1;}}else{if(++i>=_5df.length){i=0;}}}var _5e3=_5df[i];el.innerHTML=_5e3;cal.onUpdateTime();}var mon=Calendar.findMonth(_5d9);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon;}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}var year=Calendar.findYear(_5d9);if(year){if(year.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}Calendar.addClass(year,"hilite");cal.hilitedYear=year;}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}}}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}}}return Calendar.stopEvent(ev);};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev);}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false;}var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft;}else{posX=ev.pageX;posY=ev.pageY;}cal.hideShowCovered();var st=cal.element.style;st.left=(posX-cal.xOffs)+"px";st.top=(posY-cal.yOffs)+"px";return Calendar.stopEvent(ev);};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false;}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev);}cal.hideShowCovered();};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false;}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver);}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver);}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp);}}else{if(cal.isPopup){cal._dragStart(ev);}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout);}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250);}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout);}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250);}else{cal.timeout=null;}}return Calendar.stopEvent(ev);};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty();}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false;}if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1);}el.calendar.tooltips.innerHTML=el.ttip;}if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite");}}return Calendar.stopEvent(ev);};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false;}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite");}if(el.calendar){el.calendar.tooltips.innerHTML=_TT["SEL_DATE"];}return stopEvent(ev);}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var _5f9=false;var _5fa=false;var date=null;if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");_5f9=(cal.currentDateEl==el);if(!_5f9){cal.currentDateEl=el;}}cal.date.setDateOnly(el.caldate);date=cal.date;var _5fc=!(cal.dateClicked=!el.otherMonth);if(!_5fc&&!cal.currentDateEl){cal._toggleMultipleDate(new Date(date));}else{_5fa=!el.disabled;}if(_5fc){cal._init(cal.firstDayOfWeek,date);}}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return;}date=new Date(cal.date);if(el.navtype==0){date.setDateOnly(new Date());}cal.dateClicked=false;var year=date.getFullYear();var mon=date.getMonth();function setMonth(m){var day=date.getDate();var max=date.getMonthDays(m);if(day>max){date.setDate(max);}date.setMonth(m);}switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var text=Calendar._TT["ABOUT"];if(typeof text!="undefined"){text+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:"";}else{text="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+"the corresponding file in \"lang\" subdir to match calendar-en.js\n"+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n";}alert(text);return;case -2:if(year>cal.minYear){date.setFullYear(year-1);}break;case -1:if(mon>0){setMonth(mon-1);}else{if(year-->cal.minYear){date.setFullYear(year);setMonth(11);}}break;case 1:if(mon<11){setMonth(mon+1);}else{if(year<cal.maxYear){date.setFullYear(year+1);setMonth(0);}}break;case 2:if(year<cal.maxYear){date.setFullYear(year+1);}break;case 100:cal.setFirstDayOfWeek(el.fdow);return;case 50:var _603=el._range;var _604=el.innerHTML;for(var i=_603.length;--i>=0;){if(_603[i]==_604){break;}}if(ev&&ev.shiftKey){if(--i<0){i=_603.length-1;}}else{if(++i>=_603.length){i=0;}}var _606=_603[i];el.innerHTML=_606;cal.onUpdateTime();return;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(date,date.getFullYear(),date.getMonth(),date.getDate())){return false;}break;}if(!date.equalsTo(cal.date)){cal.setDate(date);_5fa=true;}else{if(el.navtype==0){_5fa=_5f9=true;}}}if(_5fa){ev&&cal.callHandler();}if(_5f9){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler();}};Calendar.prototype.create=function(_par){var _608=null;if(!_par){_608=document.getElementsByTagName("body")[0];this.isPopup=true;}else{_608=_par;this.isPopup=false;}this.date=this.dateStr?new Date(this.dateStr):new Date();var _609=Calendar.createElement("table");this.table=_609;_609.cellSpacing=0;_609.cellPadding=0;_609.calendar=this;Calendar.addEvent(_609,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none";}div.appendChild(_609);var _60b=Calendar.createElement("thead",_609);var cell=null;var row=null;var cal=this;var hh=function(text,cs,_612){cell=Calendar.createElement("td",row);cell.colSpan=cs;cell.className="button";if(_612!=0&&Math.abs(_612)<=2){cell.className+=" nav";}Calendar._add_evs(cell);cell.calendar=cal;cell.navtype=_612;cell.innerHTML="<div unselectable='on'>"+text+"</div>";return cell;};row=Calendar.createElement("tr",_60b);var _613=6;(this.isPopup)&&--_613;(this.weekNumbers)&&++_613;hh("?",1,400).ttip=Calendar._TT["INFO"];this.title=hh("",_613,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";hh("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"];}row=Calendar.createElement("tr",_60b);row.className="headrow";this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];row=Calendar.createElement("tr",_60b);row.className="daynames";if(this.weekNumbers){cell=Calendar.createElement("td",row);cell.className="name wn";cell.innerHTML=Calendar._TT["WK"];}for(var i=7;i>0;--i){cell=Calendar.createElement("td",row);if(!i){cell.navtype=100;cell.calendar=this;Calendar._add_evs(cell);}}this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var _615=Calendar.createElement("tbody",_609);this.tbody=_615;for(i=6;i>0;--i){row=Calendar.createElement("tr",_615);if(this.weekNumbers){cell=Calendar.createElement("td",row);}for(var j=7;j>0;--j){cell=Calendar.createElement("td",row);cell.calendar=this;Calendar._add_evs(cell);}}if(this.showsTime){row=Calendar.createElement("tr",_615);row.className="time";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;cell.innerHTML=Calendar._TT["TIME"]||"&nbsp;";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(_617,init,_619,_61a){var part=Calendar.createElement("span",cell);part.className=_617;part.innerHTML=init;part.calendar=cal;part.ttip=Calendar._TT["TIME_PART"];part.navtype=50;part._range=[];if(typeof _619!="number"){part._range=_619;}else{for(var i=_619;i<=_61a;++i){var txt;if(i<10&&_61a>=10){txt="0"+i;}else{txt=""+i;}part._range[part._range.length]=txt;}}Calendar._add_evs(part);return part;}var hrs=cal.date.getHours();var mins=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm){hrs-=12;}var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var span=Calendar.createElement("span",cell);span.innerHTML=":";span.className="colon";var M=makeTimePart("minute",mins,0,59);var AP=null;cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;if(t12){AP=makeTimePart("ampm",pm?"pm":"am",["am","pm"]);}else{cell.innerHTML="&nbsp;";}cal.onSetTime=function(){var pm,hrs=this.date.getHours(),mins=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm){hrs-=12;}if(hrs==0){hrs=12;}AP.innerHTML=pm?"pm":"am";}H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(mins<10)?("0"+mins):mins;};cal.onUpdateTime=function(){var date=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(/pm/i.test(AP.innerHTML)&&h<12){h+=12;}else{if(/am/i.test(AP.innerHTML)&&h==12){h=0;}}}var d=date.getDate();var m=date.getMonth();var y=date.getFullYear();date.setHours(h);date.setMinutes(parseInt(M.innerHTML,10));date.setFullYear(y);date.setMonth(m);date.setDate(d);this.dateClicked=false;this.callHandler();};})();}else{this.onSetTime=this.onUpdateTime=function(){};}var _62c=Calendar.createElement("tfoot",_609);row=Calendar.createElement("tr",_62c);row.className="footrow";cell=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);cell.className="ttip";if(this.isPopup){cell.ttip=Calendar._TT["DRAG_TO_MOVE"];cell.style.cursor="move";}this.tooltips=cell;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn);}div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr);}this._init(this.firstDayOfWeek,this.date);_608.appendChild(this.element);};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false;}(Calendar.is_ie)&&(ev=window.event);var act=(Calendar.is_ie||ev.type=="keypress"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break;default:return false;}}else{switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 27:act&&cal.callCloseHandler();break;case 37:case 38:case 39:case 40:if(act){var prev,x,y,ne,el,step;prev=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x];}setVars();function prevMonth(){var date=new Date(cal.date);date.setDate(date.getDate()-step);cal.setDate(date);}function nextMonth(){var date=new Date(cal.date);date.setDate(date.getDate()+step);cal.setDate(date);}while(1){switch(K){case 37:if(--x>=0){ne=cal.ar_days[y][x];}else{x=6;K=38;continue;}break;case 38:if(--y>=0){ne=cal.ar_days[y][x];}else{prevMonth();setVars();}break;case 39:if(++x<7){ne=cal.ar_days[y][x];}else{x=0;K=40;continue;}break;case 40:if(++y<cal.ar_days.length){ne=cal.ar_days[y][x];}else{nextMonth();setVars();}break;}break;}if(ne){if(!ne.disabled){Calendar.cellClick(ne);}else{if(prev){prevMonth();}else{nextMonth();}}}}break;case 13:if(act){Calendar.cellClick(cal.currentDateEl,ev);}break;default:return false;}}return Calendar.stopEvent(ev);};Calendar.prototype._init=function(_636,date){var _638=new Date(),TY=_638.getFullYear(),TM=_638.getMonth(),TD=_638.getDate();this.table.style.visibility="hidden";var year=date.getFullYear();if(year<this.minYear){year=this.minYear;date.setFullYear(year);}else{if(year>this.maxYear){year=this.maxYear;date.setFullYear(year);}}this.firstDayOfWeek=_636;this.date=new Date(date);var _63a=date.getMonth();var mday=date.getDate();var _63c=date.getMonthDays();date.setDate(1);var day1=(date.getDay()-this.firstDayOfWeek)%7;if(day1<0){day1+=7;}date.setDate(-day1);date.setDate(date.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[_63a];var _640=this.ar_days=new Array();var _641=Calendar._TT["WEEKEND"];var _642=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var cell=row.firstChild;if(this.weekNumbers){cell.className="day wn";cell.innerHTML=date.getWeekNumber();cell=cell.nextSibling;}row.className="daysrow";var _645=false,iday,dpos=_640[i]=[];for(var j=0;j<7;++j,cell=cell.nextSibling,date.setDate(iday+1)){iday=date.getDate();var wday=date.getDay();cell.className="day";cell.pos=i<<4|j;dpos[j]=cell;var _648=(date.getMonth()==_63a);if(!_648){if(this.showsOtherMonths){cell.className+=" othermonth";cell.otherMonth=true;}else{cell.className="emptycell";cell.innerHTML="&nbsp;";cell.disabled=true;continue;}}else{cell.otherMonth=false;_645=true;}cell.disabled=false;cell.innerHTML=this.getDateText?this.getDateText(date,iday):iday;if(_642){_642[date.print("%Y%m%d")]=cell;}if(this.getDateStatus){var _649=this.getDateStatus(date,year,_63a,iday);if(this.getDateToolTip){var _64a=this.getDateToolTip(date,year,_63a,iday);if(_64a){cell.title=_64a;}}if(_649===true){cell.className+=" disabled";cell.disabled=true;}else{if(/disabled/i.test(_649)){cell.disabled=true;}cell.className+=" "+_649;}}if(!cell.disabled){cell.caldate=new Date(date);cell.ttip="_";if(!this.multiple&&_648&&iday==mday&&this.hiliteToday){cell.className+=" selected";this.currentDateEl=cell;}if(date.getFullYear()==TY&&date.getMonth()==TM&&iday==TD){cell.className+=" today";cell.ttip+=Calendar._TT["PART_TODAY"];}if(_641.indexOf(wday.toString())!=-1){cell.className+=cell.otherMonth?" oweekend":" weekend";}}}if(!(_645||this.showsOtherMonths)){row.className="emptyrow";}}this.title.innerHTML=Calendar._MN[_63a]+", "+year;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates();};Calendar.prototype._initMultipleDates=function(){if(this.multiple){if(Prototype){this.muliple.each(function(_64b){var cell=this.datesCells[_64b.key];var d=_64b.value;if(!d){return;}if(cell){cell.className+=" selected";}});}else{for(var i in this.multiple){var cell=this.datesCells[i];var d=this.multiple[i];if(!d){continue;}if(cell){cell.className+=" selected";}}}}};Calendar.prototype._toggleMultipleDate=function(date){if(this.multiple){var ds=date.print("%Y%m%d");var cell=this.datesCells[ds];if(cell){var d=this.multiple[ds];if(!d){Calendar.addClass(cell,"selected");this.multiple[ds]=date;}else{Calendar.removeClass(cell,"selected");delete this.multiple[ds];}}}};Calendar.prototype.setDateToolTipHandler=function(_655){this.getDateToolTip=_655;};Calendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this._init(this.firstDayOfWeek,date);}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date);};Calendar.prototype.setFirstDayOfWeek=function(_657){this._init(_657,this.date);this._displayWeekdays();};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(_658){this.getDateStatus=_658;};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z;};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat));}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this);}this.hideShowCovered();};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null;};Calendar.prototype.reparent=function(_65c){var el=this.element;el.parentNode.removeChild(el);_65c.appendChild(el);};Calendar._checkCalendar=function(ev){var _65f=window._dynarch_popupCalendar;if(!_65f){return false;}var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=_65f.element;el=el.parentNode){}if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev);}};Calendar.prototype.show=function(){var rows=this.table.getElementsByTagName("tr");for(var i=rows.length;i>0;){var row=rows[--i];Calendar.removeClass(row,"rowhilite");var _664=row.getElementsByTagName("td");for(var j=_664.length;j>0;){var cell=_664[--j];Calendar.removeClass(cell,"hilite");Calendar.removeClass(cell,"active");}}this.element.style.display="block";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar);}this.hideShowCovered();};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar);}this.element.style.display="none";this.hidden=true;this.hideShowCovered();};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show();};Calendar.prototype.showAtElement=function(el,opts){var self=this;var p=Calendar.getAbsolutePos(el);if(!opts||typeof opts!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true;}function fixPosition(box){if(box.x<0){box.x=0;}if(box.y<0){box.y=0;}var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);if(Calendar.is_ie){br.y+=document.body.scrollTop;br.x+=document.body.scrollLeft;}else{br.y+=window.scrollY;br.x+=window.scrollX;}var tmp=box.x+box.width-br.x;if(tmp>0){box.x-=tmp;}tmp=box.y+box.height-br.y;if(tmp>0){box.y-=tmp;}}this.element.style.display="block";Calendar.continuation_for_the_fucking_khtml_browser=function(){var w=self.element.offsetWidth;var h=self.element.offsetHeight;self.element.style.display="none";var _675=opts.substr(0,1);var _676="l";if(opts.length>1){_676=opts.substr(1,1);}switch(_675){case "T":p.y-=h;break;case "B":p.y+=el.offsetHeight;break;case "C":p.y+=(el.offsetHeight-h)/2;break;case "t":p.y+=el.offsetHeight-h;break;case "b":break;}switch(_676){case "L":p.x-=w;break;case "R":p.x+=el.offsetWidth;break;case "C":p.x+=(el.offsetWidth-w)/2;break;case "l":p.x+=el.offsetWidth-w;break;case "r":break;}p.width=w;p.height=h+40;self.monthsCombo.style.display="none";fixPosition(p);self.showAt(p.x,p.y);};if(Calendar.is_khtml){setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10);}else{Calendar.continuation_for_the_fucking_khtml_browser();}};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str;};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str;};Calendar.prototype.parseDate=function(str,fmt){if(!fmt){fmt=this.dateFormat;}this.setDate(Date.parseDate(str,fmt));};Calendar.prototype.hideShowCovered=function(){if(!Calendar.is_ie&&!Calendar.is_opera){return;}function getVisib(obj){var _67c=obj.style.visibility;if(!_67c){if(document.defaultView&&typeof (document.defaultView.getComputedStyle)=="function"){if(!Calendar.is_khtml){_67c=document.defaultView.getComputedStyle(obj,"").getPropertyValue("visibility");}else{_67c="";}}else{if(obj.currentStyle){_67c=obj.currentStyle.visibility;}else{_67c="";}}}return _67c;}var tags=new Array("applet","iframe","select");var el=this.element;var p=Calendar.getAbsolutePos(el);var EX1=p.x;var EX2=el.offsetWidth+EX1;var EY1=p.y;var EY2=el.offsetHeight+EY1;for(var k=tags.length;k>0;){var ar=document.getElementsByTagName(tags[--k]);var cc=null;for(var i=ar.length;i>0;){cc=ar[--i];p=Calendar.getAbsolutePos(cc);var CX1=p.x;var CX2=cc.offsetWidth+CX1;var CY1=p.y;var CY2=cc.offsetHeight+CY1;if(this.hidden||(CX1>EX2)||(CX2<EX1)||(CY1>EY2)||(CY2<EY1)){if(!cc.__msh_save_visibility){cc.__msh_save_visibility=getVisib(cc);}cc.style.visibility=cc.__msh_save_visibility;}else{if(!cc.__msh_save_visibility){cc.__msh_save_visibility=getVisib(cc);}cc.style.visibility="hidden";}}}};Calendar.prototype._displayWeekdays=function(){var fdow=this.firstDayOfWeek;var cell=this.firstdayname;var _68e=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){cell.className="day name";var _690=(i+fdow)%7;if(i){cell.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[_690]);cell.navtype=100;cell.calendar=this;cell.fdow=_690;Calendar._add_evs(cell);}if(_68e.indexOf(_690.toString())!=-1){Calendar.addClass(cell,"weekend");}cell.innerHTML=Calendar._SDN[(i+fdow)%7];cell=cell.nextSibling;}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none";};Calendar.prototype._dragStart=function(ev){if(this.dragging){return;}this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft;}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX;}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd);}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.parseDate=function(str,fmt){var _697=new Date();var y=0;var m=-1;var d=0;var a=str.split(/\W+/);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i]){continue;}switch(b[i]){case "%d":case "%e":d=parseInt(a[i],10);break;case "%m":m=parseInt(a[i],10)-1;break;case "%Y":case "%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case "%b":case "%B":for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){m=j;break;}}break;case "%H":case "%I":case "%k":case "%l":hr=parseInt(a[i],10);break;case "%P":case "%p":if(/pm/i.test(a[i])&&hr<12){hr+=12;}else{if(/am/i.test(a[i])&&hr>=12){hr-=12;}}break;case "%M":min=parseInt(a[i],10);break;}}if(isNaN(y)){y=_697.getFullYear();}if(isNaN(m)){m=_697.getMonth();}if(isNaN(d)){d=_697.getDate();}if(isNaN(hr)){hr=_697.getHours();}if(isNaN(min)){min=_697.getMinutes();}if(y!=0&&m!=-1&&d!=0){return new Date(y,m,d,hr,min,0);}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break;}}if(t!=-1){if(m!=-1){d=m+1;}m=t;}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1;}else{if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);}else{if(d==0){d=a[i];}}}}}if(y==0){y=_697.getFullYear();}if(m!=-1&&d!=0){return new Date(y,m,d,hr,min,0);}return _697;};Date.prototype.getMonthDays=function(_6a1){var year=this.getFullYear();if(typeof _6a1=="undefined"){_6a1=this.getMonth();}if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&_6a1==1){return 29;}else{return Date._MD[_6a1];}};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var then=new Date(this.getFullYear(),0,0,0,0,0);var time=now-then;return Math.floor(time/Date.DAY);};Date.prototype.getWeekNumber=function(){var d=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var DoW=d.getDay();d.setDate(d.getDate()-(DoW+6)%7+3);var ms=d.valueOf();d.setMonth(0);d.setDate(4);return Math.round((ms-d.valueOf())/(7*86400000))+1;};Date.prototype.equalsTo=function(date){return ((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()));};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate());};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0){ir=12;}var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?"PM":"AM";s["%P"]=pm?"pm":"am";s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(""+y).substr(2,2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return str.replace(re,function(par){return s[par]||par;});}var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],"g");str=str.replace(re,tmp);}}return str;};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth()){this.setDate(28);}this.__msh_oldSetFullYear(y);};window._dynarch_popupCalendar=null;Calendar.setup=function(_6c0){function param_default(_6c1,def){if(typeof _6c0[_6c1]=="undefined"){_6c0[_6c1]=def;}}param_default("inputField",null);param_default("displayArea",null);param_default("button",null);param_default("help",null);param_default("eventName","click");param_default("ifFormat","%Y/%m/%d");param_default("daFormat","%Y/%m/%d");param_default("singleClick",true);param_default("disableFunc",null);param_default("dateStatusFunc",_6c0["disableFunc"]);param_default("dateText",null);param_default("firstDay",null);param_default("align","Br");param_default("range",[1900,2999]);param_default("weekNumbers",true);param_default("flat",null);param_default("flatCallback",null);param_default("onSelect",null);param_default("onClose",null);param_default("onUpdate",null);param_default("date",null);param_default("showsTime",false);param_default("timeFormat","24");param_default("electric",true);param_default("step",2);param_default("position",null);param_default("cache",false);param_default("showOthers",false);param_default("multiple",null);var tmp=["inputField","displayArea","button","help"];for(var i=0;i<tmp.length;i++){if(typeof _6c0[tmp[i]]=="string"){_6c0[tmp[i]]=document.getElementById(_6c0[tmp[i]]);}}if(!(_6c0.flat||_6c0.multiple||_6c0.inputField||_6c0.displayArea||_6c0.button)){alert("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false;}function onSelect(cal){var p=cal.params;var _6c7=(cal.dateClicked||p.electric);if(_6c7&&p.inputField){p.inputField.value=cal.date.print(p.ifFormat);if(typeof p.inputField.onchange=="function"){p.inputField.onchange();}}if(_6c7&&p.displayArea){p.displayArea.innerHTML=cal.date.print(p.daFormat);}if(_6c7&&typeof p.onUpdate=="function"){p.onUpdate(cal);}if(_6c7&&p.flat){if(typeof p.flatCallback=="function"){p.flatCallback(cal);}}if(_6c7&&p.singleClick&&cal.dateClicked){cal.callCloseHandler();}}if(_6c0.flat!=null){if(typeof _6c0.flat=="string"){_6c0.flat=document.getElementById(_6c0.flat);}if(!_6c0.flat){alert("Calendar.setup:\n  Flat specified but can't find parent.");return false;}var cal=new Calendar(_6c0.firstDay,_6c0.date,_6c0.onSelect||onSelect);cal.showsOtherMonths=_6c0.showOthers;cal.showsTime=_6c0.showsTime;cal.time24=(_6c0.timeFormat=="24");cal.params=_6c0;cal.weekNumbers=_6c0.weekNumbers;cal.setRange(_6c0.range[0],_6c0.range[1]);cal.setDateStatusHandler(_6c0.dateStatusFunc);cal.getDateText=_6c0.dateText;if(_6c0.ifFormat){cal.setDateFormat(_6c0.ifFormat);}if(_6c0.inputField&&typeof _6c0.inputField.value=="string"){cal.parseDate(_6c0.inputField.value);}cal.create(_6c0.flat);cal.show();return false;}var _6c9=_6c0.help;_6c9["on"+_6c0.eventName]=function(){DateBocks.windowOpenCenter("/calendar-help.html","dateBocksHelp","width=500,height=430,autocenter=true");};var _6ca=_6c0.button||_6c0.displayArea||_6c0.inputField;_6ca["on"+_6c0.eventName]=function(){var _6cb=_6c0.inputField||_6c0.displayArea;var _6cc=_6c0.inputField?_6c0.ifFormat:_6c0.daFormat;var _6cd=false;var cal=window.calendar;if(_6cb){_6c0.date=Date.parseDate(_6cb.value||_6cb.innerHTML,_6cc);}if(!(cal&&_6c0.cache)){window.calendar=cal=new Calendar(_6c0.firstDay,_6c0.date,_6c0.onSelect||onSelect,_6c0.onClose||function(cal){cal.hide();});cal.showsTime=_6c0.showsTime;cal.time24=(_6c0.timeFormat=="24");cal.weekNumbers=_6c0.weekNumbers;_6cd=true;}else{if(_6c0.date){cal.setDate(_6c0.date);}cal.hide();}if(_6c0.multiple){cal.multiple={};for(var i=_6c0.multiple.length;--i>=0;){var d=_6c0.multiple[i];var ds=d.print("%Y%m%d");cal.multiple[ds]=d;}}cal.showsOtherMonths=_6c0.showOthers;cal.yearStep=_6c0.step;cal.setRange(_6c0.range[0],_6c0.range[1]);cal.params=_6c0;cal.setDateStatusHandler(_6c0.dateStatusFunc);cal.getDateText=_6c0.dateText;cal.setDateFormat(_6cc);if(_6cd){cal.create();}cal.refresh();if(!_6c0.position){cal.showAtElement(_6c0.button||_6c0.displayArea||_6c0.inputField,_6c0.align);}else{cal.showAt(_6c0.position[0],_6c0.position[1]);}return false;};return cal;};Calendar._DN=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");Calendar._SDN=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun");Calendar._FD=0;Calendar._MN=new Array("January","February","March","April","May","June","July","August","September","October","November","December");Calendar._SMN=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");Calendar._TT={};Calendar._TT["INFO"]="About the calendar";Calendar._TT["ABOUT"]="DHTML Date/Time Selector\n"+"(c) dynarch.com 2002-2005 / Author: Mihai Bazon\n"+"For latest version visit: http://www.dynarch.com/projects/calendar/\n"+"Distributed under GNU LGPL.  See http://gnu.org/licenses/lgpl.html for details."+"\n\n"+"Date selection:\n"+"- Use the \xab, \xbb buttons to select year\n"+"- Use the "+String.fromCharCode(8249)+", "+String.fromCharCode(8250)+" buttons to select month\n"+"- Hold mouse button on any of the above buttons for faster selection.";Calendar._TT["ABOUT_TIME"]="\n\n"+"Time selection:\n"+"- Click on any of the time parts to increase it\n"+"- or Shift-click to decrease it\n"+"- or click and drag for faster selection.";Calendar._TT["PREV_YEAR"]="Prev. year (hold for menu)";Calendar._TT["PREV_MONTH"]="Prev. month (hold for menu)";Calendar._TT["GO_TODAY"]="Go Today";Calendar._TT["NEXT_MONTH"]="Next month (hold for menu)";Calendar._TT["NEXT_YEAR"]="Next year (hold for menu)";Calendar._TT["SEL_DATE"]="Select date";Calendar._TT["DRAG_TO_MOVE"]="Drag to move";Calendar._TT["PART_TODAY"]=" (today)";Calendar._TT["DAY_FIRST"]="Display %s first";Calendar._TT["WEEKEND"]="0,6";Calendar._TT["CLOSE"]="Close";Calendar._TT["TODAY"]="Today";Calendar._TT["TIME_PART"]="(Shift-)Click or drag to change value";Calendar._TT["DEF_DATE_FORMAT"]="%Y-%m-%d";Calendar._TT["TT_DATE_FORMAT"]="%a, %b %e";Calendar._TT["WK"]="wk";Calendar._TT["TIME"]="Time:";DateBocks.windowProperties=function(_6d3){var _6d4=new RegExp("");_6d4.compile("(?:^|,)([^=]+)=(\\d+|yes|no|auto)","gim");var _6d5=new Object();var _6d6;while((_6d6=_6d4.exec(_6d3))!=null){var _6d7=_6d6[2];if(_6d7==("yes"||"1")){_6d5[_6d6[1]]=true;}else{if((!isNaN(_6d7)&&_6d7!=0)||("auto"==_6d7)){_6d5[_6d6[1]]=_6d7;}}}return _6d5;};DateBocks.windowOpenCenter=function(url,name,_6da){try{var _6db=DateBocks.windowProperties(_6da);w=parseInt(_6db["width"]);h=parseInt(_6db["height"]);w=w>0?w:640;h=h>0?h:480;if(screen){t=(screen.height-h)/2;l=(screen.width-w)/2;}else{t=250;l=250;}_6da=(w>0?",width="+w:"")+(h>0?",height="+h:"")+(t>0?",top="+t:"")+(l>0?",left="+l:"")+","+_6da.replace(/,(width=\s*\d+\s*|height=\s*\d+\s*|top=\s*\d+\s*||left=\s*\d+\s*)/gi,"");return window.open(url,name,_6da);}catch(e){}};
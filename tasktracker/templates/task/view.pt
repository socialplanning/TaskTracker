<a tal:attributes="href python:h.url_for(action='show_update', id=c.task.id)">Edit and assign this task</a>
|
<tal:nada replace="structure python:h.link_to('Delete this task', url=h.url_for(action='destroy', id=c.task.id), confirm='Are you sure you want to delete this task?')"/>
|
<span tal:condition="python: not c.task.isWatchedBy(c.username)">
<tal:nada replace="structure python:h.link_to('Watch this task', url=h.url_for(action='watch', id=c.task.id))"/>
</span>
<span tal:condition="python: c.task.isWatchedBy(c.username)">
You are watching this task.  
<tal:nada replace="structure python:h.link_to('Stop watching this task', url=h.url_for(action='stopwatch', id=c.task.id))"/>
</span>
|
<a tal:attributes="href python:h.url_for(action='view', controller='tasklist', id=c.task.task_listID)">Go back to the task list</a>

<br/><br/>

<b><span tal:replace="c/task/title" /><br/></b>
Deadline: <span tal:replace="c/task/deadline" /><br/>

<tal:if condition="c/task/owner">
  Assigned to <span tal:replace="c/task/owner" />
  <tal:if condition="python: h.has_permission(controller='task', action='claim', id=c.task.id) and c.task.owner != c.username">
    -- 
    <a tal:attributes="href python:h.url_for(action='claim', id=c.task.id)">
      Steal this task?
    </a>
  </tal:if>
</tal:if>
<tal:if condition="not:c/task/owner">
  Unassigned
  <tal:if condition="python: h.has_permission(controller='task', action='claim', id=c.task.id)">
    -- 
    <a tal:attributes="href python:h.url_for(action='claim', id=c.task.id)">
      Claim this task?
    </a>
  </tal:if>
</tal:if>
<br/>

<br/>

<div tal:content="c/task/text" />

<br/>

<span tal:condition="python:len(c.task.liveChildren())">
<div style="border: thin solid darkgray; padding:5px;">

<!-- list headers -->
Child tasks:<br>
<tal:if condition="python: len(c.task.liveChildren()) > 1 and h.has_permission('tasklist', 'update', id=c.tasklist.id)">
  <a id="reorder_button" href="javascript:modeSwitch();">
    <span id="modeName">Reorder</span>
  </a><br/><br/>
</tal:if>

Task name
<span class="status-column">Status</span>
<span class="deadline-column">Deadline <a href="#sortbydeadline" class="sortarrow" onclick="sortBy('deadline'); return false;">&#x2193;</a></span>
<span class="assigned-column">Assigned to<a href="#sortbyowner" class="sortarrow" onclick="sortBy('owner'); return false;">&#x2193;</a></span>

<!-- the actual task list -->
<ul id="tasks" class="task_list">
  <tal:for repeat="atask c/task/liveChildren">
    
    <metal:do metal:use-macro="here/task_item/macros/view_task" />
    
  </tal:for>
</ul>

</div>
</span>

<metal:do use-macro="here/_hideable_show_create/macros/show">
<a metal:fill-slot="subtask_link" tal:attributes="href python:h.url_for(action='show_create', controller='task', task_listID=c.tasklist.id, parentID=c.task.id)" onclick="hideCreate();return false;">Add a new subtask.</a>
</metal:do>

<!-- comments -->
<span tal:condition="c/task/comments">
Here are the comments:
</span>
<span tal:condition="not:c/task/comments">
There are no comments.
</span>

<ul tal:repeat="comment c/task/comments">
<li>
By: <span tal:replace="comment/user"/><br/>
On: <span tal:replace="comment/date"/><br/>
Text: <span tal:replace="structure python:h.html2safehtml(comment.text)"/><br/>
</li>
</ul>

<tal:if condition="python: h.has_permission(controller='task', action='comment', id=c.task.id)">

Make your own comment?
<form tal:attributes="action python:h.url_for(action='comment', task_id=c.task.id)" method="post">

<label for="text">Text:<label> <textarea name="text" cols=80 rows=10></textarea><br/>

<input type="submit" value="comment" name="comment">
</form>
</tal:if>

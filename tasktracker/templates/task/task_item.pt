<metal:macro metal:define-macro="show_task">

<!-- title -->
<a tal:content="atask/title" tal:attributes="href python:h.url_for(controller='task', action='show', id=atask.id); title atask/text; class python: '%s %s' % (test(atask.status=='done', 'completed-task', 'uncompleted-task'), test(atask.parentID == 0, 'root-task', 'sub-task')); id string:title_${atask/id}" />        <span tal:condition="atask/private" tal:attributes="style string: color:red" tal:content="string: -- (private)" />


<!-- the status -->

<span class="status-column" tal:condition="python: h.has_permission('task', 'change_status', id=atask.id)" 
tal:content="structure python: h.statusSelect(atask)"
tal:attributes="id string:status-form_${atask/id};"/>

<span class="status-column" tal:attributes="style python: test(h.has_permission('task', 'change_status', id=atask.id), 'display:none;;', ''); id string:label_${atask/id}; " tal:content="atask/status" />


<!-- end status -->

<!-- deadline -->

<span tal:condition="python: h.has_permission('task', 'update', id=atask.id)"
      tal:replace="structure python: h.datebocks_field('atask', 'deadline', attributes={'id':'deadline_%d' % atask.id, 'class':'deadline-column'}, value=atask.deadline)" />


<span tal:attributes="style python: test(h.has_permission('task', 'update', id=atask.id), 'display:none;;', '')" class="deadline-column" tal:content="python: h.readableDate(atask.deadline)" />

<!-- priority -->

<span class="priority-column" tal:condition="python: h.has_permission('task', 'change_priority', id=atask.id)" 
tal:content="structure python:
h.select('priority',
         h.options_for_select([(s, s) for s in 'High Medium Low None'.split()], 
                              atask.priority),
         method='post',
         originalvalue=atask.priority,
         onchange='changeField(&quot;%s&quot;,%d, &quot;priority&quot;)' % (h.url_for(controller='task',
                                                                 	 action='change_priority',
                                                                 	 id=atask.id),
                                                       			 atask.id),
                   id='priority_%d' % atask.id) "
tal:attributes="id string:priority-form_${atask/id};"/>

<span class="priority-column" tal:attributes="style python: test(h.has_permission('task', 'change_priority', id=atask.id), 'display:none;;', ''); id string:label_${atask/id}; "
      tal:content="atask/priority" />


<!--span class="priority-column" tal:content="atask/priority" /-->

<!-- owner -->
<span class="autocomplete assigned-column" tal:condition="python: h.has_permission('task', 'assign', id=atask.id)">
<input autocomplete="off" name="owner" size="30" type="text"
       tal:attributes="id python:'owner_%s' % atask.id; value atask/owner;
       onchange python:'changeField(&quot;%s&quot;,%d, &quot;owner&quot;)' % (h.url_for(controller='task', action='assign', id=atask.id), atask.id)" />
<div class="auto_complete" id="owner_auto_complete"></div>
<script type="text/javascript">new Ajax.Autocompleter('owner', 'owner_auto_complete', 
'../../../task/auto_complete_for_owner/', {})</script>
</span>

<span class="assigned-column" tal:attributes="style python: test(h.has_permission('task', 'assign', id=atask.id), 'display:none;;', '');"
      tal:content="atask/owner" />

<!-- creator -->
<!-- span class="creator-column" tal:content="atask/creator" / -->

</metal:macro>

<metal:macro metal:define-macro="show_task">

<li tal:attributes="id string:task_${atask/id}; task_id atask/id; sort_index atask/sort_index; owner atask/owner; deadline atask/deadline; priority atask/priority; status atask/status; class python: 'taskrow %s' % test(h.has_permission('task', 'update', id=atask.id), 'deletable', 'nondeletable');">

<span tal:attributes="depth python: atask.depth() - c.depth" class="taskitem">

 <span class="draggable" tal:attributes="id string:draggable_${atask/id};">
  <span tal:condition="not: c/flat"
	tal:replace="structure python: h.image_tag(test(atask.liveChildren(), 'plus.png', 'blank.png'),
		class_='treewidget handle',
		id='handle_%d' % atask.id,
		style='margin-left: %dpx;' % ((atask.depth() - c.depth) * 15))" />

    <!-- title -->
    <a tal:content="atask/title" tal:attributes="href python:h.url_for(controller='task', action='show', id=atask.id); title atask/text; class python: 'task_item %s %s' % (test(atask.status=='done', 'completed-task', 'uncompleted-task'), test(atask.parentID == 0, 'root-task', 'sub-task')); id string:title_${atask/id}" />        <span tal:condition="atask/private" tal:attributes="style string: color:red" tal:content="string: -- (private)" />
 </span>
</span>


<span tal:replace="structure python:h.editableField(atask, 'status')"/>

<span tal:replace="structure python:h.editableField(atask, 'deadline')"/>

<span tal:replace="structure python:h.editableField(atask, 'priority')"/>

<span tal:replace="structure python:h.editableField(atask, 'owner')"/>

<!-- creator -->
<!-- span class="creator-column" tal:content="atask/creator" / -->

<span metal:define-slot="post_task" />


</li>
</metal:macro>
